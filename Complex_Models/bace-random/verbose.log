Command line
python /home/ddunstan/.conda/envs/chemprop/bin/chemprop_train --data_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-random-train.csv --dataset_type classification --save_dir /home/ddunstan/Chemistry-Capstone/Complex_Models/bace-random --epochs 50 --extra_metrics accuracy f1 binary_cross_entropy --metric auc --target_columns active --smiles_columns mol --num_folds 5 --split_sizes 0.8 0 0.2 --separate_val_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-random-validate.csv --features_generator morgan
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-random-train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy', 'f1', 'binary_cross_entropy'],
 'features_generator': ['morgan'],
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy', 'f1', 'binary_cross_entropy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/ddunstan/Chemistry-Capstone/Complex_Models/bace-random',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-random-validate.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['mol'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.0, 0.2],
 'split_type': 'random',
 'target_columns': ['active'],
 'target_weights': None,
 'task_names': ['active'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.0636e-01, PNorm = 37.2374, GNorm = 2.4040, lr_0 = 3.4750e-04
Loss = 4.4864e-01, PNorm = 37.2598, GNorm = 2.2923, lr_0 = 5.7250e-04
Loss = 5.1616e-01, PNorm = 37.2635, GNorm = 2.8100, lr_0 = 5.9500e-04
Validation auc = 0.904930
Validation accuracy = 0.850220
Validation f1 = 0.895706
Validation binary_cross_entropy = 0.360867
Epoch 1
Loss = 1.9126e-01, PNorm = 37.3005, GNorm = 0.9524, lr_0 = 8.2000e-04
Loss = 2.1026e-01, PNorm = 37.3386, GNorm = 0.7545, lr_0 = 9.9521e-04
Validation auc = 0.909173
Validation accuracy = 0.854626
Validation f1 = 0.895899
Validation binary_cross_entropy = 0.372195
Epoch 2
Loss = 9.7984e-02, PNorm = 37.3858, GNorm = 0.7758, lr_0 = 9.7163e-04
Loss = 9.5793e-02, PNorm = 37.4192, GNorm = 0.7521, lr_0 = 9.4860e-04
Validation auc = 0.907277
Validation accuracy = 0.859031
Validation f1 = 0.898734
Validation binary_cross_entropy = 0.396692
Epoch 3
Loss = 5.3043e-02, PNorm = 37.4568, GNorm = 0.4827, lr_0 = 9.2390e-04
Loss = 4.9976e-02, PNorm = 37.4933, GNorm = 0.9397, lr_0 = 9.0200e-04
Validation auc = 0.908722
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.412730
Epoch 4
Loss = 3.7626e-02, PNorm = 37.5175, GNorm = 0.3484, lr_0 = 8.8063e-04
Loss = 4.4056e-02, PNorm = 37.5423, GNorm = 0.3998, lr_0 = 8.5976e-04
Validation auc = 0.909534
Validation accuracy = 0.837004
Validation f1 = 0.884735
Validation binary_cross_entropy = 0.430442
Epoch 5
Loss = 2.9894e-02, PNorm = 37.5670, GNorm = 0.6735, lr_0 = 8.3737e-04
Loss = 3.1850e-02, PNorm = 37.5783, GNorm = 0.7607, lr_0 = 8.1752e-04
Validation auc = 0.906645
Validation accuracy = 0.854626
Validation f1 = 0.895899
Validation binary_cross_entropy = 0.443423
Epoch 6
Loss = 2.1694e-02, PNorm = 37.5940, GNorm = 0.2100, lr_0 = 7.9815e-04
Loss = 2.6785e-02, PNorm = 37.6168, GNorm = 0.2223, lr_0 = 7.7923e-04
Validation auc = 0.901499
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.475692
Epoch 7
Loss = 2.3429e-02, PNorm = 37.6313, GNorm = 0.3373, lr_0 = 7.5894e-04
Loss = 2.1058e-02, PNorm = 37.6455, GNorm = 0.3054, lr_0 = 7.4095e-04
Validation auc = 0.903485
Validation accuracy = 0.850220
Validation f1 = 0.892405
Validation binary_cross_entropy = 0.481673
Epoch 8
Loss = 2.0530e-02, PNorm = 37.6610, GNorm = 0.3041, lr_0 = 7.2339e-04
Loss = 2.3219e-02, PNorm = 37.6767, GNorm = 0.4650, lr_0 = 7.0625e-04
Validation auc = 0.902943
Validation accuracy = 0.850220
Validation f1 = 0.893750
Validation binary_cross_entropy = 0.494369
Epoch 9
Loss = 1.5021e-02, PNorm = 37.6865, GNorm = 0.2649, lr_0 = 6.8951e-04
Loss = 1.7513e-02, PNorm = 37.6956, GNorm = 0.1552, lr_0 = 6.7317e-04
Validation auc = 0.901047
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.500010
Epoch 10
Loss = 1.2069e-02, PNorm = 37.7051, GNorm = 0.0712, lr_0 = 6.5564e-04
Loss = 1.9073e-02, PNorm = 37.7191, GNorm = 0.3130, lr_0 = 6.4010e-04
Validation auc = 0.901228
Validation accuracy = 0.841410
Validation f1 = 0.886792
Validation binary_cross_entropy = 0.508099
Epoch 11
Loss = 8.9080e-03, PNorm = 37.7275, GNorm = 0.0773, lr_0 = 6.2493e-04
Loss = 1.6629e-02, PNorm = 37.7378, GNorm = 0.1668, lr_0 = 6.1012e-04
Validation auc = 0.899874
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.533655
Epoch 12
Loss = 8.0668e-03, PNorm = 37.7502, GNorm = 0.1185, lr_0 = 5.9424e-04
Loss = 1.6289e-02, PNorm = 37.7626, GNorm = 0.1147, lr_0 = 5.8015e-04
Validation auc = 0.899332
Validation accuracy = 0.841410
Validation f1 = 0.886792
Validation binary_cross_entropy = 0.533144
Epoch 13
Loss = 6.4556e-03, PNorm = 37.7637, GNorm = 0.0820, lr_0 = 5.6640e-04
Loss = 1.2759e-02, PNorm = 37.7728, GNorm = 0.0504, lr_0 = 5.5298e-04
Validation auc = 0.899783
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.539351
Epoch 14
Loss = 4.6719e-03, PNorm = 37.7822, GNorm = 0.0467, lr_0 = 5.3858e-04
Loss = 1.1906e-02, PNorm = 37.7885, GNorm = 0.3478, lr_0 = 5.2582e-04
Validation auc = 0.899151
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.551530
Epoch 15
Loss = 1.0117e-02, PNorm = 37.8019, GNorm = 0.0673, lr_0 = 5.1335e-04
Loss = 1.3107e-02, PNorm = 37.8091, GNorm = 0.0959, lr_0 = 5.0119e-04
Validation auc = 0.899242
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.558327
Epoch 16
Loss = 4.3595e-03, PNorm = 37.8158, GNorm = 0.0529, lr_0 = 4.8814e-04
Loss = 1.2550e-02, PNorm = 37.8203, GNorm = 0.2281, lr_0 = 4.7657e-04
Validation auc = 0.898339
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.561793
Epoch 17
Loss = 4.4012e-03, PNorm = 37.8282, GNorm = 0.0588, lr_0 = 4.6527e-04
Loss = 9.9203e-03, PNorm = 37.8378, GNorm = 0.0486, lr_0 = 4.5425e-04
Loss = 1.3029e-02, PNorm = 37.8422, GNorm = 0.0410, lr_0 = 4.4348e-04
Validation auc = 0.898339
Validation accuracy = 0.841410
Validation f1 = 0.886792
Validation binary_cross_entropy = 0.568804
Epoch 18
Loss = 8.7786e-03, PNorm = 37.8453, GNorm = 0.0548, lr_0 = 4.3297e-04
Loss = 1.5043e-02, PNorm = 37.8519, GNorm = 0.0736, lr_0 = 4.2271e-04
Loss = 1.6033e-03, PNorm = 37.8527, GNorm = 0.0279, lr_0 = 4.2170e-04
Validation auc = 0.897165
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.571696
Epoch 19
Loss = 8.2324e-03, PNorm = 37.8612, GNorm = 0.2547, lr_0 = 4.1170e-04
Loss = 1.4108e-02, PNorm = 37.8645, GNorm = 0.0289, lr_0 = 4.0195e-04
Validation auc = 0.897616
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.576160
Epoch 20
Loss = 1.1832e-02, PNorm = 37.8676, GNorm = 0.0526, lr_0 = 3.9242e-04
Loss = 1.0064e-02, PNorm = 37.8743, GNorm = 0.3820, lr_0 = 3.8312e-04
Validation auc = 0.896894
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.580028
Epoch 21
Loss = 1.1120e-02, PNorm = 37.8823, GNorm = 0.2316, lr_0 = 3.7314e-04
Loss = 7.1490e-03, PNorm = 37.8865, GNorm = 0.0315, lr_0 = 3.6430e-04
Validation auc = 0.897165
Validation accuracy = 0.841410
Validation f1 = 0.886792
Validation binary_cross_entropy = 0.586549
Epoch 22
Loss = 8.1020e-03, PNorm = 37.8934, GNorm = 0.0497, lr_0 = 3.5567e-04
Loss = 9.0021e-03, PNorm = 37.8996, GNorm = 0.0437, lr_0 = 3.4724e-04
Validation auc = 0.896443
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.596891
Epoch 23
Loss = 7.6622e-03, PNorm = 37.9022, GNorm = 0.0411, lr_0 = 3.3819e-04
Loss = 1.0710e-02, PNorm = 37.9072, GNorm = 0.4272, lr_0 = 3.3018e-04
Validation auc = 0.895901
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.598015
Epoch 24
Loss = 8.5582e-03, PNorm = 37.9133, GNorm = 0.0605, lr_0 = 3.2235e-04
Loss = 9.6971e-03, PNorm = 37.9166, GNorm = 0.3603, lr_0 = 3.1471e-04
Validation auc = 0.896082
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.597777
Epoch 25
Loss = 1.4066e-02, PNorm = 37.9190, GNorm = 0.0276, lr_0 = 3.0726e-04
Loss = 4.9932e-03, PNorm = 37.9212, GNorm = 0.0534, lr_0 = 2.9997e-04
Validation auc = 0.896262
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.598374
Epoch 26
Loss = 7.9437e-03, PNorm = 37.9290, GNorm = 0.2306, lr_0 = 2.9216e-04
Loss = 8.5743e-03, PNorm = 37.9354, GNorm = 0.0466, lr_0 = 2.8524e-04
Validation auc = 0.895991
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.609695
Epoch 27
Loss = 1.3328e-02, PNorm = 37.9401, GNorm = 0.3380, lr_0 = 2.7848e-04
Loss = 7.7194e-03, PNorm = 37.9441, GNorm = 0.4189, lr_0 = 2.7188e-04
Validation auc = 0.894637
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.617144
Epoch 28
Loss = 9.3112e-03, PNorm = 37.9476, GNorm = 0.0486, lr_0 = 2.6480e-04
Loss = 1.1168e-02, PNorm = 37.9485, GNorm = 0.3403, lr_0 = 2.5852e-04
Validation auc = 0.895991
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.610057
Epoch 29
Loss = 1.2036e-02, PNorm = 37.9523, GNorm = 0.2989, lr_0 = 2.5240e-04
Loss = 6.2966e-03, PNorm = 37.9578, GNorm = 0.0260, lr_0 = 2.4641e-04
Validation auc = 0.895179
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.621397
Epoch 30
Loss = 1.0570e-02, PNorm = 37.9624, GNorm = 0.0376, lr_0 = 2.4000e-04
Loss = 6.9263e-03, PNorm = 37.9661, GNorm = 0.0418, lr_0 = 2.3431e-04
Validation auc = 0.894908
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.625789
Epoch 31
Loss = 6.7195e-03, PNorm = 37.9693, GNorm = 0.0247, lr_0 = 2.2876e-04
Loss = 9.8224e-03, PNorm = 37.9732, GNorm = 0.4528, lr_0 = 2.2334e-04
Validation auc = 0.894998
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.621170
Epoch 32
Loss = 1.8445e-03, PNorm = 37.9768, GNorm = 0.0360, lr_0 = 2.1752e-04
Loss = 8.8151e-03, PNorm = 37.9796, GNorm = 0.0218, lr_0 = 2.1237e-04
Validation auc = 0.895088
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.623736
Epoch 33
Loss = 1.5014e-03, PNorm = 37.9837, GNorm = 0.0302, lr_0 = 2.0733e-04
Loss = 9.6305e-03, PNorm = 37.9875, GNorm = 0.0410, lr_0 = 2.0242e-04
Validation auc = 0.895359
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.626456
Epoch 34
Loss = 1.3771e-03, PNorm = 37.9913, GNorm = 0.0166, lr_0 = 1.9762e-04
Loss = 8.0031e-03, PNorm = 37.9944, GNorm = 0.5326, lr_0 = 1.9294e-04
Validation auc = 0.894366
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.634296
Epoch 35
Loss = 1.3379e-02, PNorm = 37.9971, GNorm = 0.2733, lr_0 = 1.8791e-04
Loss = 7.7631e-03, PNorm = 37.9997, GNorm = 0.2666, lr_0 = 1.8346e-04
Loss = 7.2351e-03, PNorm = 38.0026, GNorm = 0.0369, lr_0 = 1.7911e-04
Validation auc = 0.894998
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.628447
Epoch 36
Loss = 7.7777e-03, PNorm = 38.0066, GNorm = 0.0455, lr_0 = 1.7487e-04
Loss = 5.6749e-03, PNorm = 38.0101, GNorm = 0.0246, lr_0 = 1.7072e-04
Loss = 5.6017e-02, PNorm = 38.0106, GNorm = 0.7065, lr_0 = 1.7031e-04
Validation auc = 0.895179
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.634838
Epoch 37
Loss = 4.2340e-03, PNorm = 38.0142, GNorm = 0.2604, lr_0 = 1.6628e-04
Loss = 1.0622e-02, PNorm = 38.0186, GNorm = 0.2991, lr_0 = 1.6234e-04
Validation auc = 0.894818
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.639535
Epoch 38
Loss = 2.6267e-03, PNorm = 38.0226, GNorm = 0.0304, lr_0 = 1.5849e-04
Loss = 1.1154e-02, PNorm = 38.0255, GNorm = 0.0337, lr_0 = 1.5473e-04
Validation auc = 0.894276
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.641894
Epoch 39
Loss = 7.2216e-03, PNorm = 38.0264, GNorm = 0.0444, lr_0 = 1.5070e-04
Loss = 6.1645e-03, PNorm = 38.0288, GNorm = 0.2871, lr_0 = 1.4713e-04
Validation auc = 0.895269
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.634377
Epoch 40
Loss = 5.5098e-03, PNorm = 38.0318, GNorm = 0.2742, lr_0 = 1.4365e-04
Loss = 8.2457e-03, PNorm = 38.0363, GNorm = 0.0430, lr_0 = 1.4024e-04
Validation auc = 0.894276
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.643613
Epoch 41
Loss = 1.0763e-02, PNorm = 38.0391, GNorm = 0.2294, lr_0 = 1.3659e-04
Loss = 6.0696e-03, PNorm = 38.0423, GNorm = 0.0166, lr_0 = 1.3335e-04
Validation auc = 0.893915
Validation accuracy = 0.850220
Validation f1 = 0.893750
Validation binary_cross_entropy = 0.651385
Epoch 42
Loss = 5.1071e-03, PNorm = 38.0446, GNorm = 0.0215, lr_0 = 1.3019e-04
Loss = 8.4404e-03, PNorm = 38.0458, GNorm = 0.0419, lr_0 = 1.2711e-04
Validation auc = 0.894095
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.647101
Epoch 43
Loss = 3.8702e-03, PNorm = 38.0496, GNorm = 0.2868, lr_0 = 1.2409e-04
Loss = 7.9208e-03, PNorm = 38.0538, GNorm = 0.4875, lr_0 = 1.2115e-04
Validation auc = 0.893644
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.653279
Epoch 44
Loss = 1.0065e-02, PNorm = 38.0559, GNorm = 0.0805, lr_0 = 1.1800e-04
Loss = 4.7401e-03, PNorm = 38.0577, GNorm = 0.2899, lr_0 = 1.1520e-04
Validation auc = 0.894366
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.647605
Epoch 45
Loss = 7.2519e-03, PNorm = 38.0601, GNorm = 0.0252, lr_0 = 1.1247e-04
Loss = 3.1443e-03, PNorm = 38.0624, GNorm = 0.0261, lr_0 = 1.0981e-04
Validation auc = 0.894456
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.650114
Epoch 46
Loss = 6.6660e-03, PNorm = 38.0664, GNorm = 0.2965, lr_0 = 1.0695e-04
Loss = 6.3639e-03, PNorm = 38.0692, GNorm = 0.4542, lr_0 = 1.0441e-04
Validation auc = 0.893824
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.653996
Epoch 47
Loss = 4.3452e-03, PNorm = 38.0719, GNorm = 0.0274, lr_0 = 1.0194e-04
Loss = 4.7030e-03, PNorm = 38.0738, GNorm = 0.0259, lr_0 = 1.0000e-04
Validation auc = 0.893824
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.654459
Epoch 48
Loss = 1.4834e-03, PNorm = 38.0768, GNorm = 0.0229, lr_0 = 1.0000e-04
Loss = 7.7407e-03, PNorm = 38.0804, GNorm = 0.0198, lr_0 = 1.0000e-04
Validation auc = 0.893644
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.658743
Epoch 49
Loss = 3.6215e-03, PNorm = 38.0831, GNorm = 0.2065, lr_0 = 1.0000e-04
Loss = 7.9537e-03, PNorm = 38.0861, GNorm = 0.0292, lr_0 = 1.0000e-04
Validation auc = 0.894186
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.651630
Model 0 best validation auc = 0.909534 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.905080
Model 0 test accuracy = 0.817829
Model 0 test f1 = 0.863768
Model 0 test binary_cross_entropy = 0.431686
Ensemble test auc = 0.905080
Ensemble test accuracy = 0.817829
Ensemble test f1 = 0.863768
Ensemble test binary_cross_entropy = 0.431686
Fold 1
Splitting data with seed 1
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.1714e-01, PNorm = 37.2373, GNorm = 2.6834, lr_0 = 3.4750e-04
Loss = 4.6270e-01, PNorm = 37.2569, GNorm = 1.9241, lr_0 = 5.7250e-04
Loss = 5.7018e-01, PNorm = 37.2603, GNorm = 4.7867, lr_0 = 5.9500e-04
Validation auc = 0.907909
Validation accuracy = 0.845815
Validation f1 = 0.888179
Validation binary_cross_entropy = 0.351812
Epoch 1
Loss = 1.6920e-01, PNorm = 37.3064, GNorm = 0.8133, lr_0 = 8.2000e-04
Loss = 1.9228e-01, PNorm = 37.3427, GNorm = 1.7214, lr_0 = 9.9521e-04
Validation auc = 0.909986
Validation accuracy = 0.837004
Validation f1 = 0.881789
Validation binary_cross_entropy = 0.378145
Epoch 2
Loss = 9.8627e-02, PNorm = 37.3950, GNorm = 0.6243, lr_0 = 9.7163e-04
Loss = 9.5285e-02, PNorm = 37.4254, GNorm = 0.7341, lr_0 = 9.4860e-04
Validation auc = 0.914410
Validation accuracy = 0.854626
Validation f1 = 0.896552
Validation binary_cross_entropy = 0.378398
Epoch 3
Loss = 5.3043e-02, PNorm = 37.4633, GNorm = 0.6741, lr_0 = 9.2390e-04
Loss = 6.0809e-02, PNorm = 37.5060, GNorm = 0.4620, lr_0 = 9.0200e-04
Validation auc = 0.914951
Validation accuracy = 0.837004
Validation f1 = 0.888218
Validation binary_cross_entropy = 0.411306
Epoch 4
Loss = 3.5775e-02, PNorm = 37.5220, GNorm = 0.2540, lr_0 = 8.8063e-04
Loss = 4.0767e-02, PNorm = 37.5399, GNorm = 0.3309, lr_0 = 8.5976e-04
Validation auc = 0.914229
Validation accuracy = 0.823789
Validation f1 = 0.875000
Validation binary_cross_entropy = 0.404582
Epoch 5
Loss = 3.0489e-02, PNorm = 37.5686, GNorm = 0.3344, lr_0 = 8.3737e-04
Loss = 2.8763e-02, PNorm = 37.5905, GNorm = 0.7127, lr_0 = 8.1752e-04
Validation auc = 0.913687
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.422029
Epoch 6
Loss = 1.9934e-02, PNorm = 37.5961, GNorm = 0.0825, lr_0 = 7.9815e-04
Loss = 3.3363e-02, PNorm = 37.6144, GNorm = 0.6561, lr_0 = 7.7923e-04
Validation auc = 0.908541
Validation accuracy = 0.823789
Validation f1 = 0.877301
Validation binary_cross_entropy = 0.440532
Epoch 7
Loss = 1.8754e-02, PNorm = 37.6339, GNorm = 0.1090, lr_0 = 7.5894e-04
Loss = 2.1799e-02, PNorm = 37.6494, GNorm = 0.2151, lr_0 = 7.4095e-04
Validation auc = 0.908180
Validation accuracy = 0.823789
Validation f1 = 0.875776
Validation binary_cross_entropy = 0.452543
Epoch 8
Loss = 1.1739e-02, PNorm = 37.6596, GNorm = 0.1261, lr_0 = 7.2339e-04
Loss = 2.5087e-02, PNorm = 37.6726, GNorm = 0.5924, lr_0 = 7.0625e-04
Validation auc = 0.908722
Validation accuracy = 0.823789
Validation f1 = 0.876543
Validation binary_cross_entropy = 0.460940
Epoch 9
Loss = 1.7703e-02, PNorm = 37.6872, GNorm = 0.2023, lr_0 = 6.8951e-04
Loss = 2.2542e-02, PNorm = 37.7002, GNorm = 0.0852, lr_0 = 6.7317e-04
Validation auc = 0.907728
Validation accuracy = 0.832599
Validation f1 = 0.881988
Validation binary_cross_entropy = 0.476811
Epoch 10
Loss = 2.3762e-02, PNorm = 37.7096, GNorm = 0.6663, lr_0 = 6.5564e-04
Loss = 2.0301e-02, PNorm = 37.7158, GNorm = 0.3642, lr_0 = 6.4010e-04
Validation auc = 0.905381
Validation accuracy = 0.823789
Validation f1 = 0.875776
Validation binary_cross_entropy = 0.478971
Epoch 11
Loss = 1.2556e-02, PNorm = 37.7282, GNorm = 0.1450, lr_0 = 6.2493e-04
Loss = 1.0075e-02, PNorm = 37.7386, GNorm = 0.0597, lr_0 = 6.1012e-04
Validation auc = 0.904478
Validation accuracy = 0.828194
Validation f1 = 0.879257
Validation binary_cross_entropy = 0.487991
Epoch 12
Loss = 1.9051e-02, PNorm = 37.7460, GNorm = 0.1991, lr_0 = 5.9424e-04
Loss = 1.7729e-02, PNorm = 37.7556, GNorm = 0.0320, lr_0 = 5.8015e-04
Validation auc = 0.904478
Validation accuracy = 0.828194
Validation f1 = 0.879257
Validation binary_cross_entropy = 0.492994
Epoch 13
Loss = 1.2214e-02, PNorm = 37.7657, GNorm = 0.1114, lr_0 = 5.6640e-04
Loss = 1.5041e-02, PNorm = 37.7734, GNorm = 0.3375, lr_0 = 5.5298e-04
Validation auc = 0.904749
Validation accuracy = 0.823789
Validation f1 = 0.876543
Validation binary_cross_entropy = 0.496643
Epoch 14
Loss = 4.0452e-03, PNorm = 37.7800, GNorm = 0.0775, lr_0 = 5.3858e-04
Loss = 1.5744e-02, PNorm = 37.7854, GNorm = 0.3828, lr_0 = 5.2582e-04
Validation auc = 0.903666
Validation accuracy = 0.823789
Validation f1 = 0.875776
Validation binary_cross_entropy = 0.507452
Epoch 15
Loss = 1.9424e-02, PNorm = 37.7975, GNorm = 0.2576, lr_0 = 5.1335e-04
Loss = 1.4226e-02, PNorm = 37.8066, GNorm = 0.1326, lr_0 = 5.0119e-04
Validation auc = 0.904568
Validation accuracy = 0.823789
Validation f1 = 0.876543
Validation binary_cross_entropy = 0.512171
Epoch 16
Loss = 1.2568e-02, PNorm = 37.8103, GNorm = 0.2726, lr_0 = 4.8814e-04
Loss = 1.8476e-02, PNorm = 37.8136, GNorm = 0.0966, lr_0 = 4.7657e-04
Validation auc = 0.903936
Validation accuracy = 0.810573
Validation f1 = 0.865204
Validation binary_cross_entropy = 0.515697
Epoch 17
Loss = 2.9739e-03, PNorm = 37.8221, GNorm = 0.0419, lr_0 = 4.6527e-04
Loss = 1.0160e-02, PNorm = 37.8279, GNorm = 0.0302, lr_0 = 4.5425e-04
Loss = 1.9988e-02, PNorm = 37.8357, GNorm = 0.8775, lr_0 = 4.4348e-04
Validation auc = 0.903936
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.523398
Epoch 18
Loss = 9.5619e-03, PNorm = 37.8466, GNorm = 0.0282, lr_0 = 4.3297e-04
Loss = 2.1372e-02, PNorm = 37.8479, GNorm = 0.0811, lr_0 = 4.2271e-04
Loss = 1.0844e-02, PNorm = 37.8476, GNorm = 0.2842, lr_0 = 4.2170e-04
Validation auc = 0.904839
Validation accuracy = 0.819383
Validation f1 = 0.872274
Validation binary_cross_entropy = 0.521351
Epoch 19
Loss = 1.2940e-02, PNorm = 37.8467, GNorm = 0.3667, lr_0 = 4.1170e-04
Loss = 1.6390e-02, PNorm = 37.8533, GNorm = 0.5336, lr_0 = 4.0195e-04
Validation auc = 0.903304
Validation accuracy = 0.814978
Validation f1 = 0.867925
Validation binary_cross_entropy = 0.522313
Epoch 20
Loss = 7.2525e-03, PNorm = 37.8622, GNorm = 0.0391, lr_0 = 3.9242e-04
Loss = 1.5314e-02, PNorm = 37.8683, GNorm = 0.4300, lr_0 = 3.8312e-04
Validation auc = 0.902176
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.533725
Epoch 21
Loss = 1.7764e-02, PNorm = 37.8778, GNorm = 0.4432, lr_0 = 3.7314e-04
Loss = 1.1665e-02, PNorm = 37.8820, GNorm = 0.4026, lr_0 = 3.6430e-04
Validation auc = 0.902311
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.537144
Epoch 22
Loss = 1.3436e-02, PNorm = 37.8823, GNorm = 0.2320, lr_0 = 3.5567e-04
Loss = 8.3215e-03, PNorm = 37.8866, GNorm = 0.0518, lr_0 = 3.4724e-04
Validation auc = 0.901589
Validation accuracy = 0.819383
Validation f1 = 0.873065
Validation binary_cross_entropy = 0.537507
Epoch 23
Loss = 8.0844e-03, PNorm = 37.8925, GNorm = 0.0539, lr_0 = 3.3819e-04
Loss = 1.0603e-02, PNorm = 37.8969, GNorm = 0.0112, lr_0 = 3.3018e-04
Validation auc = 0.902672
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.542714
Epoch 24
Loss = 1.0085e-02, PNorm = 37.9037, GNorm = 0.0564, lr_0 = 3.2235e-04
Loss = 1.5144e-02, PNorm = 37.9098, GNorm = 0.1644, lr_0 = 3.1471e-04
Validation auc = 0.902582
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.550512
Epoch 25
Loss = 4.9668e-03, PNorm = 37.9144, GNorm = 0.0238, lr_0 = 3.0726e-04
Loss = 1.5361e-02, PNorm = 37.9178, GNorm = 0.0212, lr_0 = 2.9997e-04
Validation auc = 0.902582
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.549670
Epoch 26
Loss = 1.2912e-02, PNorm = 37.9200, GNorm = 0.0249, lr_0 = 2.9216e-04
Loss = 1.4584e-02, PNorm = 37.9242, GNorm = 0.0131, lr_0 = 2.8524e-04
Validation auc = 0.901228
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.553861
Epoch 27
Loss = 1.7432e-02, PNorm = 37.9256, GNorm = 0.3264, lr_0 = 2.7848e-04
Loss = 1.0791e-02, PNorm = 37.9290, GNorm = 0.0417, lr_0 = 2.7188e-04
Validation auc = 0.903124
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.554007
Epoch 28
Loss = 5.0513e-03, PNorm = 37.9340, GNorm = 0.0335, lr_0 = 2.6480e-04
Loss = 6.9627e-03, PNorm = 37.9387, GNorm = 0.0278, lr_0 = 2.5852e-04
Validation auc = 0.902040
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.557116
Epoch 29
Loss = 1.9963e-02, PNorm = 37.9392, GNorm = 0.5705, lr_0 = 2.5240e-04
Loss = 7.4011e-03, PNorm = 37.9424, GNorm = 0.0487, lr_0 = 2.4641e-04
Validation auc = 0.900867
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.559367
Epoch 30
Loss = 1.4963e-02, PNorm = 37.9466, GNorm = 0.0428, lr_0 = 2.4000e-04
Loss = 8.9123e-03, PNorm = 37.9501, GNorm = 0.0140, lr_0 = 2.3431e-04
Validation auc = 0.900325
Validation accuracy = 0.806167
Validation f1 = 0.862500
Validation binary_cross_entropy = 0.562917
Epoch 31
Loss = 7.0763e-03, PNorm = 37.9529, GNorm = 0.0215, lr_0 = 2.2876e-04
Loss = 9.5637e-03, PNorm = 37.9570, GNorm = 0.3450, lr_0 = 2.2334e-04
Validation auc = 0.901589
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.563863
Epoch 32
Loss = 1.2935e-02, PNorm = 37.9583, GNorm = 0.2140, lr_0 = 2.1752e-04
Loss = 9.5414e-03, PNorm = 37.9607, GNorm = 0.0151, lr_0 = 2.1237e-04
Validation auc = 0.900596
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.565708
Epoch 33
Loss = 2.1291e-03, PNorm = 37.9634, GNorm = 0.0137, lr_0 = 2.0733e-04
Loss = 1.0921e-02, PNorm = 37.9657, GNorm = 0.4666, lr_0 = 2.0242e-04
Validation auc = 0.900776
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.568360
Epoch 34
Loss = 1.6738e-02, PNorm = 37.9691, GNorm = 0.2659, lr_0 = 1.9762e-04
Loss = 1.3953e-02, PNorm = 37.9722, GNorm = 0.4706, lr_0 = 1.9294e-04
Validation auc = 0.900144
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.571550
Epoch 35
Loss = 1.4349e-03, PNorm = 37.9750, GNorm = 0.0218, lr_0 = 1.8791e-04
Loss = 9.3378e-03, PNorm = 37.9783, GNorm = 0.0462, lr_0 = 1.8346e-04
Loss = 1.2020e-02, PNorm = 37.9801, GNorm = 0.0244, lr_0 = 1.7911e-04
Validation auc = 0.900144
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.573693
Epoch 36
Loss = 6.6689e-03, PNorm = 37.9823, GNorm = 0.1305, lr_0 = 1.7487e-04
Loss = 1.1555e-02, PNorm = 37.9845, GNorm = 0.3653, lr_0 = 1.7072e-04
Loss = 3.0858e-02, PNorm = 37.9846, GNorm = 0.7904, lr_0 = 1.7031e-04
Validation auc = 0.900325
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.575413
Epoch 37
Loss = 1.0815e-02, PNorm = 37.9871, GNorm = 0.5987, lr_0 = 1.6628e-04
Loss = 1.1508e-02, PNorm = 37.9879, GNorm = 0.0382, lr_0 = 1.6234e-04
Validation auc = 0.900596
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.574723
Epoch 38
Loss = 1.3419e-02, PNorm = 37.9906, GNorm = 0.0327, lr_0 = 1.5849e-04
Loss = 9.5334e-03, PNorm = 37.9931, GNorm = 0.3301, lr_0 = 1.5473e-04
Validation auc = 0.900235
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.577653
Epoch 39
Loss = 9.9092e-03, PNorm = 37.9952, GNorm = 0.1494, lr_0 = 1.5070e-04
Loss = 9.8169e-03, PNorm = 37.9974, GNorm = 0.0570, lr_0 = 1.4713e-04
Validation auc = 0.900325
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.578896
Epoch 40
Loss = 9.8931e-03, PNorm = 37.9989, GNorm = 0.1612, lr_0 = 1.4365e-04
Loss = 1.1559e-02, PNorm = 38.0010, GNorm = 0.2827, lr_0 = 1.4024e-04
Validation auc = 0.900235
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.580510
Epoch 41
Loss = 1.7093e-02, PNorm = 38.0039, GNorm = 0.5042, lr_0 = 1.3659e-04
Loss = 4.0576e-03, PNorm = 38.0055, GNorm = 0.1894, lr_0 = 1.3335e-04
Validation auc = 0.899783
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.582589
Epoch 42
Loss = 1.0486e-02, PNorm = 38.0085, GNorm = 0.0097, lr_0 = 1.3019e-04
Loss = 8.4785e-03, PNorm = 38.0106, GNorm = 0.1658, lr_0 = 1.2711e-04
Validation auc = 0.900054
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.585188
Epoch 43
Loss = 7.9565e-03, PNorm = 38.0115, GNorm = 0.3316, lr_0 = 1.2409e-04
Loss = 6.3798e-03, PNorm = 38.0122, GNorm = 0.0109, lr_0 = 1.2115e-04
Validation auc = 0.900054
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.584971
Epoch 44
Loss = 1.0888e-02, PNorm = 38.0146, GNorm = 0.2956, lr_0 = 1.1800e-04
Loss = 7.6156e-03, PNorm = 38.0170, GNorm = 0.0151, lr_0 = 1.1520e-04
Validation auc = 0.899332
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.587253
Epoch 45
Loss = 5.5362e-03, PNorm = 38.0185, GNorm = 0.0134, lr_0 = 1.1247e-04
Loss = 9.9742e-03, PNorm = 38.0195, GNorm = 0.2949, lr_0 = 1.0981e-04
Validation auc = 0.900235
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.587248
Epoch 46
Loss = 3.8102e-03, PNorm = 38.0217, GNorm = 0.0187, lr_0 = 1.0695e-04
Loss = 1.2988e-02, PNorm = 38.0235, GNorm = 0.3658, lr_0 = 1.0441e-04
Validation auc = 0.899603
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.589774
Epoch 47
Loss = 8.0757e-03, PNorm = 38.0251, GNorm = 0.0079, lr_0 = 1.0194e-04
Loss = 9.0931e-03, PNorm = 38.0268, GNorm = 0.0144, lr_0 = 1.0000e-04
Validation auc = 0.900009
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.591115
Epoch 48
Loss = 1.5979e-02, PNorm = 38.0293, GNorm = 0.0232, lr_0 = 1.0000e-04
Loss = 5.9790e-03, PNorm = 38.0323, GNorm = 0.0183, lr_0 = 1.0000e-04
Validation auc = 0.899603
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.596662
Epoch 49
Loss = 7.6747e-03, PNorm = 38.0332, GNorm = 0.0125, lr_0 = 1.0000e-04
Loss = 9.7458e-03, PNorm = 38.0339, GNorm = 0.4227, lr_0 = 1.0000e-04
Validation auc = 0.899422
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.592723
Model 0 best validation auc = 0.914951 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.890257
Model 0 test accuracy = 0.829457
Model 0 test f1 = 0.870588
Model 0 test binary_cross_entropy = 0.495855
Ensemble test auc = 0.890257
Ensemble test accuracy = 0.829457
Ensemble test f1 = 0.870588
Ensemble test binary_cross_entropy = 0.495855
Fold 2
Splitting data with seed 2
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.1556e-01, PNorm = 37.2358, GNorm = 3.0933, lr_0 = 3.4750e-04
Loss = 4.7803e-01, PNorm = 37.2569, GNorm = 2.8830, lr_0 = 5.7250e-04
Loss = 3.0074e-01, PNorm = 37.2600, GNorm = 2.0246, lr_0 = 5.9500e-04
Validation auc = 0.902582
Validation accuracy = 0.854626
Validation f1 = 0.898462
Validation binary_cross_entropy = 0.365497
Epoch 1
Loss = 1.7297e-01, PNorm = 37.2993, GNorm = 0.8301, lr_0 = 8.2000e-04
Loss = 2.1078e-01, PNorm = 37.3433, GNorm = 1.0841, lr_0 = 9.9521e-04
Validation auc = 0.918653
Validation accuracy = 0.863436
Validation f1 = 0.902821
Validation binary_cross_entropy = 0.352219
Epoch 2
Loss = 1.0214e-01, PNorm = 37.3867, GNorm = 0.5088, lr_0 = 9.7163e-04
Loss = 8.5093e-02, PNorm = 37.4263, GNorm = 0.8433, lr_0 = 9.4860e-04
Validation auc = 0.925334
Validation accuracy = 0.841410
Validation f1 = 0.890244
Validation binary_cross_entropy = 0.373875
Epoch 3
Loss = 5.5276e-02, PNorm = 37.4553, GNorm = 0.3590, lr_0 = 9.2390e-04
Loss = 6.4140e-02, PNorm = 37.4849, GNorm = 0.4888, lr_0 = 9.0200e-04
Validation auc = 0.927411
Validation accuracy = 0.859031
Validation f1 = 0.901235
Validation binary_cross_entropy = 0.370055
Epoch 4
Loss = 4.1406e-02, PNorm = 37.5138, GNorm = 0.3083, lr_0 = 8.8063e-04
Loss = 4.7155e-02, PNorm = 37.5314, GNorm = 0.8733, lr_0 = 8.5976e-04
Validation auc = 0.922355
Validation accuracy = 0.837004
Validation f1 = 0.884735
Validation binary_cross_entropy = 0.390177
Epoch 5
Loss = 2.7838e-02, PNorm = 37.5555, GNorm = 0.1770, lr_0 = 8.3737e-04
Loss = 2.8910e-02, PNorm = 37.5769, GNorm = 0.3732, lr_0 = 8.1752e-04
Validation auc = 0.921181
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.411596
Epoch 6
Loss = 1.7393e-02, PNorm = 37.5865, GNorm = 0.1294, lr_0 = 7.9815e-04
Loss = 2.8456e-02, PNorm = 37.6066, GNorm = 0.0924, lr_0 = 7.7923e-04
Validation auc = 0.924070
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.413808
Epoch 7
Loss = 2.1426e-02, PNorm = 37.6179, GNorm = 0.2408, lr_0 = 7.5894e-04
Loss = 3.2312e-02, PNorm = 37.6384, GNorm = 0.1941, lr_0 = 7.4095e-04
Validation auc = 0.920459
Validation accuracy = 0.841410
Validation f1 = 0.889571
Validation binary_cross_entropy = 0.434690
Epoch 8
Loss = 3.0127e-02, PNorm = 37.6541, GNorm = 0.0899, lr_0 = 7.2339e-04
Loss = 2.4108e-02, PNorm = 37.6659, GNorm = 0.0642, lr_0 = 7.0625e-04
Validation auc = 0.922355
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.431976
Epoch 9
Loss = 2.3294e-02, PNorm = 37.6753, GNorm = 0.2530, lr_0 = 6.8951e-04
Loss = 2.6057e-02, PNorm = 37.6906, GNorm = 0.2935, lr_0 = 6.7317e-04
Validation auc = 0.922896
Validation accuracy = 0.845815
Validation f1 = 0.892966
Validation binary_cross_entropy = 0.447535
Epoch 10
Loss = 2.0515e-02, PNorm = 37.7082, GNorm = 0.0804, lr_0 = 6.5564e-04
Loss = 1.8691e-02, PNorm = 37.7162, GNorm = 0.0873, lr_0 = 6.4010e-04
Validation auc = 0.921632
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.440937
Epoch 11
Loss = 1.4034e-02, PNorm = 37.7230, GNorm = 0.0747, lr_0 = 6.2493e-04
Loss = 2.2123e-02, PNorm = 37.7342, GNorm = 0.6983, lr_0 = 6.1012e-04
Validation auc = 0.921271
Validation accuracy = 0.845815
Validation f1 = 0.892308
Validation binary_cross_entropy = 0.457923
Epoch 12
Loss = 9.9792e-03, PNorm = 37.7506, GNorm = 0.0684, lr_0 = 5.9424e-04
Loss = 2.0982e-02, PNorm = 37.7589, GNorm = 0.9325, lr_0 = 5.8015e-04
Validation auc = 0.921000
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.457140
Epoch 13
Loss = 7.4194e-03, PNorm = 37.7670, GNorm = 0.1103, lr_0 = 5.6640e-04
Loss = 1.4393e-02, PNorm = 37.7748, GNorm = 0.0697, lr_0 = 5.5298e-04
Validation auc = 0.921000
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.469250
Epoch 14
Loss = 5.7428e-03, PNorm = 37.7906, GNorm = 0.0590, lr_0 = 5.3858e-04
Loss = 1.9172e-02, PNorm = 37.7988, GNorm = 0.1195, lr_0 = 5.2582e-04
Validation auc = 0.922174
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.462620
Epoch 15
Loss = 2.6382e-02, PNorm = 37.8006, GNorm = 0.5159, lr_0 = 5.1335e-04
Loss = 1.4821e-02, PNorm = 37.8084, GNorm = 0.3468, lr_0 = 5.0119e-04
Validation auc = 0.922445
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.471562
Epoch 16
Loss = 1.1772e-02, PNorm = 37.8180, GNorm = 0.0310, lr_0 = 4.8814e-04
Loss = 1.7445e-02, PNorm = 37.8259, GNorm = 0.8866, lr_0 = 4.7657e-04
Validation auc = 0.920278
Validation accuracy = 0.850220
Validation f1 = 0.894410
Validation binary_cross_entropy = 0.476952
Epoch 17
Loss = 3.4292e-03, PNorm = 37.8327, GNorm = 0.0508, lr_0 = 4.6527e-04
Loss = 1.0900e-02, PNorm = 37.8405, GNorm = 0.0611, lr_0 = 4.5425e-04
Loss = 2.1876e-02, PNorm = 37.8478, GNorm = 0.0414, lr_0 = 4.4348e-04
Validation auc = 0.922264
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.480477
Epoch 18
Loss = 1.7293e-02, PNorm = 37.8537, GNorm = 0.4519, lr_0 = 4.3297e-04
Loss = 1.2025e-02, PNorm = 37.8618, GNorm = 0.0212, lr_0 = 4.2271e-04
Loss = 1.8618e-02, PNorm = 37.8627, GNorm = 0.3434, lr_0 = 4.2170e-04
Validation auc = 0.921813
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.482661
Epoch 19
Loss = 1.8061e-02, PNorm = 37.8716, GNorm = 0.4314, lr_0 = 4.1170e-04
Loss = 1.0148e-02, PNorm = 37.8769, GNorm = 0.4027, lr_0 = 4.0195e-04
Validation auc = 0.920549
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.490095
Epoch 20
Loss = 1.3488e-02, PNorm = 37.8823, GNorm = 0.0345, lr_0 = 3.9242e-04
Loss = 1.1885e-02, PNorm = 37.8906, GNorm = 0.0606, lr_0 = 3.8312e-04
Validation auc = 0.921542
Validation accuracy = 0.850220
Validation f1 = 0.895062
Validation binary_cross_entropy = 0.493859
Epoch 21
Loss = 9.0065e-03, PNorm = 37.8956, GNorm = 0.0873, lr_0 = 3.7314e-04
Loss = 1.6539e-02, PNorm = 37.9002, GNorm = 0.1392, lr_0 = 3.6430e-04
Validation auc = 0.921271
Validation accuracy = 0.850220
Validation f1 = 0.894410
Validation binary_cross_entropy = 0.491732
Epoch 22
Loss = 1.3668e-02, PNorm = 37.9065, GNorm = 0.0248, lr_0 = 3.5567e-04
Loss = 7.1427e-03, PNorm = 37.9137, GNorm = 0.0413, lr_0 = 3.4724e-04
Validation auc = 0.921181
Validation accuracy = 0.850220
Validation f1 = 0.894410
Validation binary_cross_entropy = 0.503420
Epoch 23
Loss = 9.3565e-03, PNorm = 37.9170, GNorm = 0.3160, lr_0 = 3.3819e-04
Loss = 1.2102e-02, PNorm = 37.9242, GNorm = 0.0579, lr_0 = 3.3018e-04
Validation auc = 0.921181
Validation accuracy = 0.854626
Validation f1 = 0.897196
Validation binary_cross_entropy = 0.499893
Epoch 24
Loss = 1.5901e-02, PNorm = 37.9275, GNorm = 0.3707, lr_0 = 3.2235e-04
Loss = 9.7153e-03, PNorm = 37.9310, GNorm = 0.1019, lr_0 = 3.1471e-04
Validation auc = 0.920910
Validation accuracy = 0.845815
Validation f1 = 0.892308
Validation binary_cross_entropy = 0.505314
Epoch 25
Loss = 1.2237e-02, PNorm = 37.9403, GNorm = 0.0246, lr_0 = 3.0726e-04
Loss = 1.3713e-02, PNorm = 37.9466, GNorm = 0.4342, lr_0 = 2.9997e-04
Validation auc = 0.921542
Validation accuracy = 0.854626
Validation f1 = 0.897196
Validation binary_cross_entropy = 0.504924
Epoch 26
Loss = 9.5231e-03, PNorm = 37.9494, GNorm = 0.0361, lr_0 = 2.9216e-04
Loss = 1.4082e-02, PNorm = 37.9534, GNorm = 0.0277, lr_0 = 2.8524e-04
Validation auc = 0.920820
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.502936
Epoch 27
Loss = 9.3251e-03, PNorm = 37.9588, GNorm = 0.0445, lr_0 = 2.7848e-04
Loss = 8.8406e-03, PNorm = 37.9653, GNorm = 0.2876, lr_0 = 2.7188e-04
Validation auc = 0.920730
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.516135
Epoch 28
Loss = 1.3285e-02, PNorm = 37.9723, GNorm = 0.0453, lr_0 = 2.6480e-04
Loss = 1.6279e-02, PNorm = 37.9765, GNorm = 0.1254, lr_0 = 2.5852e-04
Validation auc = 0.921000
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.511792
Epoch 29
Loss = 8.8264e-03, PNorm = 37.9772, GNorm = 0.0151, lr_0 = 2.5240e-04
Loss = 1.0733e-02, PNorm = 37.9816, GNorm = 0.2078, lr_0 = 2.4641e-04
Validation auc = 0.920459
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.509313
Epoch 30
Loss = 4.0884e-03, PNorm = 37.9865, GNorm = 0.0247, lr_0 = 2.4000e-04
Loss = 1.2044e-02, PNorm = 37.9911, GNorm = 0.7315, lr_0 = 2.3431e-04
Validation auc = 0.918202
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.523893
Epoch 31
Loss = 7.2260e-03, PNorm = 37.9963, GNorm = 0.2653, lr_0 = 2.2876e-04
Loss = 1.0296e-02, PNorm = 38.0025, GNorm = 0.2876, lr_0 = 2.2334e-04
Validation auc = 0.920368
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.524897
Epoch 32
Loss = 6.6520e-03, PNorm = 38.0062, GNorm = 0.0354, lr_0 = 2.1752e-04
Loss = 1.3115e-02, PNorm = 38.0100, GNorm = 0.0142, lr_0 = 2.1237e-04
Validation auc = 0.919375
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.523278
Epoch 33
Loss = 1.1860e-02, PNorm = 38.0133, GNorm = 0.3997, lr_0 = 2.0733e-04
Loss = 9.8343e-03, PNorm = 38.0169, GNorm = 0.0501, lr_0 = 2.0242e-04
Validation auc = 0.918382
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.528197
Epoch 34
Loss = 1.8115e-02, PNorm = 38.0215, GNorm = 0.3365, lr_0 = 1.9762e-04
Loss = 1.0707e-02, PNorm = 38.0253, GNorm = 0.0295, lr_0 = 1.9294e-04
Validation auc = 0.920007
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.529472
Epoch 35
Loss = 2.3544e-03, PNorm = 38.0308, GNorm = 0.0316, lr_0 = 1.8791e-04
Loss = 9.7254e-03, PNorm = 38.0362, GNorm = 0.0268, lr_0 = 1.8346e-04
Loss = 1.1836e-02, PNorm = 38.0397, GNorm = 0.0071, lr_0 = 1.7911e-04
Validation auc = 0.918924
Validation accuracy = 0.845815
Validation f1 = 0.892308
Validation binary_cross_entropy = 0.538608
Epoch 36
Loss = 5.2946e-03, PNorm = 38.0426, GNorm = 0.0182, lr_0 = 1.7487e-04
Loss = 1.3247e-02, PNorm = 38.0463, GNorm = 0.0173, lr_0 = 1.7072e-04
Loss = 3.8081e-02, PNorm = 38.0465, GNorm = 0.6185, lr_0 = 1.7031e-04
Validation auc = 0.918653
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.533943
Epoch 37
Loss = 1.1424e-02, PNorm = 38.0501, GNorm = 0.6190, lr_0 = 1.6628e-04
Loss = 7.5276e-03, PNorm = 38.0547, GNorm = 0.0173, lr_0 = 1.6234e-04
Validation auc = 0.919556
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.530160
Epoch 38
Loss = 8.4753e-03, PNorm = 38.0591, GNorm = 0.0216, lr_0 = 1.5849e-04
Loss = 7.9004e-03, PNorm = 38.0637, GNorm = 0.0176, lr_0 = 1.5473e-04
Validation auc = 0.919285
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.535756
Epoch 39
Loss = 6.3738e-03, PNorm = 38.0694, GNorm = 0.4417, lr_0 = 1.5070e-04
Loss = 1.4032e-02, PNorm = 38.0731, GNorm = 0.0483, lr_0 = 1.4713e-04
Validation auc = 0.919014
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.538024
Epoch 40
Loss = 1.2603e-02, PNorm = 38.0787, GNorm = 0.0334, lr_0 = 1.4365e-04
Loss = 6.3165e-03, PNorm = 38.0828, GNorm = 0.0188, lr_0 = 1.4024e-04
Validation auc = 0.918653
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.538229
Epoch 41
Loss = 7.1577e-03, PNorm = 38.0865, GNorm = 0.0230, lr_0 = 1.3659e-04
Loss = 1.1317e-02, PNorm = 38.0904, GNorm = 0.6241, lr_0 = 1.3335e-04
Validation auc = 0.919014
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.541186
Epoch 42
Loss = 9.1011e-03, PNorm = 38.0949, GNorm = 0.4181, lr_0 = 1.3019e-04
Loss = 1.1073e-02, PNorm = 38.1006, GNorm = 0.2900, lr_0 = 1.2711e-04
Validation auc = 0.918563
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.541411
Epoch 43
Loss = 9.4590e-03, PNorm = 38.1059, GNorm = 0.3373, lr_0 = 1.2409e-04
Loss = 5.9723e-03, PNorm = 38.1115, GNorm = 0.0214, lr_0 = 1.2115e-04
Validation auc = 0.918202
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.551866
Epoch 44
Loss = 7.2895e-03, PNorm = 38.1159, GNorm = 0.0154, lr_0 = 1.1800e-04
Loss = 9.0877e-03, PNorm = 38.1202, GNorm = 0.0125, lr_0 = 1.1520e-04
Validation auc = 0.918021
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.545672
Epoch 45
Loss = 1.4108e-02, PNorm = 38.1234, GNorm = 0.3675, lr_0 = 1.1247e-04
Loss = 4.5830e-03, PNorm = 38.1268, GNorm = 0.0221, lr_0 = 1.0981e-04
Validation auc = 0.917299
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.549225
Epoch 46
Loss = 6.1872e-03, PNorm = 38.1311, GNorm = 0.0089, lr_0 = 1.0695e-04
Loss = 4.8456e-03, PNorm = 38.1350, GNorm = 0.2301, lr_0 = 1.0441e-04
Validation auc = 0.918021
Validation accuracy = 0.841410
Validation f1 = 0.890244
Validation binary_cross_entropy = 0.567409
Epoch 47
Loss = 5.7306e-03, PNorm = 38.1387, GNorm = 0.0074, lr_0 = 1.0194e-04
Loss = 6.2243e-03, PNorm = 38.1419, GNorm = 0.2021, lr_0 = 1.0000e-04
Validation auc = 0.917118
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.549508
Epoch 48
Loss = 8.2144e-03, PNorm = 38.1478, GNorm = 0.0084, lr_0 = 1.0000e-04
Loss = 4.6515e-03, PNorm = 38.1517, GNorm = 0.0135, lr_0 = 1.0000e-04
Validation auc = 0.916983
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.557579
Epoch 49
Loss = 5.5256e-03, PNorm = 38.1569, GNorm = 0.0221, lr_0 = 1.0000e-04
Loss = 5.6514e-03, PNorm = 38.1621, GNorm = 0.2492, lr_0 = 1.0000e-04
Validation auc = 0.915764
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.562000
Model 0 best validation auc = 0.927411 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.919173
Model 0 test accuracy = 0.844961
Model 0 test f1 = 0.889503
Model 0 test binary_cross_entropy = 0.383963
Ensemble test auc = 0.919173
Ensemble test accuracy = 0.844961
Ensemble test f1 = 0.889503
Ensemble test binary_cross_entropy = 0.383963
Fold 3
Splitting data with seed 3
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.1202e-01, PNorm = 37.2370, GNorm = 3.0971, lr_0 = 3.4750e-04
Loss = 4.6378e-01, PNorm = 37.2631, GNorm = 3.4092, lr_0 = 5.7250e-04
Loss = 5.3742e-01, PNorm = 37.2654, GNorm = 3.1698, lr_0 = 5.9500e-04
Validation auc = 0.901589
Validation accuracy = 0.859031
Validation f1 = 0.901235
Validation binary_cross_entropy = 0.361661
Epoch 1
Loss = 1.8260e-01, PNorm = 37.3055, GNorm = 0.9495, lr_0 = 8.2000e-04
Loss = 1.7920e-01, PNorm = 37.3529, GNorm = 1.1046, lr_0 = 9.9521e-04
Validation auc = 0.907909
Validation accuracy = 0.828194
Validation f1 = 0.881459
Validation binary_cross_entropy = 0.392822
Epoch 2
Loss = 8.3371e-02, PNorm = 37.3961, GNorm = 0.6992, lr_0 = 9.7163e-04
Loss = 9.7605e-02, PNorm = 37.4309, GNorm = 0.7587, lr_0 = 9.4860e-04
Validation auc = 0.916396
Validation accuracy = 0.850220
Validation f1 = 0.893082
Validation binary_cross_entropy = 0.385628
Epoch 3
Loss = 5.4031e-02, PNorm = 37.4606, GNorm = 0.4317, lr_0 = 9.2390e-04
Loss = 6.7944e-02, PNorm = 37.4911, GNorm = 0.6354, lr_0 = 9.0200e-04
Validation auc = 0.927320
Validation accuracy = 0.837004
Validation f1 = 0.886850
Validation binary_cross_entropy = 0.385483
Epoch 4
Loss = 5.8690e-02, PNorm = 37.5083, GNorm = 0.8992, lr_0 = 8.8063e-04
Loss = 3.9667e-02, PNorm = 37.5400, GNorm = 0.6328, lr_0 = 8.5976e-04
Validation auc = 0.924341
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.404593
Epoch 5
Loss = 3.4994e-02, PNorm = 37.5577, GNorm = 0.2822, lr_0 = 8.3737e-04
Loss = 3.3848e-02, PNorm = 37.5768, GNorm = 0.2507, lr_0 = 8.1752e-04
Validation auc = 0.923348
Validation accuracy = 0.828194
Validation f1 = 0.881459
Validation binary_cross_entropy = 0.420598
Epoch 6
Loss = 3.0377e-02, PNorm = 37.5930, GNorm = 0.1443, lr_0 = 7.9815e-04
Loss = 2.7891e-02, PNorm = 37.6080, GNorm = 0.1531, lr_0 = 7.7923e-04
Validation auc = 0.924612
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.414143
Epoch 7
Loss = 1.3416e-02, PNorm = 37.6266, GNorm = 0.0922, lr_0 = 7.5894e-04
Loss = 2.8382e-02, PNorm = 37.6381, GNorm = 0.5646, lr_0 = 7.4095e-04
Validation auc = 0.923528
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.427052
Epoch 8
Loss = 1.1753e-02, PNorm = 37.6578, GNorm = 0.0974, lr_0 = 7.2339e-04
Loss = 2.7252e-02, PNorm = 37.6635, GNorm = 0.0440, lr_0 = 7.0625e-04
Validation auc = 0.922625
Validation accuracy = 0.832599
Validation f1 = 0.881988
Validation binary_cross_entropy = 0.433836
Epoch 9
Loss = 1.5157e-02, PNorm = 37.6743, GNorm = 0.1208, lr_0 = 6.8951e-04
Loss = 1.9751e-02, PNorm = 37.6885, GNorm = 0.4108, lr_0 = 6.7317e-04
Validation auc = 0.923348
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.452477
Epoch 10
Loss = 1.6652e-02, PNorm = 37.7026, GNorm = 0.0635, lr_0 = 6.5564e-04
Loss = 1.4964e-02, PNorm = 37.7138, GNorm = 0.1566, lr_0 = 6.4010e-04
Validation auc = 0.921362
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.452798
Epoch 11
Loss = 1.0404e-02, PNorm = 37.7197, GNorm = 0.1640, lr_0 = 6.2493e-04
Loss = 1.7910e-02, PNorm = 37.7279, GNorm = 0.5137, lr_0 = 6.1012e-04
Validation auc = 0.921993
Validation accuracy = 0.837004
Validation f1 = 0.886850
Validation binary_cross_entropy = 0.467451
Epoch 12
Loss = 7.8440e-03, PNorm = 37.7400, GNorm = 0.0610, lr_0 = 5.9424e-04
Loss = 1.4796e-02, PNorm = 37.7487, GNorm = 0.4166, lr_0 = 5.8015e-04
Validation auc = 0.921000
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.463856
Epoch 13
Loss = 4.6156e-03, PNorm = 37.7564, GNorm = 0.0547, lr_0 = 5.6640e-04
Loss = 1.8664e-02, PNorm = 37.7635, GNorm = 0.4438, lr_0 = 5.5298e-04
Validation auc = 0.922987
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.469330
Epoch 14
Loss = 2.8689e-02, PNorm = 37.7687, GNorm = 0.3808, lr_0 = 5.3858e-04
Loss = 1.2152e-02, PNorm = 37.7770, GNorm = 0.0501, lr_0 = 5.2582e-04
Validation auc = 0.920820
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.473827
Epoch 15
Loss = 1.8174e-02, PNorm = 37.7877, GNorm = 0.0435, lr_0 = 5.1335e-04
Loss = 2.3048e-02, PNorm = 37.7970, GNorm = 0.0379, lr_0 = 5.0119e-04
Validation auc = 0.920098
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.479774
Epoch 16
Loss = 1.3420e-02, PNorm = 37.8054, GNorm = 0.5243, lr_0 = 4.8814e-04
Loss = 1.5662e-02, PNorm = 37.8141, GNorm = 0.0355, lr_0 = 4.7657e-04
Validation auc = 0.921362
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.482021
Epoch 17
Loss = 1.4038e-02, PNorm = 37.8194, GNorm = 0.2318, lr_0 = 4.6527e-04
Loss = 1.6622e-02, PNorm = 37.8231, GNorm = 0.0990, lr_0 = 4.5425e-04
Loss = 1.6976e-02, PNorm = 37.8331, GNorm = 0.0713, lr_0 = 4.4348e-04
Validation auc = 0.922355
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.490480
Epoch 18
Loss = 1.4124e-02, PNorm = 37.8396, GNorm = 0.0389, lr_0 = 4.3297e-04
Loss = 1.2572e-02, PNorm = 37.8460, GNorm = 0.0256, lr_0 = 4.2271e-04
Loss = 1.1422e-02, PNorm = 37.8468, GNorm = 0.2868, lr_0 = 4.2170e-04
Validation auc = 0.922174
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.491756
Epoch 19
Loss = 1.2303e-02, PNorm = 37.8528, GNorm = 0.1186, lr_0 = 4.1170e-04
Loss = 1.1580e-02, PNorm = 37.8613, GNorm = 0.0475, lr_0 = 4.0195e-04
Validation auc = 0.921632
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.497376
Epoch 20
Loss = 1.2273e-02, PNorm = 37.8669, GNorm = 0.0481, lr_0 = 3.9242e-04
Loss = 2.0199e-02, PNorm = 37.8743, GNorm = 0.0414, lr_0 = 3.8312e-04
Validation auc = 0.920910
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.500490
Epoch 21
Loss = 8.9343e-03, PNorm = 37.8818, GNorm = 0.0491, lr_0 = 3.7314e-04
Loss = 1.1665e-02, PNorm = 37.8890, GNorm = 0.0263, lr_0 = 3.6430e-04
Validation auc = 0.919556
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.507275
Epoch 22
Loss = 7.9908e-03, PNorm = 37.8927, GNorm = 0.0554, lr_0 = 3.5567e-04
Loss = 1.0681e-02, PNorm = 37.8975, GNorm = 0.3861, lr_0 = 3.4724e-04
Validation auc = 0.920910
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.499738
Epoch 23
Loss = 2.8375e-03, PNorm = 37.9030, GNorm = 0.0404, lr_0 = 3.3819e-04
Loss = 1.3007e-02, PNorm = 37.9116, GNorm = 0.0308, lr_0 = 3.3018e-04
Validation auc = 0.920730
Validation accuracy = 0.841410
Validation f1 = 0.889571
Validation binary_cross_entropy = 0.509113
Epoch 24
Loss = 6.6465e-03, PNorm = 37.9191, GNorm = 0.0091, lr_0 = 3.2235e-04
Loss = 1.5684e-02, PNorm = 37.9239, GNorm = 0.3855, lr_0 = 3.1471e-04
Validation auc = 0.921091
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.504958
Epoch 25
Loss = 1.5601e-02, PNorm = 37.9295, GNorm = 0.6625, lr_0 = 3.0726e-04
Loss = 9.3250e-03, PNorm = 37.9367, GNorm = 0.0208, lr_0 = 2.9997e-04
Validation auc = 0.921000
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.515719
Epoch 26
Loss = 8.3786e-03, PNorm = 37.9445, GNorm = 0.2543, lr_0 = 2.9216e-04
Loss = 1.1947e-02, PNorm = 37.9524, GNorm = 0.6596, lr_0 = 2.8524e-04
Validation auc = 0.920459
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.528067
Epoch 27
Loss = 1.8825e-02, PNorm = 37.9574, GNorm = 0.5629, lr_0 = 2.7848e-04
Loss = 8.1583e-03, PNorm = 37.9635, GNorm = 0.0398, lr_0 = 2.7188e-04
Validation auc = 0.920910
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.518526
Epoch 28
Loss = 6.2088e-03, PNorm = 37.9712, GNorm = 0.0764, lr_0 = 2.6480e-04
Loss = 1.1910e-02, PNorm = 37.9762, GNorm = 0.3848, lr_0 = 2.5852e-04
Validation auc = 0.919646
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.511982
Epoch 29
Loss = 2.4323e-02, PNorm = 37.9838, GNorm = 0.2605, lr_0 = 2.5240e-04
Loss = 6.8216e-03, PNorm = 37.9920, GNorm = 0.0270, lr_0 = 2.4641e-04
Validation auc = 0.919646
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.529474
Epoch 30
Loss = 9.3079e-03, PNorm = 37.9996, GNorm = 0.0307, lr_0 = 2.4000e-04
Loss = 1.0802e-02, PNorm = 38.0060, GNorm = 0.0285, lr_0 = 2.3431e-04
Validation auc = 0.918021
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.527273
Epoch 31
Loss = 1.7209e-03, PNorm = 38.0132, GNorm = 0.0111, lr_0 = 2.2876e-04
Loss = 1.6506e-02, PNorm = 38.0199, GNorm = 0.6568, lr_0 = 2.2334e-04
Validation auc = 0.918382
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.534783
Epoch 32
Loss = 4.5039e-03, PNorm = 38.0285, GNorm = 0.0112, lr_0 = 2.1752e-04
Loss = 9.4075e-03, PNorm = 38.0369, GNorm = 0.0102, lr_0 = 2.1237e-04
Validation auc = 0.918472
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.542798
Epoch 33
Loss = 2.3167e-03, PNorm = 38.0461, GNorm = 0.0502, lr_0 = 2.0733e-04
Loss = 1.0817e-02, PNorm = 38.0552, GNorm = 0.0314, lr_0 = 2.0242e-04
Validation auc = 0.918202
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.542501
Epoch 34
Loss = 2.5000e-03, PNorm = 38.0629, GNorm = 0.0284, lr_0 = 1.9762e-04
Loss = 6.0594e-03, PNorm = 38.0683, GNorm = 0.5148, lr_0 = 1.9294e-04
Validation auc = 0.917570
Validation accuracy = 0.837004
Validation f1 = 0.886850
Validation binary_cross_entropy = 0.556857
Epoch 35
Loss = 4.8402e-04, PNorm = 38.0787, GNorm = 0.0077, lr_0 = 1.8791e-04
Loss = 5.9753e-03, PNorm = 38.0874, GNorm = 0.0236, lr_0 = 1.8346e-04
Loss = 1.1833e-02, PNorm = 38.0957, GNorm = 0.0279, lr_0 = 1.7911e-04
Validation auc = 0.917344
Validation accuracy = 0.832599
Validation f1 = 0.884146
Validation binary_cross_entropy = 0.585191
Epoch 36
Loss = 9.2441e-03, PNorm = 38.1016, GNorm = 0.0231, lr_0 = 1.7487e-04
Loss = 1.1240e-02, PNorm = 38.1082, GNorm = 0.0505, lr_0 = 1.7072e-04
Loss = 2.2455e-03, PNorm = 38.1089, GNorm = 0.0415, lr_0 = 1.7031e-04
Validation auc = 0.917570
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.533603
Epoch 37
Loss = 1.1479e-02, PNorm = 38.1176, GNorm = 0.1950, lr_0 = 1.6628e-04
Loss = 4.9998e-03, PNorm = 38.1268, GNorm = 0.3115, lr_0 = 1.6234e-04
Validation auc = 0.915583
Validation accuracy = 0.828194
Validation f1 = 0.880734
Validation binary_cross_entropy = 0.565358
Epoch 38
Loss = 8.0387e-03, PNorm = 38.1338, GNorm = 0.4242, lr_0 = 1.5849e-04
Loss = 8.8380e-03, PNorm = 38.1426, GNorm = 0.3838, lr_0 = 1.5473e-04
Validation auc = 0.914410
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.561591
Epoch 39
Loss = 4.9911e-03, PNorm = 38.1506, GNorm = 0.0328, lr_0 = 1.5070e-04
Loss = 5.8716e-03, PNorm = 38.1583, GNorm = 0.0401, lr_0 = 1.4713e-04
Validation auc = 0.914771
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.565389
Epoch 40
Loss = 5.8138e-03, PNorm = 38.1650, GNorm = 0.2080, lr_0 = 1.4365e-04
Loss = 1.0047e-02, PNorm = 38.1742, GNorm = 0.2070, lr_0 = 1.4024e-04
Validation auc = 0.913507
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.569455
Epoch 41
Loss = 6.4637e-03, PNorm = 38.1799, GNorm = 0.0275, lr_0 = 1.3659e-04
Loss = 4.8119e-03, PNorm = 38.1847, GNorm = 0.1521, lr_0 = 1.3335e-04
Validation auc = 0.913326
Validation accuracy = 0.823789
Validation f1 = 0.877301
Validation binary_cross_entropy = 0.585238
Epoch 42
Loss = 3.1321e-03, PNorm = 38.1906, GNorm = 0.0167, lr_0 = 1.3019e-04
Loss = 7.7554e-03, PNorm = 38.1975, GNorm = 0.3193, lr_0 = 1.2711e-04
Validation auc = 0.911430
Validation accuracy = 0.819383
Validation f1 = 0.872274
Validation binary_cross_entropy = 0.583660
Epoch 43
Loss = 3.4418e-03, PNorm = 38.2030, GNorm = 0.0127, lr_0 = 1.2409e-04
Loss = 7.1267e-03, PNorm = 38.2059, GNorm = 0.0354, lr_0 = 1.2115e-04
Validation auc = 0.912784
Validation accuracy = 0.828194
Validation f1 = 0.880734
Validation binary_cross_entropy = 0.604085
Epoch 44
Loss = 2.9461e-03, PNorm = 38.2103, GNorm = 0.0965, lr_0 = 1.1800e-04
Loss = 6.8686e-03, PNorm = 38.2152, GNorm = 0.4313, lr_0 = 1.1520e-04
Validation auc = 0.911656
Validation accuracy = 0.810573
Validation f1 = 0.866873
Validation binary_cross_entropy = 0.594419
Epoch 45
Loss = 2.8856e-03, PNorm = 38.2196, GNorm = 0.0185, lr_0 = 1.1247e-04
Loss = 3.6104e-03, PNorm = 38.2228, GNorm = 0.0285, lr_0 = 1.0981e-04
Validation auc = 0.911520
Validation accuracy = 0.810573
Validation f1 = 0.866873
Validation binary_cross_entropy = 0.604471
Epoch 46
Loss = 3.9688e-03, PNorm = 38.2275, GNorm = 0.0801, lr_0 = 1.0695e-04
Loss = 3.0430e-03, PNorm = 38.2300, GNorm = 0.1066, lr_0 = 1.0441e-04
Validation auc = 0.911069
Validation accuracy = 0.810573
Validation f1 = 0.866873
Validation binary_cross_entropy = 0.601511
Epoch 47
Loss = 2.3787e-03, PNorm = 38.2331, GNorm = 0.0217, lr_0 = 1.0194e-04
Loss = 4.5877e-03, PNorm = 38.2369, GNorm = 0.0565, lr_0 = 1.0000e-04
Validation auc = 0.910888
Validation accuracy = 0.814978
Validation f1 = 0.870370
Validation binary_cross_entropy = 0.615419
Epoch 48
Loss = 6.0303e-03, PNorm = 38.2398, GNorm = 0.0722, lr_0 = 1.0000e-04
Loss = 4.2921e-03, PNorm = 38.2417, GNorm = 0.0388, lr_0 = 1.0000e-04
Validation auc = 0.910708
Validation accuracy = 0.806167
Validation f1 = 0.863354
Validation binary_cross_entropy = 0.600069
Epoch 49
Loss = 2.1319e-03, PNorm = 38.2437, GNorm = 0.0201, lr_0 = 1.0000e-04
Loss = 3.8985e-03, PNorm = 38.2452, GNorm = 0.3948, lr_0 = 1.0000e-04
Validation auc = 0.910708
Validation accuracy = 0.810573
Validation f1 = 0.866873
Validation binary_cross_entropy = 0.603560
Model 0 best validation auc = 0.927320 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.905244
Model 0 test accuracy = 0.841085
Model 0 test f1 = 0.881844
Model 0 test binary_cross_entropy = 0.437109
Ensemble test auc = 0.905244
Ensemble test accuracy = 0.841085
Ensemble test f1 = 0.881844
Ensemble test binary_cross_entropy = 0.437109
Fold 4
Splitting data with seed 4
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.0143e-01, PNorm = 37.2351, GNorm = 3.1983, lr_0 = 3.4750e-04
Loss = 4.4588e-01, PNorm = 37.2562, GNorm = 2.7462, lr_0 = 5.7250e-04
Loss = 4.7454e-01, PNorm = 37.2599, GNorm = 3.5592, lr_0 = 5.9500e-04
Validation auc = 0.909715
Validation accuracy = 0.850220
Validation f1 = 0.891026
Validation binary_cross_entropy = 0.359087
Epoch 1
Loss = 1.7961e-01, PNorm = 37.3079, GNorm = 1.1891, lr_0 = 8.2000e-04
Loss = 1.8472e-01, PNorm = 37.3471, GNorm = 1.5188, lr_0 = 9.9521e-04
Validation auc = 0.916306
Validation accuracy = 0.854626
Validation f1 = 0.896552
Validation binary_cross_entropy = 0.354717
Epoch 2
Loss = 7.0808e-02, PNorm = 37.3969, GNorm = 0.3517, lr_0 = 9.7163e-04
Loss = 9.2405e-02, PNorm = 37.4356, GNorm = 0.5978, lr_0 = 9.4860e-04
Validation auc = 0.920910
Validation accuracy = 0.850220
Validation f1 = 0.893750
Validation binary_cross_entropy = 0.369359
Epoch 3
Loss = 5.2298e-02, PNorm = 37.4671, GNorm = 0.2091, lr_0 = 9.2390e-04
Loss = 5.7119e-02, PNorm = 37.4914, GNorm = 0.4053, lr_0 = 9.0200e-04
Validation auc = 0.926056
Validation accuracy = 0.850220
Validation f1 = 0.893750
Validation binary_cross_entropy = 0.362811
Epoch 4
Loss = 3.5210e-02, PNorm = 37.5072, GNorm = 0.3224, lr_0 = 8.8063e-04
Loss = 4.2782e-02, PNorm = 37.5338, GNorm = 0.2471, lr_0 = 8.5976e-04
Validation auc = 0.923438
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.394299
Epoch 5
Loss = 4.1928e-02, PNorm = 37.5572, GNorm = 0.5225, lr_0 = 8.3737e-04
Loss = 2.7080e-02, PNorm = 37.5680, GNorm = 0.3197, lr_0 = 8.1752e-04
Validation auc = 0.924431
Validation accuracy = 0.859031
Validation f1 = 0.898734
Validation binary_cross_entropy = 0.384054
Epoch 6
Loss = 3.0143e-02, PNorm = 37.5860, GNorm = 0.4074, lr_0 = 7.9815e-04
Loss = 3.3703e-02, PNorm = 37.6050, GNorm = 0.2714, lr_0 = 7.7923e-04
Validation auc = 0.924702
Validation accuracy = 0.872247
Validation f1 = 0.909091
Validation binary_cross_entropy = 0.402745
Epoch 7
Loss = 1.1388e-02, PNorm = 37.6254, GNorm = 0.0732, lr_0 = 7.5894e-04
Loss = 3.0973e-02, PNorm = 37.6360, GNorm = 0.8800, lr_0 = 7.4095e-04
Validation auc = 0.923709
Validation accuracy = 0.850220
Validation f1 = 0.891026
Validation binary_cross_entropy = 0.418086
Epoch 8
Loss = 1.4313e-02, PNorm = 37.6411, GNorm = 0.3184, lr_0 = 7.2339e-04
Loss = 2.3454e-02, PNorm = 37.6540, GNorm = 0.3919, lr_0 = 7.0625e-04
Validation auc = 0.922896
Validation accuracy = 0.854626
Validation f1 = 0.896552
Validation binary_cross_entropy = 0.427327
Epoch 9
Loss = 2.0749e-02, PNorm = 37.6722, GNorm = 0.2222, lr_0 = 6.8951e-04
Loss = 1.5238e-02, PNorm = 37.6772, GNorm = 0.0515, lr_0 = 6.7317e-04
Validation auc = 0.921542
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.429867
Epoch 10
Loss = 1.3655e-02, PNorm = 37.6874, GNorm = 0.1094, lr_0 = 6.5564e-04
Loss = 1.8185e-02, PNorm = 37.7010, GNorm = 0.0867, lr_0 = 6.4010e-04
Validation auc = 0.923619
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.437822
Epoch 11
Loss = 1.4101e-02, PNorm = 37.7151, GNorm = 0.1729, lr_0 = 6.2493e-04
Loss = 1.9685e-02, PNorm = 37.7185, GNorm = 0.0755, lr_0 = 6.1012e-04
Validation auc = 0.920730
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.449486
Epoch 12
Loss = 1.8467e-02, PNorm = 37.7330, GNorm = 0.6590, lr_0 = 5.9424e-04
Loss = 1.1611e-02, PNorm = 37.7412, GNorm = 0.0491, lr_0 = 5.8015e-04
Validation auc = 0.919556
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.456536
Epoch 13
Loss = 1.0168e-02, PNorm = 37.7407, GNorm = 0.3453, lr_0 = 5.6640e-04
Loss = 1.9134e-02, PNorm = 37.7480, GNorm = 0.7660, lr_0 = 5.5298e-04
Validation auc = 0.922264
Validation accuracy = 0.863436
Validation f1 = 0.902821
Validation binary_cross_entropy = 0.451876
Epoch 14
Loss = 1.1110e-02, PNorm = 37.7622, GNorm = 0.1395, lr_0 = 5.3858e-04
Loss = 1.1676e-02, PNorm = 37.7736, GNorm = 0.2909, lr_0 = 5.2582e-04
Validation auc = 0.921091
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.463775
Epoch 15
Loss = 1.4167e-02, PNorm = 37.7739, GNorm = 0.0498, lr_0 = 5.1335e-04
Loss = 1.3005e-02, PNorm = 37.7782, GNorm = 0.5091, lr_0 = 5.0119e-04
Validation auc = 0.918021
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.473258
Epoch 16
Loss = 1.1777e-02, PNorm = 37.7870, GNorm = 0.0913, lr_0 = 4.8814e-04
Loss = 1.3374e-02, PNorm = 37.7952, GNorm = 0.6823, lr_0 = 4.7657e-04
Validation auc = 0.920368
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.473751
Epoch 17
Loss = 3.9310e-03, PNorm = 37.8011, GNorm = 0.0539, lr_0 = 4.6527e-04
Loss = 1.4301e-02, PNorm = 37.8095, GNorm = 0.5698, lr_0 = 4.5425e-04
Loss = 1.4320e-02, PNorm = 37.8106, GNorm = 0.0617, lr_0 = 4.4348e-04
Validation auc = 0.921993
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.470806
Epoch 18
Loss = 1.5209e-02, PNorm = 37.8133, GNorm = 0.6070, lr_0 = 4.3297e-04
Loss = 1.0091e-02, PNorm = 37.8218, GNorm = 0.0424, lr_0 = 4.2271e-04
Loss = 7.1185e-02, PNorm = 37.8226, GNorm = 1.2194, lr_0 = 4.2170e-04
Validation auc = 0.920098
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.477992
Epoch 19
Loss = 1.1471e-02, PNorm = 37.8303, GNorm = 0.0231, lr_0 = 4.1170e-04
Loss = 1.7062e-02, PNorm = 37.8352, GNorm = 0.0204, lr_0 = 4.0195e-04
Validation auc = 0.921271
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.477658
Epoch 20
Loss = 8.0437e-03, PNorm = 37.8380, GNorm = 0.0584, lr_0 = 3.9242e-04
Loss = 1.8648e-02, PNorm = 37.8459, GNorm = 0.1105, lr_0 = 3.8312e-04
Validation auc = 0.919104
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.486690
Epoch 21
Loss = 1.1754e-02, PNorm = 37.8508, GNorm = 0.0208, lr_0 = 3.7314e-04
Loss = 1.1873e-02, PNorm = 37.8571, GNorm = 0.0244, lr_0 = 3.6430e-04
Validation auc = 0.918021
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.493781
Epoch 22
Loss = 9.0938e-03, PNorm = 37.8636, GNorm = 0.0222, lr_0 = 3.5567e-04
Loss = 1.5901e-02, PNorm = 37.8668, GNorm = 0.2139, lr_0 = 3.4724e-04
Validation auc = 0.918924
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.495790
Epoch 23
Loss = 1.3360e-02, PNorm = 37.8678, GNorm = 0.0548, lr_0 = 3.3819e-04
Loss = 1.2818e-02, PNorm = 37.8733, GNorm = 0.0190, lr_0 = 3.3018e-04
Validation auc = 0.919375
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.496746
Epoch 24
Loss = 1.0797e-02, PNorm = 37.8779, GNorm = 0.0505, lr_0 = 3.2235e-04
Loss = 9.7508e-03, PNorm = 37.8843, GNorm = 0.0345, lr_0 = 3.1471e-04
Validation auc = 0.919014
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.496777
Epoch 25
Loss = 1.4643e-02, PNorm = 37.8831, GNorm = 0.0632, lr_0 = 3.0726e-04
Loss = 1.0848e-02, PNorm = 37.8879, GNorm = 0.5739, lr_0 = 2.9997e-04
Validation auc = 0.918653
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.497776
Epoch 26
Loss = 1.6355e-02, PNorm = 37.8879, GNorm = 0.0872, lr_0 = 2.9216e-04
Loss = 1.2472e-02, PNorm = 37.8929, GNorm = 0.0279, lr_0 = 2.8524e-04
Validation auc = 0.918563
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.498830
Epoch 27
Loss = 1.8159e-02, PNorm = 37.8982, GNorm = 0.1552, lr_0 = 2.7848e-04
Loss = 1.3767e-02, PNorm = 37.9019, GNorm = 0.0368, lr_0 = 2.7188e-04
Validation auc = 0.918472
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.507177
Epoch 28
Loss = 1.3330e-02, PNorm = 37.9067, GNorm = 0.2559, lr_0 = 2.6480e-04
Loss = 6.0988e-03, PNorm = 37.9107, GNorm = 0.0303, lr_0 = 2.5852e-04
Validation auc = 0.918202
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.510244
Epoch 29
Loss = 1.1065e-02, PNorm = 37.9130, GNorm = 0.0275, lr_0 = 2.5240e-04
Loss = 8.3574e-03, PNorm = 37.9147, GNorm = 0.0116, lr_0 = 2.4641e-04
Validation auc = 0.918743
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.507635
Epoch 30
Loss = 9.5859e-03, PNorm = 37.9186, GNorm = 0.0710, lr_0 = 2.4000e-04
Loss = 1.5999e-02, PNorm = 37.9211, GNorm = 0.4669, lr_0 = 2.3431e-04
Validation auc = 0.918292
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.510377
Epoch 31
Loss = 2.5324e-02, PNorm = 37.9223, GNorm = 0.4601, lr_0 = 2.2876e-04
Loss = 7.7268e-03, PNorm = 37.9244, GNorm = 0.5628, lr_0 = 2.2334e-04
Validation auc = 0.917840
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.512027
Epoch 32
Loss = 9.9173e-03, PNorm = 37.9296, GNorm = 0.0380, lr_0 = 2.1752e-04
Loss = 9.4757e-03, PNorm = 37.9339, GNorm = 0.4633, lr_0 = 2.1237e-04
Validation auc = 0.918202
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.516323
Epoch 33
Loss = 9.6786e-03, PNorm = 37.9346, GNorm = 0.2821, lr_0 = 2.0733e-04
Loss = 7.1868e-03, PNorm = 37.9359, GNorm = 0.0212, lr_0 = 2.0242e-04
Validation auc = 0.918021
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.516331
Epoch 34
Loss = 1.8279e-03, PNorm = 37.9373, GNorm = 0.0233, lr_0 = 1.9762e-04
Loss = 1.2151e-02, PNorm = 37.9402, GNorm = 0.0237, lr_0 = 1.9294e-04
Validation auc = 0.917299
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.520322
Epoch 35
Loss = 2.1173e-02, PNorm = 37.9429, GNorm = 0.4339, lr_0 = 1.8791e-04
Loss = 1.1028e-02, PNorm = 37.9452, GNorm = 0.0252, lr_0 = 1.8346e-04
Loss = 8.0436e-03, PNorm = 37.9470, GNorm = 0.2894, lr_0 = 1.7911e-04
Validation auc = 0.917931
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.519451
Epoch 36
Loss = 9.4219e-03, PNorm = 37.9492, GNorm = 0.0541, lr_0 = 1.7487e-04
Loss = 1.2383e-02, PNorm = 37.9510, GNorm = 0.0386, lr_0 = 1.7072e-04
Loss = 3.2695e-03, PNorm = 37.9512, GNorm = 0.1025, lr_0 = 1.7031e-04
Validation auc = 0.918472
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.519090
Epoch 37
Loss = 6.1290e-03, PNorm = 37.9533, GNorm = 0.0279, lr_0 = 1.6628e-04
Loss = 1.6453e-02, PNorm = 37.9564, GNorm = 0.6884, lr_0 = 1.6234e-04
Validation auc = 0.918202
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.521430
Epoch 38
Loss = 1.0829e-02, PNorm = 37.9583, GNorm = 0.0301, lr_0 = 1.5849e-04
Loss = 1.1152e-02, PNorm = 37.9601, GNorm = 0.0283, lr_0 = 1.5473e-04
Validation auc = 0.917840
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.525990
Epoch 39
Loss = 8.3303e-03, PNorm = 37.9622, GNorm = 0.0196, lr_0 = 1.5070e-04
Loss = 8.2448e-03, PNorm = 37.9627, GNorm = 0.2874, lr_0 = 1.4713e-04
Validation auc = 0.917840
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.524443
Epoch 40
Loss = 9.3078e-03, PNorm = 37.9649, GNorm = 0.3946, lr_0 = 1.4365e-04
Loss = 8.4131e-03, PNorm = 37.9668, GNorm = 0.0111, lr_0 = 1.4024e-04
Validation auc = 0.917750
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.524974
Epoch 41
Loss = 7.5326e-03, PNorm = 37.9683, GNorm = 0.0253, lr_0 = 1.3659e-04
Loss = 1.1775e-02, PNorm = 37.9707, GNorm = 0.0151, lr_0 = 1.3335e-04
Validation auc = 0.918382
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.528178
Epoch 42
Loss = 1.3989e-02, PNorm = 37.9719, GNorm = 0.0179, lr_0 = 1.3019e-04
Loss = 7.1535e-03, PNorm = 37.9736, GNorm = 0.0154, lr_0 = 1.2711e-04
Validation auc = 0.916667
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.532651
Epoch 43
Loss = 1.5606e-03, PNorm = 37.9747, GNorm = 0.0169, lr_0 = 1.2409e-04
Loss = 1.5999e-02, PNorm = 37.9760, GNorm = 0.4927, lr_0 = 1.2115e-04
Validation auc = 0.916847
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.531963
Epoch 44
Loss = 4.7719e-03, PNorm = 37.9774, GNorm = 0.0202, lr_0 = 1.1800e-04
Loss = 7.9443e-03, PNorm = 37.9795, GNorm = 0.0259, lr_0 = 1.1520e-04
Validation auc = 0.917750
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.531354
Epoch 45
Loss = 1.8457e-03, PNorm = 37.9802, GNorm = 0.0262, lr_0 = 1.1247e-04
Loss = 1.0946e-02, PNorm = 37.9813, GNorm = 0.4942, lr_0 = 1.0981e-04
Validation auc = 0.917931
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.530693
Epoch 46
Loss = 7.5702e-03, PNorm = 37.9831, GNorm = 0.3118, lr_0 = 1.0695e-04
Loss = 9.4416e-03, PNorm = 37.9849, GNorm = 0.5372, lr_0 = 1.0441e-04
Validation auc = 0.917570
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.531918
Epoch 47
Loss = 1.3186e-03, PNorm = 37.9860, GNorm = 0.0436, lr_0 = 1.0194e-04
Loss = 1.2295e-02, PNorm = 37.9873, GNorm = 0.8410, lr_0 = 1.0000e-04
Validation auc = 0.917750
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.532903
Epoch 48
Loss = 9.8724e-03, PNorm = 37.9892, GNorm = 0.2663, lr_0 = 1.0000e-04
Loss = 1.2199e-02, PNorm = 37.9903, GNorm = 0.4486, lr_0 = 1.0000e-04
Validation auc = 0.917750
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.535032
Epoch 49
Loss = 4.5001e-03, PNorm = 37.9923, GNorm = 0.0177, lr_0 = 1.0000e-04
Loss = 1.0551e-02, PNorm = 37.9935, GNorm = 0.0159, lr_0 = 1.0000e-04
Validation auc = 0.917389
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.536140
Model 0 best validation auc = 0.926056 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.896888
Model 0 test accuracy = 0.833333
Model 0 test f1 = 0.874636
Model 0 test binary_cross_entropy = 0.446365
Ensemble test auc = 0.896888
Ensemble test accuracy = 0.833333
Ensemble test f1 = 0.874636
Ensemble test binary_cross_entropy = 0.446365
5-fold cross validation
	Seed 0 ==> test auc = 0.905080
	Seed 0 ==> test accuracy = 0.817829
	Seed 0 ==> test f1 = 0.863768
	Seed 0 ==> test binary_cross_entropy = 0.431686
	Seed 1 ==> test auc = 0.890257
	Seed 1 ==> test accuracy = 0.829457
	Seed 1 ==> test f1 = 0.870588
	Seed 1 ==> test binary_cross_entropy = 0.495855
	Seed 2 ==> test auc = 0.919173
	Seed 2 ==> test accuracy = 0.844961
	Seed 2 ==> test f1 = 0.889503
	Seed 2 ==> test binary_cross_entropy = 0.383963
	Seed 3 ==> test auc = 0.905244
	Seed 3 ==> test accuracy = 0.841085
	Seed 3 ==> test f1 = 0.881844
	Seed 3 ==> test binary_cross_entropy = 0.437109
	Seed 4 ==> test auc = 0.896888
	Seed 4 ==> test accuracy = 0.833333
	Seed 4 ==> test f1 = 0.874636
	Seed 4 ==> test binary_cross_entropy = 0.446365
Overall test auc = 0.903329 +/- 0.009697
Overall test accuracy = 0.833333 +/- 0.009494
Overall test f1 = 0.876068 +/- 0.008913
Overall test binary_cross_entropy = 0.438996 +/- 0.035701
Elapsed time = 0:04:05
Command line
python /home/ddunstan/.conda/envs/chemprop/bin/chemprop_train --data_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-random-train.csv --dataset_type classification --save_dir /home/ddunstan/Chemistry-Capstone/Complex_Models/bace-random --epochs 50 --extra_metrics accuracy f1 binary_cross_entropy --metric auc --target_columns active --smiles_columns mol --num_folds 5 --split_sizes 0.8 0 0.2 --separate_val_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-random-validate.csv --features_generator morgan
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-random-train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy', 'f1', 'binary_cross_entropy'],
 'features_generator': ['morgan'],
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy', 'f1', 'binary_cross_entropy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/ddunstan/Chemistry-Capstone/Complex_Models/bace-random',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-random-validate.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['mol'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.0, 0.2],
 'split_type': 'random',
 'target_columns': ['active'],
 'target_weights': None,
 'task_names': ['active'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.0636e-01, PNorm = 37.2374, GNorm = 2.4040, lr_0 = 3.4750e-04
Loss = 4.4864e-01, PNorm = 37.2598, GNorm = 2.2923, lr_0 = 5.7250e-04
Loss = 5.1616e-01, PNorm = 37.2635, GNorm = 2.8100, lr_0 = 5.9500e-04
Validation auc = 0.904930
Validation accuracy = 0.850220
Validation f1 = 0.895706
Validation binary_cross_entropy = 0.360867
Epoch 1
Loss = 1.9126e-01, PNorm = 37.3005, GNorm = 0.9524, lr_0 = 8.2000e-04
Loss = 2.1026e-01, PNorm = 37.3386, GNorm = 0.7545, lr_0 = 9.9521e-04
Validation auc = 0.909173
Validation accuracy = 0.854626
Validation f1 = 0.895899
Validation binary_cross_entropy = 0.372195
Epoch 2
Loss = 9.7984e-02, PNorm = 37.3858, GNorm = 0.7758, lr_0 = 9.7163e-04
Loss = 9.5793e-02, PNorm = 37.4192, GNorm = 0.7521, lr_0 = 9.4860e-04
Validation auc = 0.907277
Validation accuracy = 0.859031
Validation f1 = 0.898734
Validation binary_cross_entropy = 0.396692
Epoch 3
Loss = 5.3043e-02, PNorm = 37.4568, GNorm = 0.4827, lr_0 = 9.2390e-04
Loss = 4.9976e-02, PNorm = 37.4933, GNorm = 0.9397, lr_0 = 9.0200e-04
Validation auc = 0.908722
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.412730
Epoch 4
Loss = 3.7626e-02, PNorm = 37.5175, GNorm = 0.3484, lr_0 = 8.8063e-04
Loss = 4.4056e-02, PNorm = 37.5423, GNorm = 0.3998, lr_0 = 8.5976e-04
Validation auc = 0.909534
Validation accuracy = 0.837004
Validation f1 = 0.884735
Validation binary_cross_entropy = 0.430442
Epoch 5
Loss = 2.9894e-02, PNorm = 37.5670, GNorm = 0.6735, lr_0 = 8.3737e-04
Loss = 3.1850e-02, PNorm = 37.5783, GNorm = 0.7607, lr_0 = 8.1752e-04
Validation auc = 0.906645
Validation accuracy = 0.854626
Validation f1 = 0.895899
Validation binary_cross_entropy = 0.443423
Epoch 6
Loss = 2.1694e-02, PNorm = 37.5940, GNorm = 0.2100, lr_0 = 7.9815e-04
Loss = 2.6785e-02, PNorm = 37.6168, GNorm = 0.2223, lr_0 = 7.7923e-04
Validation auc = 0.901499
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.475692
Epoch 7
Loss = 2.3429e-02, PNorm = 37.6313, GNorm = 0.3373, lr_0 = 7.5894e-04
Loss = 2.1058e-02, PNorm = 37.6455, GNorm = 0.3054, lr_0 = 7.4095e-04
Validation auc = 0.903485
Validation accuracy = 0.850220
Validation f1 = 0.892405
Validation binary_cross_entropy = 0.481673
Epoch 8
Loss = 2.0530e-02, PNorm = 37.6610, GNorm = 0.3041, lr_0 = 7.2339e-04
Loss = 2.3219e-02, PNorm = 37.6767, GNorm = 0.4650, lr_0 = 7.0625e-04
Validation auc = 0.902943
Validation accuracy = 0.850220
Validation f1 = 0.893750
Validation binary_cross_entropy = 0.494369
Epoch 9
Loss = 1.5021e-02, PNorm = 37.6865, GNorm = 0.2649, lr_0 = 6.8951e-04
Loss = 1.7513e-02, PNorm = 37.6956, GNorm = 0.1552, lr_0 = 6.7317e-04
Validation auc = 0.901047
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.500010
Epoch 10
Loss = 1.2069e-02, PNorm = 37.7051, GNorm = 0.0712, lr_0 = 6.5564e-04
Loss = 1.9073e-02, PNorm = 37.7191, GNorm = 0.3130, lr_0 = 6.4010e-04
Validation auc = 0.901228
Validation accuracy = 0.841410
Validation f1 = 0.886792
Validation binary_cross_entropy = 0.508099
Epoch 11
Loss = 8.9080e-03, PNorm = 37.7275, GNorm = 0.0773, lr_0 = 6.2493e-04
Loss = 1.6629e-02, PNorm = 37.7378, GNorm = 0.1668, lr_0 = 6.1012e-04
Validation auc = 0.899874
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.533655
Epoch 12
Loss = 8.0668e-03, PNorm = 37.7502, GNorm = 0.1185, lr_0 = 5.9424e-04
Loss = 1.6289e-02, PNorm = 37.7626, GNorm = 0.1147, lr_0 = 5.8015e-04
Validation auc = 0.899332
Validation accuracy = 0.841410
Validation f1 = 0.886792
Validation binary_cross_entropy = 0.533144
Epoch 13
Loss = 6.4556e-03, PNorm = 37.7637, GNorm = 0.0820, lr_0 = 5.6640e-04
Loss = 1.2759e-02, PNorm = 37.7728, GNorm = 0.0504, lr_0 = 5.5298e-04
Validation auc = 0.899783
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.539351
Epoch 14
Loss = 4.6719e-03, PNorm = 37.7822, GNorm = 0.0467, lr_0 = 5.3858e-04
Loss = 1.1906e-02, PNorm = 37.7885, GNorm = 0.3478, lr_0 = 5.2582e-04
Validation auc = 0.899151
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.551530
Epoch 15
Loss = 1.0117e-02, PNorm = 37.8019, GNorm = 0.0673, lr_0 = 5.1335e-04
Loss = 1.3107e-02, PNorm = 37.8091, GNorm = 0.0959, lr_0 = 5.0119e-04
Validation auc = 0.899242
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.558327
Epoch 16
Loss = 4.3595e-03, PNorm = 37.8158, GNorm = 0.0529, lr_0 = 4.8814e-04
Loss = 1.2550e-02, PNorm = 37.8203, GNorm = 0.2281, lr_0 = 4.7657e-04
Validation auc = 0.898339
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.561793
Epoch 17
Loss = 4.4012e-03, PNorm = 37.8282, GNorm = 0.0588, lr_0 = 4.6527e-04
Loss = 9.9203e-03, PNorm = 37.8378, GNorm = 0.0486, lr_0 = 4.5425e-04
Loss = 1.3029e-02, PNorm = 37.8422, GNorm = 0.0410, lr_0 = 4.4348e-04
Validation auc = 0.898339
Validation accuracy = 0.841410
Validation f1 = 0.886792
Validation binary_cross_entropy = 0.568804
Epoch 18
Loss = 8.7786e-03, PNorm = 37.8453, GNorm = 0.0548, lr_0 = 4.3297e-04
Loss = 1.5043e-02, PNorm = 37.8519, GNorm = 0.0736, lr_0 = 4.2271e-04
Loss = 1.6033e-03, PNorm = 37.8527, GNorm = 0.0279, lr_0 = 4.2170e-04
Validation auc = 0.897165
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.571696
Epoch 19
Loss = 8.2324e-03, PNorm = 37.8612, GNorm = 0.2547, lr_0 = 4.1170e-04
Loss = 1.4108e-02, PNorm = 37.8645, GNorm = 0.0289, lr_0 = 4.0195e-04
Validation auc = 0.897616
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.576160
Epoch 20
Loss = 1.1832e-02, PNorm = 37.8676, GNorm = 0.0526, lr_0 = 3.9242e-04
Loss = 1.0064e-02, PNorm = 37.8743, GNorm = 0.3820, lr_0 = 3.8312e-04
Validation auc = 0.896894
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.580028
Epoch 21
Loss = 1.1120e-02, PNorm = 37.8823, GNorm = 0.2316, lr_0 = 3.7314e-04
Loss = 7.1490e-03, PNorm = 37.8865, GNorm = 0.0315, lr_0 = 3.6430e-04
Validation auc = 0.897165
Validation accuracy = 0.841410
Validation f1 = 0.886792
Validation binary_cross_entropy = 0.586549
Epoch 22
Loss = 8.1020e-03, PNorm = 37.8934, GNorm = 0.0497, lr_0 = 3.5567e-04
Loss = 9.0021e-03, PNorm = 37.8996, GNorm = 0.0437, lr_0 = 3.4724e-04
Validation auc = 0.896443
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.596891
Epoch 23
Loss = 7.6622e-03, PNorm = 37.9022, GNorm = 0.0411, lr_0 = 3.3819e-04
Loss = 1.0710e-02, PNorm = 37.9072, GNorm = 0.4272, lr_0 = 3.3018e-04
Validation auc = 0.895901
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.598015
Epoch 24
Loss = 8.5582e-03, PNorm = 37.9133, GNorm = 0.0605, lr_0 = 3.2235e-04
Loss = 9.6971e-03, PNorm = 37.9166, GNorm = 0.3603, lr_0 = 3.1471e-04
Validation auc = 0.896082
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.597777
Epoch 25
Loss = 1.4066e-02, PNorm = 37.9190, GNorm = 0.0276, lr_0 = 3.0726e-04
Loss = 4.9932e-03, PNorm = 37.9212, GNorm = 0.0534, lr_0 = 2.9997e-04
Validation auc = 0.896262
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.598374
Epoch 26
Loss = 7.9437e-03, PNorm = 37.9290, GNorm = 0.2306, lr_0 = 2.9216e-04
Loss = 8.5743e-03, PNorm = 37.9354, GNorm = 0.0466, lr_0 = 2.8524e-04
Validation auc = 0.895991
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.609695
Epoch 27
Loss = 1.3328e-02, PNorm = 37.9401, GNorm = 0.3380, lr_0 = 2.7848e-04
Loss = 7.7194e-03, PNorm = 37.9441, GNorm = 0.4189, lr_0 = 2.7188e-04
Validation auc = 0.894637
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.617144
Epoch 28
Loss = 9.3112e-03, PNorm = 37.9476, GNorm = 0.0486, lr_0 = 2.6480e-04
Loss = 1.1168e-02, PNorm = 37.9485, GNorm = 0.3403, lr_0 = 2.5852e-04
Validation auc = 0.895991
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.610057
Epoch 29
Loss = 1.2036e-02, PNorm = 37.9523, GNorm = 0.2989, lr_0 = 2.5240e-04
Loss = 6.2966e-03, PNorm = 37.9578, GNorm = 0.0260, lr_0 = 2.4641e-04
Validation auc = 0.895179
Validation accuracy = 0.841410
Validation f1 = 0.887500
Validation binary_cross_entropy = 0.621397
Epoch 30
Loss = 1.0570e-02, PNorm = 37.9624, GNorm = 0.0376, lr_0 = 2.4000e-04
Loss = 6.9263e-03, PNorm = 37.9661, GNorm = 0.0418, lr_0 = 2.3431e-04
Validation auc = 0.894908
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.625789
Epoch 31
Loss = 6.7195e-03, PNorm = 37.9693, GNorm = 0.0247, lr_0 = 2.2876e-04
Loss = 9.8224e-03, PNorm = 37.9732, GNorm = 0.4528, lr_0 = 2.2334e-04
Validation auc = 0.894998
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.621170
Epoch 32
Loss = 1.8445e-03, PNorm = 37.9768, GNorm = 0.0360, lr_0 = 2.1752e-04
Loss = 8.8151e-03, PNorm = 37.9796, GNorm = 0.0218, lr_0 = 2.1237e-04
Validation auc = 0.895088
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.623736
Epoch 33
Loss = 1.5014e-03, PNorm = 37.9837, GNorm = 0.0302, lr_0 = 2.0733e-04
Loss = 9.6305e-03, PNorm = 37.9875, GNorm = 0.0410, lr_0 = 2.0242e-04
Validation auc = 0.895359
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.626456
Epoch 34
Loss = 1.3771e-03, PNorm = 37.9913, GNorm = 0.0166, lr_0 = 1.9762e-04
Loss = 8.0031e-03, PNorm = 37.9944, GNorm = 0.5326, lr_0 = 1.9294e-04
Validation auc = 0.894366
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.634296
Epoch 35
Loss = 1.3379e-02, PNorm = 37.9971, GNorm = 0.2733, lr_0 = 1.8791e-04
Loss = 7.7631e-03, PNorm = 37.9997, GNorm = 0.2666, lr_0 = 1.8346e-04
Loss = 7.2351e-03, PNorm = 38.0026, GNorm = 0.0369, lr_0 = 1.7911e-04
Validation auc = 0.894998
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.628447
Epoch 36
Loss = 7.7777e-03, PNorm = 38.0066, GNorm = 0.0455, lr_0 = 1.7487e-04
Loss = 5.6749e-03, PNorm = 38.0101, GNorm = 0.0246, lr_0 = 1.7072e-04
Loss = 5.6017e-02, PNorm = 38.0106, GNorm = 0.7065, lr_0 = 1.7031e-04
Validation auc = 0.895179
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.634838
Epoch 37
Loss = 4.2340e-03, PNorm = 38.0142, GNorm = 0.2604, lr_0 = 1.6628e-04
Loss = 1.0622e-02, PNorm = 38.0186, GNorm = 0.2991, lr_0 = 1.6234e-04
Validation auc = 0.894818
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.639535
Epoch 38
Loss = 2.6267e-03, PNorm = 38.0226, GNorm = 0.0304, lr_0 = 1.5849e-04
Loss = 1.1154e-02, PNorm = 38.0255, GNorm = 0.0337, lr_0 = 1.5473e-04
Validation auc = 0.894276
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.641894
Epoch 39
Loss = 7.2216e-03, PNorm = 38.0264, GNorm = 0.0444, lr_0 = 1.5070e-04
Loss = 6.1645e-03, PNorm = 38.0288, GNorm = 0.2871, lr_0 = 1.4713e-04
Validation auc = 0.895269
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.634377
Epoch 40
Loss = 5.5098e-03, PNorm = 38.0318, GNorm = 0.2742, lr_0 = 1.4365e-04
Loss = 8.2457e-03, PNorm = 38.0363, GNorm = 0.0430, lr_0 = 1.4024e-04
Validation auc = 0.894276
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.643613
Epoch 41
Loss = 1.0763e-02, PNorm = 38.0391, GNorm = 0.2294, lr_0 = 1.3659e-04
Loss = 6.0696e-03, PNorm = 38.0423, GNorm = 0.0166, lr_0 = 1.3335e-04
Validation auc = 0.893915
Validation accuracy = 0.850220
Validation f1 = 0.893750
Validation binary_cross_entropy = 0.651385
Epoch 42
Loss = 5.1071e-03, PNorm = 38.0446, GNorm = 0.0215, lr_0 = 1.3019e-04
Loss = 8.4404e-03, PNorm = 38.0458, GNorm = 0.0419, lr_0 = 1.2711e-04
Validation auc = 0.894095
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.647101
Epoch 43
Loss = 3.8702e-03, PNorm = 38.0496, GNorm = 0.2868, lr_0 = 1.2409e-04
Loss = 7.9208e-03, PNorm = 38.0538, GNorm = 0.4875, lr_0 = 1.2115e-04
Validation auc = 0.893644
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.653279
Epoch 44
Loss = 1.0065e-02, PNorm = 38.0559, GNorm = 0.0805, lr_0 = 1.1800e-04
Loss = 4.7401e-03, PNorm = 38.0577, GNorm = 0.2899, lr_0 = 1.1520e-04
Validation auc = 0.894366
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.647605
Epoch 45
Loss = 7.2519e-03, PNorm = 38.0601, GNorm = 0.0252, lr_0 = 1.1247e-04
Loss = 3.1443e-03, PNorm = 38.0624, GNorm = 0.0261, lr_0 = 1.0981e-04
Validation auc = 0.894456
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.650114
Epoch 46
Loss = 6.6660e-03, PNorm = 38.0664, GNorm = 0.2965, lr_0 = 1.0695e-04
Loss = 6.3639e-03, PNorm = 38.0692, GNorm = 0.4542, lr_0 = 1.0441e-04
Validation auc = 0.893824
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.653996
Epoch 47
Loss = 4.3452e-03, PNorm = 38.0719, GNorm = 0.0274, lr_0 = 1.0194e-04
Loss = 4.7030e-03, PNorm = 38.0738, GNorm = 0.0259, lr_0 = 1.0000e-04
Validation auc = 0.893824
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.654459
Epoch 48
Loss = 1.4834e-03, PNorm = 38.0768, GNorm = 0.0229, lr_0 = 1.0000e-04
Loss = 7.7407e-03, PNorm = 38.0804, GNorm = 0.0198, lr_0 = 1.0000e-04
Validation auc = 0.893644
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.658743
Epoch 49
Loss = 3.6215e-03, PNorm = 38.0831, GNorm = 0.2065, lr_0 = 1.0000e-04
Loss = 7.9537e-03, PNorm = 38.0861, GNorm = 0.0292, lr_0 = 1.0000e-04
Validation auc = 0.894186
Validation accuracy = 0.845815
Validation f1 = 0.890282
Validation binary_cross_entropy = 0.651630
Model 0 best validation auc = 0.909534 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.905080
Model 0 test accuracy = 0.817829
Model 0 test f1 = 0.863768
Model 0 test binary_cross_entropy = 0.431686
Ensemble test auc = 0.905080
Ensemble test accuracy = 0.817829
Ensemble test f1 = 0.863768
Ensemble test binary_cross_entropy = 0.431686
Fold 1
Splitting data with seed 1
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.1714e-01, PNorm = 37.2373, GNorm = 2.6834, lr_0 = 3.4750e-04
Loss = 4.6270e-01, PNorm = 37.2569, GNorm = 1.9241, lr_0 = 5.7250e-04
Loss = 5.7018e-01, PNorm = 37.2603, GNorm = 4.7867, lr_0 = 5.9500e-04
Validation auc = 0.907909
Validation accuracy = 0.845815
Validation f1 = 0.888179
Validation binary_cross_entropy = 0.351812
Epoch 1
Loss = 1.6920e-01, PNorm = 37.3064, GNorm = 0.8133, lr_0 = 8.2000e-04
Loss = 1.9228e-01, PNorm = 37.3427, GNorm = 1.7214, lr_0 = 9.9521e-04
Validation auc = 0.909986
Validation accuracy = 0.837004
Validation f1 = 0.881789
Validation binary_cross_entropy = 0.378145
Epoch 2
Loss = 9.8627e-02, PNorm = 37.3950, GNorm = 0.6243, lr_0 = 9.7163e-04
Loss = 9.5285e-02, PNorm = 37.4254, GNorm = 0.7341, lr_0 = 9.4860e-04
Validation auc = 0.914410
Validation accuracy = 0.854626
Validation f1 = 0.896552
Validation binary_cross_entropy = 0.378398
Epoch 3
Loss = 5.3043e-02, PNorm = 37.4633, GNorm = 0.6741, lr_0 = 9.2390e-04
Loss = 6.0809e-02, PNorm = 37.5060, GNorm = 0.4620, lr_0 = 9.0200e-04
Validation auc = 0.914951
Validation accuracy = 0.837004
Validation f1 = 0.888218
Validation binary_cross_entropy = 0.411306
Epoch 4
Loss = 3.5775e-02, PNorm = 37.5220, GNorm = 0.2540, lr_0 = 8.8063e-04
Loss = 4.0767e-02, PNorm = 37.5399, GNorm = 0.3309, lr_0 = 8.5976e-04
Validation auc = 0.914229
Validation accuracy = 0.823789
Validation f1 = 0.875000
Validation binary_cross_entropy = 0.404582
Epoch 5
Loss = 3.0489e-02, PNorm = 37.5686, GNorm = 0.3344, lr_0 = 8.3737e-04
Loss = 2.8763e-02, PNorm = 37.5905, GNorm = 0.7127, lr_0 = 8.1752e-04
Validation auc = 0.913687
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.422029
Epoch 6
Loss = 1.9934e-02, PNorm = 37.5961, GNorm = 0.0825, lr_0 = 7.9815e-04
Loss = 3.3363e-02, PNorm = 37.6144, GNorm = 0.6561, lr_0 = 7.7923e-04
Validation auc = 0.908541
Validation accuracy = 0.823789
Validation f1 = 0.877301
Validation binary_cross_entropy = 0.440532
Epoch 7
Loss = 1.8754e-02, PNorm = 37.6339, GNorm = 0.1090, lr_0 = 7.5894e-04
Loss = 2.1799e-02, PNorm = 37.6494, GNorm = 0.2151, lr_0 = 7.4095e-04
Validation auc = 0.908180
Validation accuracy = 0.823789
Validation f1 = 0.875776
Validation binary_cross_entropy = 0.452543
Epoch 8
Loss = 1.1739e-02, PNorm = 37.6596, GNorm = 0.1261, lr_0 = 7.2339e-04
Loss = 2.5087e-02, PNorm = 37.6726, GNorm = 0.5924, lr_0 = 7.0625e-04
Validation auc = 0.908722
Validation accuracy = 0.823789
Validation f1 = 0.876543
Validation binary_cross_entropy = 0.460940
Epoch 9
Loss = 1.7703e-02, PNorm = 37.6872, GNorm = 0.2023, lr_0 = 6.8951e-04
Loss = 2.2542e-02, PNorm = 37.7002, GNorm = 0.0852, lr_0 = 6.7317e-04
Validation auc = 0.907728
Validation accuracy = 0.832599
Validation f1 = 0.881988
Validation binary_cross_entropy = 0.476811
Epoch 10
Loss = 2.3762e-02, PNorm = 37.7096, GNorm = 0.6663, lr_0 = 6.5564e-04
Loss = 2.0301e-02, PNorm = 37.7158, GNorm = 0.3642, lr_0 = 6.4010e-04
Validation auc = 0.905381
Validation accuracy = 0.823789
Validation f1 = 0.875776
Validation binary_cross_entropy = 0.478971
Epoch 11
Loss = 1.2556e-02, PNorm = 37.7282, GNorm = 0.1450, lr_0 = 6.2493e-04
Loss = 1.0075e-02, PNorm = 37.7386, GNorm = 0.0597, lr_0 = 6.1012e-04
Validation auc = 0.904478
Validation accuracy = 0.828194
Validation f1 = 0.879257
Validation binary_cross_entropy = 0.487991
Epoch 12
Loss = 1.9051e-02, PNorm = 37.7460, GNorm = 0.1991, lr_0 = 5.9424e-04
Loss = 1.7729e-02, PNorm = 37.7556, GNorm = 0.0320, lr_0 = 5.8015e-04
Validation auc = 0.904478
Validation accuracy = 0.828194
Validation f1 = 0.879257
Validation binary_cross_entropy = 0.492994
Epoch 13
Loss = 1.2214e-02, PNorm = 37.7657, GNorm = 0.1114, lr_0 = 5.6640e-04
Loss = 1.5041e-02, PNorm = 37.7734, GNorm = 0.3375, lr_0 = 5.5298e-04
Validation auc = 0.904749
Validation accuracy = 0.823789
Validation f1 = 0.876543
Validation binary_cross_entropy = 0.496643
Epoch 14
Loss = 4.0452e-03, PNorm = 37.7800, GNorm = 0.0775, lr_0 = 5.3858e-04
Loss = 1.5744e-02, PNorm = 37.7854, GNorm = 0.3828, lr_0 = 5.2582e-04
Validation auc = 0.903666
Validation accuracy = 0.823789
Validation f1 = 0.875776
Validation binary_cross_entropy = 0.507452
Epoch 15
Loss = 1.9424e-02, PNorm = 37.7975, GNorm = 0.2576, lr_0 = 5.1335e-04
Loss = 1.4226e-02, PNorm = 37.8066, GNorm = 0.1326, lr_0 = 5.0119e-04
Validation auc = 0.904568
Validation accuracy = 0.823789
Validation f1 = 0.876543
Validation binary_cross_entropy = 0.512171
Epoch 16
Loss = 1.2568e-02, PNorm = 37.8103, GNorm = 0.2726, lr_0 = 4.8814e-04
Loss = 1.8476e-02, PNorm = 37.8136, GNorm = 0.0966, lr_0 = 4.7657e-04
Validation auc = 0.903936
Validation accuracy = 0.810573
Validation f1 = 0.865204
Validation binary_cross_entropy = 0.515697
Epoch 17
Loss = 2.9739e-03, PNorm = 37.8221, GNorm = 0.0419, lr_0 = 4.6527e-04
Loss = 1.0160e-02, PNorm = 37.8279, GNorm = 0.0302, lr_0 = 4.5425e-04
Loss = 1.9988e-02, PNorm = 37.8357, GNorm = 0.8775, lr_0 = 4.4348e-04
Validation auc = 0.903936
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.523398
Epoch 18
Loss = 9.5619e-03, PNorm = 37.8466, GNorm = 0.0282, lr_0 = 4.3297e-04
Loss = 2.1372e-02, PNorm = 37.8479, GNorm = 0.0811, lr_0 = 4.2271e-04
Loss = 1.0844e-02, PNorm = 37.8476, GNorm = 0.2842, lr_0 = 4.2170e-04
Validation auc = 0.904839
Validation accuracy = 0.819383
Validation f1 = 0.872274
Validation binary_cross_entropy = 0.521351
Epoch 19
Loss = 1.2940e-02, PNorm = 37.8467, GNorm = 0.3667, lr_0 = 4.1170e-04
Loss = 1.6390e-02, PNorm = 37.8533, GNorm = 0.5336, lr_0 = 4.0195e-04
Validation auc = 0.903304
Validation accuracy = 0.814978
Validation f1 = 0.867925
Validation binary_cross_entropy = 0.522313
Epoch 20
Loss = 7.2525e-03, PNorm = 37.8622, GNorm = 0.0391, lr_0 = 3.9242e-04
Loss = 1.5314e-02, PNorm = 37.8683, GNorm = 0.4300, lr_0 = 3.8312e-04
Validation auc = 0.902176
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.533725
Epoch 21
Loss = 1.7764e-02, PNorm = 37.8778, GNorm = 0.4432, lr_0 = 3.7314e-04
Loss = 1.1665e-02, PNorm = 37.8820, GNorm = 0.4026, lr_0 = 3.6430e-04
Validation auc = 0.902311
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.537144
Epoch 22
Loss = 1.3436e-02, PNorm = 37.8823, GNorm = 0.2320, lr_0 = 3.5567e-04
Loss = 8.3215e-03, PNorm = 37.8866, GNorm = 0.0518, lr_0 = 3.4724e-04
Validation auc = 0.901589
Validation accuracy = 0.819383
Validation f1 = 0.873065
Validation binary_cross_entropy = 0.537507
Epoch 23
Loss = 8.0844e-03, PNorm = 37.8925, GNorm = 0.0539, lr_0 = 3.3819e-04
Loss = 1.0603e-02, PNorm = 37.8969, GNorm = 0.0112, lr_0 = 3.3018e-04
Validation auc = 0.902672
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.542714
Epoch 24
Loss = 1.0085e-02, PNorm = 37.9037, GNorm = 0.0564, lr_0 = 3.2235e-04
Loss = 1.5144e-02, PNorm = 37.9098, GNorm = 0.1644, lr_0 = 3.1471e-04
Validation auc = 0.902582
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.550512
Epoch 25
Loss = 4.9668e-03, PNorm = 37.9144, GNorm = 0.0238, lr_0 = 3.0726e-04
Loss = 1.5361e-02, PNorm = 37.9178, GNorm = 0.0212, lr_0 = 2.9997e-04
Validation auc = 0.902582
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.549670
Epoch 26
Loss = 1.2912e-02, PNorm = 37.9200, GNorm = 0.0249, lr_0 = 2.9216e-04
Loss = 1.4584e-02, PNorm = 37.9242, GNorm = 0.0131, lr_0 = 2.8524e-04
Validation auc = 0.901228
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.553861
Epoch 27
Loss = 1.7432e-02, PNorm = 37.9256, GNorm = 0.3264, lr_0 = 2.7848e-04
Loss = 1.0791e-02, PNorm = 37.9290, GNorm = 0.0417, lr_0 = 2.7188e-04
Validation auc = 0.903124
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.554007
Epoch 28
Loss = 5.0513e-03, PNorm = 37.9340, GNorm = 0.0335, lr_0 = 2.6480e-04
Loss = 6.9627e-03, PNorm = 37.9387, GNorm = 0.0278, lr_0 = 2.5852e-04
Validation auc = 0.902040
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.557116
Epoch 29
Loss = 1.9963e-02, PNorm = 37.9392, GNorm = 0.5705, lr_0 = 2.5240e-04
Loss = 7.4011e-03, PNorm = 37.9424, GNorm = 0.0487, lr_0 = 2.4641e-04
Validation auc = 0.900867
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.559367
Epoch 30
Loss = 1.4963e-02, PNorm = 37.9466, GNorm = 0.0428, lr_0 = 2.4000e-04
Loss = 8.9123e-03, PNorm = 37.9501, GNorm = 0.0140, lr_0 = 2.3431e-04
Validation auc = 0.900325
Validation accuracy = 0.806167
Validation f1 = 0.862500
Validation binary_cross_entropy = 0.562917
Epoch 31
Loss = 7.0763e-03, PNorm = 37.9529, GNorm = 0.0215, lr_0 = 2.2876e-04
Loss = 9.5637e-03, PNorm = 37.9570, GNorm = 0.3450, lr_0 = 2.2334e-04
Validation auc = 0.901589
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.563863
Epoch 32
Loss = 1.2935e-02, PNorm = 37.9583, GNorm = 0.2140, lr_0 = 2.1752e-04
Loss = 9.5414e-03, PNorm = 37.9607, GNorm = 0.0151, lr_0 = 2.1237e-04
Validation auc = 0.900596
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.565708
Epoch 33
Loss = 2.1291e-03, PNorm = 37.9634, GNorm = 0.0137, lr_0 = 2.0733e-04
Loss = 1.0921e-02, PNorm = 37.9657, GNorm = 0.4666, lr_0 = 2.0242e-04
Validation auc = 0.900776
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.568360
Epoch 34
Loss = 1.6738e-02, PNorm = 37.9691, GNorm = 0.2659, lr_0 = 1.9762e-04
Loss = 1.3953e-02, PNorm = 37.9722, GNorm = 0.4706, lr_0 = 1.9294e-04
Validation auc = 0.900144
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.571550
Epoch 35
Loss = 1.4349e-03, PNorm = 37.9750, GNorm = 0.0218, lr_0 = 1.8791e-04
Loss = 9.3378e-03, PNorm = 37.9783, GNorm = 0.0462, lr_0 = 1.8346e-04
Loss = 1.2020e-02, PNorm = 37.9801, GNorm = 0.0244, lr_0 = 1.7911e-04
Validation auc = 0.900144
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.573693
Epoch 36
Loss = 6.6689e-03, PNorm = 37.9823, GNorm = 0.1305, lr_0 = 1.7487e-04
Loss = 1.1555e-02, PNorm = 37.9845, GNorm = 0.3653, lr_0 = 1.7072e-04
Loss = 3.0858e-02, PNorm = 37.9846, GNorm = 0.7904, lr_0 = 1.7031e-04
Validation auc = 0.900325
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.575413
Epoch 37
Loss = 1.0815e-02, PNorm = 37.9871, GNorm = 0.5987, lr_0 = 1.6628e-04
Loss = 1.1508e-02, PNorm = 37.9879, GNorm = 0.0382, lr_0 = 1.6234e-04
Validation auc = 0.900596
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.574723
Epoch 38
Loss = 1.3419e-02, PNorm = 37.9906, GNorm = 0.0327, lr_0 = 1.5849e-04
Loss = 9.5334e-03, PNorm = 37.9931, GNorm = 0.3301, lr_0 = 1.5473e-04
Validation auc = 0.900235
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.577653
Epoch 39
Loss = 9.9092e-03, PNorm = 37.9952, GNorm = 0.1494, lr_0 = 1.5070e-04
Loss = 9.8169e-03, PNorm = 37.9974, GNorm = 0.0570, lr_0 = 1.4713e-04
Validation auc = 0.900325
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.578896
Epoch 40
Loss = 9.8931e-03, PNorm = 37.9989, GNorm = 0.1612, lr_0 = 1.4365e-04
Loss = 1.1559e-02, PNorm = 38.0010, GNorm = 0.2827, lr_0 = 1.4024e-04
Validation auc = 0.900235
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.580510
Epoch 41
Loss = 1.7093e-02, PNorm = 38.0039, GNorm = 0.5042, lr_0 = 1.3659e-04
Loss = 4.0576e-03, PNorm = 38.0055, GNorm = 0.1894, lr_0 = 1.3335e-04
Validation auc = 0.899783
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.582589
Epoch 42
Loss = 1.0486e-02, PNorm = 38.0085, GNorm = 0.0097, lr_0 = 1.3019e-04
Loss = 8.4785e-03, PNorm = 38.0106, GNorm = 0.1658, lr_0 = 1.2711e-04
Validation auc = 0.900054
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.585188
Epoch 43
Loss = 7.9565e-03, PNorm = 38.0115, GNorm = 0.3316, lr_0 = 1.2409e-04
Loss = 6.3798e-03, PNorm = 38.0122, GNorm = 0.0109, lr_0 = 1.2115e-04
Validation auc = 0.900054
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.584971
Epoch 44
Loss = 1.0888e-02, PNorm = 38.0146, GNorm = 0.2956, lr_0 = 1.1800e-04
Loss = 7.6156e-03, PNorm = 38.0170, GNorm = 0.0151, lr_0 = 1.1520e-04
Validation auc = 0.899332
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.587253
Epoch 45
Loss = 5.5362e-03, PNorm = 38.0185, GNorm = 0.0134, lr_0 = 1.1247e-04
Loss = 9.9742e-03, PNorm = 38.0195, GNorm = 0.2949, lr_0 = 1.0981e-04
Validation auc = 0.900235
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.587248
Epoch 46
Loss = 3.8102e-03, PNorm = 38.0217, GNorm = 0.0187, lr_0 = 1.0695e-04
Loss = 1.2988e-02, PNorm = 38.0235, GNorm = 0.3658, lr_0 = 1.0441e-04
Validation auc = 0.899603
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.589774
Epoch 47
Loss = 8.0757e-03, PNorm = 38.0251, GNorm = 0.0079, lr_0 = 1.0194e-04
Loss = 9.0931e-03, PNorm = 38.0268, GNorm = 0.0144, lr_0 = 1.0000e-04
Validation auc = 0.900009
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.591115
Epoch 48
Loss = 1.5979e-02, PNorm = 38.0293, GNorm = 0.0232, lr_0 = 1.0000e-04
Loss = 5.9790e-03, PNorm = 38.0323, GNorm = 0.0183, lr_0 = 1.0000e-04
Validation auc = 0.899603
Validation accuracy = 0.814978
Validation f1 = 0.869565
Validation binary_cross_entropy = 0.596662
Epoch 49
Loss = 7.6747e-03, PNorm = 38.0332, GNorm = 0.0125, lr_0 = 1.0000e-04
Loss = 9.7458e-03, PNorm = 38.0339, GNorm = 0.4227, lr_0 = 1.0000e-04
Validation auc = 0.899422
Validation accuracy = 0.810573
Validation f1 = 0.866044
Validation binary_cross_entropy = 0.592723
Model 0 best validation auc = 0.914951 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.890257
Model 0 test accuracy = 0.829457
Model 0 test f1 = 0.870588
Model 0 test binary_cross_entropy = 0.495855
Ensemble test auc = 0.890257
Ensemble test accuracy = 0.829457
Ensemble test f1 = 0.870588
Ensemble test binary_cross_entropy = 0.495855
Fold 2
Splitting data with seed 2
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.1556e-01, PNorm = 37.2358, GNorm = 3.0933, lr_0 = 3.4750e-04
Loss = 4.7803e-01, PNorm = 37.2569, GNorm = 2.8830, lr_0 = 5.7250e-04
Loss = 3.0074e-01, PNorm = 37.2600, GNorm = 2.0246, lr_0 = 5.9500e-04
Validation auc = 0.902582
Validation accuracy = 0.854626
Validation f1 = 0.898462
Validation binary_cross_entropy = 0.365497
Epoch 1
Loss = 1.7297e-01, PNorm = 37.2993, GNorm = 0.8301, lr_0 = 8.2000e-04
Loss = 2.1078e-01, PNorm = 37.3433, GNorm = 1.0841, lr_0 = 9.9521e-04
Validation auc = 0.918653
Validation accuracy = 0.863436
Validation f1 = 0.902821
Validation binary_cross_entropy = 0.352219
Epoch 2
Loss = 1.0214e-01, PNorm = 37.3867, GNorm = 0.5088, lr_0 = 9.7163e-04
Loss = 8.5093e-02, PNorm = 37.4263, GNorm = 0.8433, lr_0 = 9.4860e-04
Validation auc = 0.925334
Validation accuracy = 0.841410
Validation f1 = 0.890244
Validation binary_cross_entropy = 0.373875
Epoch 3
Loss = 5.5276e-02, PNorm = 37.4553, GNorm = 0.3590, lr_0 = 9.2390e-04
Loss = 6.4140e-02, PNorm = 37.4849, GNorm = 0.4888, lr_0 = 9.0200e-04
Validation auc = 0.927411
Validation accuracy = 0.859031
Validation f1 = 0.901235
Validation binary_cross_entropy = 0.370055
Epoch 4
Loss = 4.1406e-02, PNorm = 37.5138, GNorm = 0.3083, lr_0 = 8.8063e-04
Loss = 4.7155e-02, PNorm = 37.5314, GNorm = 0.8733, lr_0 = 8.5976e-04
Validation auc = 0.922355
Validation accuracy = 0.837004
Validation f1 = 0.884735
Validation binary_cross_entropy = 0.390177
Epoch 5
Loss = 2.7838e-02, PNorm = 37.5555, GNorm = 0.1770, lr_0 = 8.3737e-04
Loss = 2.8910e-02, PNorm = 37.5769, GNorm = 0.3732, lr_0 = 8.1752e-04
Validation auc = 0.921181
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.411596
Epoch 6
Loss = 1.7393e-02, PNorm = 37.5865, GNorm = 0.1294, lr_0 = 7.9815e-04
Loss = 2.8456e-02, PNorm = 37.6066, GNorm = 0.0924, lr_0 = 7.7923e-04
Validation auc = 0.924070
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.413808
Epoch 7
Loss = 2.1426e-02, PNorm = 37.6179, GNorm = 0.2408, lr_0 = 7.5894e-04
Loss = 3.2312e-02, PNorm = 37.6384, GNorm = 0.1941, lr_0 = 7.4095e-04
Validation auc = 0.920459
Validation accuracy = 0.841410
Validation f1 = 0.889571
Validation binary_cross_entropy = 0.434690
Epoch 8
Loss = 3.0127e-02, PNorm = 37.6541, GNorm = 0.0899, lr_0 = 7.2339e-04
Loss = 2.4108e-02, PNorm = 37.6659, GNorm = 0.0642, lr_0 = 7.0625e-04
Validation auc = 0.922355
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.431976
Epoch 9
Loss = 2.3294e-02, PNorm = 37.6753, GNorm = 0.2530, lr_0 = 6.8951e-04
Loss = 2.6057e-02, PNorm = 37.6906, GNorm = 0.2935, lr_0 = 6.7317e-04
Validation auc = 0.922896
Validation accuracy = 0.845815
Validation f1 = 0.892966
Validation binary_cross_entropy = 0.447535
Epoch 10
Loss = 2.0515e-02, PNorm = 37.7082, GNorm = 0.0804, lr_0 = 6.5564e-04
Loss = 1.8691e-02, PNorm = 37.7162, GNorm = 0.0873, lr_0 = 6.4010e-04
Validation auc = 0.921632
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.440937
Epoch 11
Loss = 1.4034e-02, PNorm = 37.7230, GNorm = 0.0747, lr_0 = 6.2493e-04
Loss = 2.2123e-02, PNorm = 37.7342, GNorm = 0.6983, lr_0 = 6.1012e-04
Validation auc = 0.921271
Validation accuracy = 0.845815
Validation f1 = 0.892308
Validation binary_cross_entropy = 0.457923
Epoch 12
Loss = 9.9792e-03, PNorm = 37.7506, GNorm = 0.0684, lr_0 = 5.9424e-04
Loss = 2.0982e-02, PNorm = 37.7589, GNorm = 0.9325, lr_0 = 5.8015e-04
Validation auc = 0.921000
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.457140
Epoch 13
Loss = 7.4194e-03, PNorm = 37.7670, GNorm = 0.1103, lr_0 = 5.6640e-04
Loss = 1.4393e-02, PNorm = 37.7748, GNorm = 0.0697, lr_0 = 5.5298e-04
Validation auc = 0.921000
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.469250
Epoch 14
Loss = 5.7428e-03, PNorm = 37.7906, GNorm = 0.0590, lr_0 = 5.3858e-04
Loss = 1.9172e-02, PNorm = 37.7988, GNorm = 0.1195, lr_0 = 5.2582e-04
Validation auc = 0.922174
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.462620
Epoch 15
Loss = 2.6382e-02, PNorm = 37.8006, GNorm = 0.5159, lr_0 = 5.1335e-04
Loss = 1.4821e-02, PNorm = 37.8084, GNorm = 0.3468, lr_0 = 5.0119e-04
Validation auc = 0.922445
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.471562
Epoch 16
Loss = 1.1772e-02, PNorm = 37.8180, GNorm = 0.0310, lr_0 = 4.8814e-04
Loss = 1.7445e-02, PNorm = 37.8259, GNorm = 0.8866, lr_0 = 4.7657e-04
Validation auc = 0.920278
Validation accuracy = 0.850220
Validation f1 = 0.894410
Validation binary_cross_entropy = 0.476952
Epoch 17
Loss = 3.4292e-03, PNorm = 37.8327, GNorm = 0.0508, lr_0 = 4.6527e-04
Loss = 1.0900e-02, PNorm = 37.8405, GNorm = 0.0611, lr_0 = 4.5425e-04
Loss = 2.1876e-02, PNorm = 37.8478, GNorm = 0.0414, lr_0 = 4.4348e-04
Validation auc = 0.922264
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.480477
Epoch 18
Loss = 1.7293e-02, PNorm = 37.8537, GNorm = 0.4519, lr_0 = 4.3297e-04
Loss = 1.2025e-02, PNorm = 37.8618, GNorm = 0.0212, lr_0 = 4.2271e-04
Loss = 1.8618e-02, PNorm = 37.8627, GNorm = 0.3434, lr_0 = 4.2170e-04
Validation auc = 0.921813
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.482661
Epoch 19
Loss = 1.8061e-02, PNorm = 37.8716, GNorm = 0.4314, lr_0 = 4.1170e-04
Loss = 1.0148e-02, PNorm = 37.8769, GNorm = 0.4027, lr_0 = 4.0195e-04
Validation auc = 0.920549
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.490095
Epoch 20
Loss = 1.3488e-02, PNorm = 37.8823, GNorm = 0.0345, lr_0 = 3.9242e-04
Loss = 1.1885e-02, PNorm = 37.8906, GNorm = 0.0606, lr_0 = 3.8312e-04
Validation auc = 0.921542
Validation accuracy = 0.850220
Validation f1 = 0.895062
Validation binary_cross_entropy = 0.493859
Epoch 21
Loss = 9.0065e-03, PNorm = 37.8956, GNorm = 0.0873, lr_0 = 3.7314e-04
Loss = 1.6539e-02, PNorm = 37.9002, GNorm = 0.1392, lr_0 = 3.6430e-04
Validation auc = 0.921271
Validation accuracy = 0.850220
Validation f1 = 0.894410
Validation binary_cross_entropy = 0.491732
Epoch 22
Loss = 1.3668e-02, PNorm = 37.9065, GNorm = 0.0248, lr_0 = 3.5567e-04
Loss = 7.1427e-03, PNorm = 37.9137, GNorm = 0.0413, lr_0 = 3.4724e-04
Validation auc = 0.921181
Validation accuracy = 0.850220
Validation f1 = 0.894410
Validation binary_cross_entropy = 0.503420
Epoch 23
Loss = 9.3565e-03, PNorm = 37.9170, GNorm = 0.3160, lr_0 = 3.3819e-04
Loss = 1.2102e-02, PNorm = 37.9242, GNorm = 0.0579, lr_0 = 3.3018e-04
Validation auc = 0.921181
Validation accuracy = 0.854626
Validation f1 = 0.897196
Validation binary_cross_entropy = 0.499893
Epoch 24
Loss = 1.5901e-02, PNorm = 37.9275, GNorm = 0.3707, lr_0 = 3.2235e-04
Loss = 9.7153e-03, PNorm = 37.9310, GNorm = 0.1019, lr_0 = 3.1471e-04
Validation auc = 0.920910
Validation accuracy = 0.845815
Validation f1 = 0.892308
Validation binary_cross_entropy = 0.505314
Epoch 25
Loss = 1.2237e-02, PNorm = 37.9403, GNorm = 0.0246, lr_0 = 3.0726e-04
Loss = 1.3713e-02, PNorm = 37.9466, GNorm = 0.4342, lr_0 = 2.9997e-04
Validation auc = 0.921542
Validation accuracy = 0.854626
Validation f1 = 0.897196
Validation binary_cross_entropy = 0.504924
Epoch 26
Loss = 9.5231e-03, PNorm = 37.9494, GNorm = 0.0361, lr_0 = 2.9216e-04
Loss = 1.4082e-02, PNorm = 37.9534, GNorm = 0.0277, lr_0 = 2.8524e-04
Validation auc = 0.920820
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.502936
Epoch 27
Loss = 9.3251e-03, PNorm = 37.9588, GNorm = 0.0445, lr_0 = 2.7848e-04
Loss = 8.8406e-03, PNorm = 37.9653, GNorm = 0.2876, lr_0 = 2.7188e-04
Validation auc = 0.920730
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.516135
Epoch 28
Loss = 1.3285e-02, PNorm = 37.9723, GNorm = 0.0453, lr_0 = 2.6480e-04
Loss = 1.6279e-02, PNorm = 37.9765, GNorm = 0.1254, lr_0 = 2.5852e-04
Validation auc = 0.921000
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.511792
Epoch 29
Loss = 8.8264e-03, PNorm = 37.9772, GNorm = 0.0151, lr_0 = 2.5240e-04
Loss = 1.0733e-02, PNorm = 37.9816, GNorm = 0.2078, lr_0 = 2.4641e-04
Validation auc = 0.920459
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.509313
Epoch 30
Loss = 4.0884e-03, PNorm = 37.9865, GNorm = 0.0247, lr_0 = 2.4000e-04
Loss = 1.2044e-02, PNorm = 37.9911, GNorm = 0.7315, lr_0 = 2.3431e-04
Validation auc = 0.918202
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.523893
Epoch 31
Loss = 7.2260e-03, PNorm = 37.9963, GNorm = 0.2653, lr_0 = 2.2876e-04
Loss = 1.0296e-02, PNorm = 38.0025, GNorm = 0.2876, lr_0 = 2.2334e-04
Validation auc = 0.920368
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.524897
Epoch 32
Loss = 6.6520e-03, PNorm = 38.0062, GNorm = 0.0354, lr_0 = 2.1752e-04
Loss = 1.3115e-02, PNorm = 38.0100, GNorm = 0.0142, lr_0 = 2.1237e-04
Validation auc = 0.919375
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.523278
Epoch 33
Loss = 1.1860e-02, PNorm = 38.0133, GNorm = 0.3997, lr_0 = 2.0733e-04
Loss = 9.8343e-03, PNorm = 38.0169, GNorm = 0.0501, lr_0 = 2.0242e-04
Validation auc = 0.918382
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.528197
Epoch 34
Loss = 1.8115e-02, PNorm = 38.0215, GNorm = 0.3365, lr_0 = 1.9762e-04
Loss = 1.0707e-02, PNorm = 38.0253, GNorm = 0.0295, lr_0 = 1.9294e-04
Validation auc = 0.920007
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.529472
Epoch 35
Loss = 2.3544e-03, PNorm = 38.0308, GNorm = 0.0316, lr_0 = 1.8791e-04
Loss = 9.7254e-03, PNorm = 38.0362, GNorm = 0.0268, lr_0 = 1.8346e-04
Loss = 1.1836e-02, PNorm = 38.0397, GNorm = 0.0071, lr_0 = 1.7911e-04
Validation auc = 0.918924
Validation accuracy = 0.845815
Validation f1 = 0.892308
Validation binary_cross_entropy = 0.538608
Epoch 36
Loss = 5.2946e-03, PNorm = 38.0426, GNorm = 0.0182, lr_0 = 1.7487e-04
Loss = 1.3247e-02, PNorm = 38.0463, GNorm = 0.0173, lr_0 = 1.7072e-04
Loss = 3.8081e-02, PNorm = 38.0465, GNorm = 0.6185, lr_0 = 1.7031e-04
Validation auc = 0.918653
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.533943
Epoch 37
Loss = 1.1424e-02, PNorm = 38.0501, GNorm = 0.6190, lr_0 = 1.6628e-04
Loss = 7.5276e-03, PNorm = 38.0547, GNorm = 0.0173, lr_0 = 1.6234e-04
Validation auc = 0.919556
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.530160
Epoch 38
Loss = 8.4753e-03, PNorm = 38.0591, GNorm = 0.0216, lr_0 = 1.5849e-04
Loss = 7.9004e-03, PNorm = 38.0637, GNorm = 0.0176, lr_0 = 1.5473e-04
Validation auc = 0.919285
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.535756
Epoch 39
Loss = 6.3738e-03, PNorm = 38.0694, GNorm = 0.4417, lr_0 = 1.5070e-04
Loss = 1.4032e-02, PNorm = 38.0731, GNorm = 0.0483, lr_0 = 1.4713e-04
Validation auc = 0.919014
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.538024
Epoch 40
Loss = 1.2603e-02, PNorm = 38.0787, GNorm = 0.0334, lr_0 = 1.4365e-04
Loss = 6.3165e-03, PNorm = 38.0828, GNorm = 0.0188, lr_0 = 1.4024e-04
Validation auc = 0.918653
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.538229
Epoch 41
Loss = 7.1577e-03, PNorm = 38.0865, GNorm = 0.0230, lr_0 = 1.3659e-04
Loss = 1.1317e-02, PNorm = 38.0904, GNorm = 0.6241, lr_0 = 1.3335e-04
Validation auc = 0.919014
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.541186
Epoch 42
Loss = 9.1011e-03, PNorm = 38.0949, GNorm = 0.4181, lr_0 = 1.3019e-04
Loss = 1.1073e-02, PNorm = 38.1006, GNorm = 0.2900, lr_0 = 1.2711e-04
Validation auc = 0.918563
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.541411
Epoch 43
Loss = 9.4590e-03, PNorm = 38.1059, GNorm = 0.3373, lr_0 = 1.2409e-04
Loss = 5.9723e-03, PNorm = 38.1115, GNorm = 0.0214, lr_0 = 1.2115e-04
Validation auc = 0.918202
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.551866
Epoch 44
Loss = 7.2895e-03, PNorm = 38.1159, GNorm = 0.0154, lr_0 = 1.1800e-04
Loss = 9.0877e-03, PNorm = 38.1202, GNorm = 0.0125, lr_0 = 1.1520e-04
Validation auc = 0.918021
Validation accuracy = 0.841410
Validation f1 = 0.888199
Validation binary_cross_entropy = 0.545672
Epoch 45
Loss = 1.4108e-02, PNorm = 38.1234, GNorm = 0.3675, lr_0 = 1.1247e-04
Loss = 4.5830e-03, PNorm = 38.1268, GNorm = 0.0221, lr_0 = 1.0981e-04
Validation auc = 0.917299
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.549225
Epoch 46
Loss = 6.1872e-03, PNorm = 38.1311, GNorm = 0.0089, lr_0 = 1.0695e-04
Loss = 4.8456e-03, PNorm = 38.1350, GNorm = 0.2301, lr_0 = 1.0441e-04
Validation auc = 0.918021
Validation accuracy = 0.841410
Validation f1 = 0.890244
Validation binary_cross_entropy = 0.567409
Epoch 47
Loss = 5.7306e-03, PNorm = 38.1387, GNorm = 0.0074, lr_0 = 1.0194e-04
Loss = 6.2243e-03, PNorm = 38.1419, GNorm = 0.2021, lr_0 = 1.0000e-04
Validation auc = 0.917118
Validation accuracy = 0.845815
Validation f1 = 0.891641
Validation binary_cross_entropy = 0.549508
Epoch 48
Loss = 8.2144e-03, PNorm = 38.1478, GNorm = 0.0084, lr_0 = 1.0000e-04
Loss = 4.6515e-03, PNorm = 38.1517, GNorm = 0.0135, lr_0 = 1.0000e-04
Validation auc = 0.916983
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.557579
Epoch 49
Loss = 5.5256e-03, PNorm = 38.1569, GNorm = 0.0221, lr_0 = 1.0000e-04
Loss = 5.6514e-03, PNorm = 38.1621, GNorm = 0.2492, lr_0 = 1.0000e-04
Validation auc = 0.915764
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.562000
Model 0 best validation auc = 0.927411 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.919173
Model 0 test accuracy = 0.844961
Model 0 test f1 = 0.889503
Model 0 test binary_cross_entropy = 0.383963
Ensemble test auc = 0.919173
Ensemble test accuracy = 0.844961
Ensemble test f1 = 0.889503
Ensemble test binary_cross_entropy = 0.383963
Fold 3
Splitting data with seed 3
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.1202e-01, PNorm = 37.2370, GNorm = 3.0971, lr_0 = 3.4750e-04
Loss = 4.6378e-01, PNorm = 37.2631, GNorm = 3.4092, lr_0 = 5.7250e-04
Loss = 5.3742e-01, PNorm = 37.2654, GNorm = 3.1698, lr_0 = 5.9500e-04
Validation auc = 0.901589
Validation accuracy = 0.859031
Validation f1 = 0.901235
Validation binary_cross_entropy = 0.361661
Epoch 1
Loss = 1.8260e-01, PNorm = 37.3055, GNorm = 0.9495, lr_0 = 8.2000e-04
Loss = 1.7920e-01, PNorm = 37.3529, GNorm = 1.1046, lr_0 = 9.9521e-04
Validation auc = 0.907909
Validation accuracy = 0.828194
Validation f1 = 0.881459
Validation binary_cross_entropy = 0.392822
Epoch 2
Loss = 8.3371e-02, PNorm = 37.3961, GNorm = 0.6992, lr_0 = 9.7163e-04
Loss = 9.7605e-02, PNorm = 37.4309, GNorm = 0.7587, lr_0 = 9.4860e-04
Validation auc = 0.916396
Validation accuracy = 0.850220
Validation f1 = 0.893082
Validation binary_cross_entropy = 0.385628
Epoch 3
Loss = 5.4031e-02, PNorm = 37.4606, GNorm = 0.4317, lr_0 = 9.2390e-04
Loss = 6.7944e-02, PNorm = 37.4911, GNorm = 0.6354, lr_0 = 9.0200e-04
Validation auc = 0.927320
Validation accuracy = 0.837004
Validation f1 = 0.886850
Validation binary_cross_entropy = 0.385483
Epoch 4
Loss = 5.8690e-02, PNorm = 37.5083, GNorm = 0.8992, lr_0 = 8.8063e-04
Loss = 3.9667e-02, PNorm = 37.5400, GNorm = 0.6328, lr_0 = 8.5976e-04
Validation auc = 0.924341
Validation accuracy = 0.841410
Validation f1 = 0.888889
Validation binary_cross_entropy = 0.404593
Epoch 5
Loss = 3.4994e-02, PNorm = 37.5577, GNorm = 0.2822, lr_0 = 8.3737e-04
Loss = 3.3848e-02, PNorm = 37.5768, GNorm = 0.2507, lr_0 = 8.1752e-04
Validation auc = 0.923348
Validation accuracy = 0.828194
Validation f1 = 0.881459
Validation binary_cross_entropy = 0.420598
Epoch 6
Loss = 3.0377e-02, PNorm = 37.5930, GNorm = 0.1443, lr_0 = 7.9815e-04
Loss = 2.7891e-02, PNorm = 37.6080, GNorm = 0.1531, lr_0 = 7.7923e-04
Validation auc = 0.924612
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.414143
Epoch 7
Loss = 1.3416e-02, PNorm = 37.6266, GNorm = 0.0922, lr_0 = 7.5894e-04
Loss = 2.8382e-02, PNorm = 37.6381, GNorm = 0.5646, lr_0 = 7.4095e-04
Validation auc = 0.923528
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.427052
Epoch 8
Loss = 1.1753e-02, PNorm = 37.6578, GNorm = 0.0974, lr_0 = 7.2339e-04
Loss = 2.7252e-02, PNorm = 37.6635, GNorm = 0.0440, lr_0 = 7.0625e-04
Validation auc = 0.922625
Validation accuracy = 0.832599
Validation f1 = 0.881988
Validation binary_cross_entropy = 0.433836
Epoch 9
Loss = 1.5157e-02, PNorm = 37.6743, GNorm = 0.1208, lr_0 = 6.8951e-04
Loss = 1.9751e-02, PNorm = 37.6885, GNorm = 0.4108, lr_0 = 6.7317e-04
Validation auc = 0.923348
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.452477
Epoch 10
Loss = 1.6652e-02, PNorm = 37.7026, GNorm = 0.0635, lr_0 = 6.5564e-04
Loss = 1.4964e-02, PNorm = 37.7138, GNorm = 0.1566, lr_0 = 6.4010e-04
Validation auc = 0.921362
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.452798
Epoch 11
Loss = 1.0404e-02, PNorm = 37.7197, GNorm = 0.1640, lr_0 = 6.2493e-04
Loss = 1.7910e-02, PNorm = 37.7279, GNorm = 0.5137, lr_0 = 6.1012e-04
Validation auc = 0.921993
Validation accuracy = 0.837004
Validation f1 = 0.886850
Validation binary_cross_entropy = 0.467451
Epoch 12
Loss = 7.8440e-03, PNorm = 37.7400, GNorm = 0.0610, lr_0 = 5.9424e-04
Loss = 1.4796e-02, PNorm = 37.7487, GNorm = 0.4166, lr_0 = 5.8015e-04
Validation auc = 0.921000
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.463856
Epoch 13
Loss = 4.6156e-03, PNorm = 37.7564, GNorm = 0.0547, lr_0 = 5.6640e-04
Loss = 1.8664e-02, PNorm = 37.7635, GNorm = 0.4438, lr_0 = 5.5298e-04
Validation auc = 0.922987
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.469330
Epoch 14
Loss = 2.8689e-02, PNorm = 37.7687, GNorm = 0.3808, lr_0 = 5.3858e-04
Loss = 1.2152e-02, PNorm = 37.7770, GNorm = 0.0501, lr_0 = 5.2582e-04
Validation auc = 0.920820
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.473827
Epoch 15
Loss = 1.8174e-02, PNorm = 37.7877, GNorm = 0.0435, lr_0 = 5.1335e-04
Loss = 2.3048e-02, PNorm = 37.7970, GNorm = 0.0379, lr_0 = 5.0119e-04
Validation auc = 0.920098
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.479774
Epoch 16
Loss = 1.3420e-02, PNorm = 37.8054, GNorm = 0.5243, lr_0 = 4.8814e-04
Loss = 1.5662e-02, PNorm = 37.8141, GNorm = 0.0355, lr_0 = 4.7657e-04
Validation auc = 0.921362
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.482021
Epoch 17
Loss = 1.4038e-02, PNorm = 37.8194, GNorm = 0.2318, lr_0 = 4.6527e-04
Loss = 1.6622e-02, PNorm = 37.8231, GNorm = 0.0990, lr_0 = 4.5425e-04
Loss = 1.6976e-02, PNorm = 37.8331, GNorm = 0.0713, lr_0 = 4.4348e-04
Validation auc = 0.922355
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.490480
Epoch 18
Loss = 1.4124e-02, PNorm = 37.8396, GNorm = 0.0389, lr_0 = 4.3297e-04
Loss = 1.2572e-02, PNorm = 37.8460, GNorm = 0.0256, lr_0 = 4.2271e-04
Loss = 1.1422e-02, PNorm = 37.8468, GNorm = 0.2868, lr_0 = 4.2170e-04
Validation auc = 0.922174
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.491756
Epoch 19
Loss = 1.2303e-02, PNorm = 37.8528, GNorm = 0.1186, lr_0 = 4.1170e-04
Loss = 1.1580e-02, PNorm = 37.8613, GNorm = 0.0475, lr_0 = 4.0195e-04
Validation auc = 0.921632
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.497376
Epoch 20
Loss = 1.2273e-02, PNorm = 37.8669, GNorm = 0.0481, lr_0 = 3.9242e-04
Loss = 2.0199e-02, PNorm = 37.8743, GNorm = 0.0414, lr_0 = 3.8312e-04
Validation auc = 0.920910
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.500490
Epoch 21
Loss = 8.9343e-03, PNorm = 37.8818, GNorm = 0.0491, lr_0 = 3.7314e-04
Loss = 1.1665e-02, PNorm = 37.8890, GNorm = 0.0263, lr_0 = 3.6430e-04
Validation auc = 0.919556
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.507275
Epoch 22
Loss = 7.9908e-03, PNorm = 37.8927, GNorm = 0.0554, lr_0 = 3.5567e-04
Loss = 1.0681e-02, PNorm = 37.8975, GNorm = 0.3861, lr_0 = 3.4724e-04
Validation auc = 0.920910
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.499738
Epoch 23
Loss = 2.8375e-03, PNorm = 37.9030, GNorm = 0.0404, lr_0 = 3.3819e-04
Loss = 1.3007e-02, PNorm = 37.9116, GNorm = 0.0308, lr_0 = 3.3018e-04
Validation auc = 0.920730
Validation accuracy = 0.841410
Validation f1 = 0.889571
Validation binary_cross_entropy = 0.509113
Epoch 24
Loss = 6.6465e-03, PNorm = 37.9191, GNorm = 0.0091, lr_0 = 3.2235e-04
Loss = 1.5684e-02, PNorm = 37.9239, GNorm = 0.3855, lr_0 = 3.1471e-04
Validation auc = 0.921091
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.504958
Epoch 25
Loss = 1.5601e-02, PNorm = 37.9295, GNorm = 0.6625, lr_0 = 3.0726e-04
Loss = 9.3250e-03, PNorm = 37.9367, GNorm = 0.0208, lr_0 = 2.9997e-04
Validation auc = 0.921000
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.515719
Epoch 26
Loss = 8.3786e-03, PNorm = 37.9445, GNorm = 0.2543, lr_0 = 2.9216e-04
Loss = 1.1947e-02, PNorm = 37.9524, GNorm = 0.6596, lr_0 = 2.8524e-04
Validation auc = 0.920459
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.528067
Epoch 27
Loss = 1.8825e-02, PNorm = 37.9574, GNorm = 0.5629, lr_0 = 2.7848e-04
Loss = 8.1583e-03, PNorm = 37.9635, GNorm = 0.0398, lr_0 = 2.7188e-04
Validation auc = 0.920910
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.518526
Epoch 28
Loss = 6.2088e-03, PNorm = 37.9712, GNorm = 0.0764, lr_0 = 2.6480e-04
Loss = 1.1910e-02, PNorm = 37.9762, GNorm = 0.3848, lr_0 = 2.5852e-04
Validation auc = 0.919646
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.511982
Epoch 29
Loss = 2.4323e-02, PNorm = 37.9838, GNorm = 0.2605, lr_0 = 2.5240e-04
Loss = 6.8216e-03, PNorm = 37.9920, GNorm = 0.0270, lr_0 = 2.4641e-04
Validation auc = 0.919646
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.529474
Epoch 30
Loss = 9.3079e-03, PNorm = 37.9996, GNorm = 0.0307, lr_0 = 2.4000e-04
Loss = 1.0802e-02, PNorm = 38.0060, GNorm = 0.0285, lr_0 = 2.3431e-04
Validation auc = 0.918021
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.527273
Epoch 31
Loss = 1.7209e-03, PNorm = 38.0132, GNorm = 0.0111, lr_0 = 2.2876e-04
Loss = 1.6506e-02, PNorm = 38.0199, GNorm = 0.6568, lr_0 = 2.2334e-04
Validation auc = 0.918382
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.534783
Epoch 32
Loss = 4.5039e-03, PNorm = 38.0285, GNorm = 0.0112, lr_0 = 2.1752e-04
Loss = 9.4075e-03, PNorm = 38.0369, GNorm = 0.0102, lr_0 = 2.1237e-04
Validation auc = 0.918472
Validation accuracy = 0.832599
Validation f1 = 0.883436
Validation binary_cross_entropy = 0.542798
Epoch 33
Loss = 2.3167e-03, PNorm = 38.0461, GNorm = 0.0502, lr_0 = 2.0733e-04
Loss = 1.0817e-02, PNorm = 38.0552, GNorm = 0.0314, lr_0 = 2.0242e-04
Validation auc = 0.918202
Validation accuracy = 0.837004
Validation f1 = 0.886154
Validation binary_cross_entropy = 0.542501
Epoch 34
Loss = 2.5000e-03, PNorm = 38.0629, GNorm = 0.0284, lr_0 = 1.9762e-04
Loss = 6.0594e-03, PNorm = 38.0683, GNorm = 0.5148, lr_0 = 1.9294e-04
Validation auc = 0.917570
Validation accuracy = 0.837004
Validation f1 = 0.886850
Validation binary_cross_entropy = 0.556857
Epoch 35
Loss = 4.8402e-04, PNorm = 38.0787, GNorm = 0.0077, lr_0 = 1.8791e-04
Loss = 5.9753e-03, PNorm = 38.0874, GNorm = 0.0236, lr_0 = 1.8346e-04
Loss = 1.1833e-02, PNorm = 38.0957, GNorm = 0.0279, lr_0 = 1.7911e-04
Validation auc = 0.917344
Validation accuracy = 0.832599
Validation f1 = 0.884146
Validation binary_cross_entropy = 0.585191
Epoch 36
Loss = 9.2441e-03, PNorm = 38.1016, GNorm = 0.0231, lr_0 = 1.7487e-04
Loss = 1.1240e-02, PNorm = 38.1082, GNorm = 0.0505, lr_0 = 1.7072e-04
Loss = 2.2455e-03, PNorm = 38.1089, GNorm = 0.0415, lr_0 = 1.7031e-04
Validation auc = 0.917570
Validation accuracy = 0.837004
Validation f1 = 0.885449
Validation binary_cross_entropy = 0.533603
Epoch 37
Loss = 1.1479e-02, PNorm = 38.1176, GNorm = 0.1950, lr_0 = 1.6628e-04
Loss = 4.9998e-03, PNorm = 38.1268, GNorm = 0.3115, lr_0 = 1.6234e-04
Validation auc = 0.915583
Validation accuracy = 0.828194
Validation f1 = 0.880734
Validation binary_cross_entropy = 0.565358
Epoch 38
Loss = 8.0387e-03, PNorm = 38.1338, GNorm = 0.4242, lr_0 = 1.5849e-04
Loss = 8.8380e-03, PNorm = 38.1426, GNorm = 0.3838, lr_0 = 1.5473e-04
Validation auc = 0.914410
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.561591
Epoch 39
Loss = 4.9911e-03, PNorm = 38.1506, GNorm = 0.0328, lr_0 = 1.5070e-04
Loss = 5.8716e-03, PNorm = 38.1583, GNorm = 0.0401, lr_0 = 1.4713e-04
Validation auc = 0.914771
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.565389
Epoch 40
Loss = 5.8138e-03, PNorm = 38.1650, GNorm = 0.2080, lr_0 = 1.4365e-04
Loss = 1.0047e-02, PNorm = 38.1742, GNorm = 0.2070, lr_0 = 1.4024e-04
Validation auc = 0.913507
Validation accuracy = 0.832599
Validation f1 = 0.882716
Validation binary_cross_entropy = 0.569455
Epoch 41
Loss = 6.4637e-03, PNorm = 38.1799, GNorm = 0.0275, lr_0 = 1.3659e-04
Loss = 4.8119e-03, PNorm = 38.1847, GNorm = 0.1521, lr_0 = 1.3335e-04
Validation auc = 0.913326
Validation accuracy = 0.823789
Validation f1 = 0.877301
Validation binary_cross_entropy = 0.585238
Epoch 42
Loss = 3.1321e-03, PNorm = 38.1906, GNorm = 0.0167, lr_0 = 1.3019e-04
Loss = 7.7554e-03, PNorm = 38.1975, GNorm = 0.3193, lr_0 = 1.2711e-04
Validation auc = 0.911430
Validation accuracy = 0.819383
Validation f1 = 0.872274
Validation binary_cross_entropy = 0.583660
Epoch 43
Loss = 3.4418e-03, PNorm = 38.2030, GNorm = 0.0127, lr_0 = 1.2409e-04
Loss = 7.1267e-03, PNorm = 38.2059, GNorm = 0.0354, lr_0 = 1.2115e-04
Validation auc = 0.912784
Validation accuracy = 0.828194
Validation f1 = 0.880734
Validation binary_cross_entropy = 0.604085
Epoch 44
Loss = 2.9461e-03, PNorm = 38.2103, GNorm = 0.0965, lr_0 = 1.1800e-04
Loss = 6.8686e-03, PNorm = 38.2152, GNorm = 0.4313, lr_0 = 1.1520e-04
Validation auc = 0.911656
Validation accuracy = 0.810573
Validation f1 = 0.866873
Validation binary_cross_entropy = 0.594419
Epoch 45
Loss = 2.8856e-03, PNorm = 38.2196, GNorm = 0.0185, lr_0 = 1.1247e-04
Loss = 3.6104e-03, PNorm = 38.2228, GNorm = 0.0285, lr_0 = 1.0981e-04
Validation auc = 0.911520
Validation accuracy = 0.810573
Validation f1 = 0.866873
Validation binary_cross_entropy = 0.604471
Epoch 46
Loss = 3.9688e-03, PNorm = 38.2275, GNorm = 0.0801, lr_0 = 1.0695e-04
Loss = 3.0430e-03, PNorm = 38.2300, GNorm = 0.1066, lr_0 = 1.0441e-04
Validation auc = 0.911069
Validation accuracy = 0.810573
Validation f1 = 0.866873
Validation binary_cross_entropy = 0.601511
Epoch 47
Loss = 2.3787e-03, PNorm = 38.2331, GNorm = 0.0217, lr_0 = 1.0194e-04
Loss = 4.5877e-03, PNorm = 38.2369, GNorm = 0.0565, lr_0 = 1.0000e-04
Validation auc = 0.910888
Validation accuracy = 0.814978
Validation f1 = 0.870370
Validation binary_cross_entropy = 0.615419
Epoch 48
Loss = 6.0303e-03, PNorm = 38.2398, GNorm = 0.0722, lr_0 = 1.0000e-04
Loss = 4.2921e-03, PNorm = 38.2417, GNorm = 0.0388, lr_0 = 1.0000e-04
Validation auc = 0.910708
Validation accuracy = 0.806167
Validation f1 = 0.863354
Validation binary_cross_entropy = 0.600069
Epoch 49
Loss = 2.1319e-03, PNorm = 38.2437, GNorm = 0.0201, lr_0 = 1.0000e-04
Loss = 3.8985e-03, PNorm = 38.2452, GNorm = 0.3948, lr_0 = 1.0000e-04
Validation auc = 0.910708
Validation accuracy = 0.810573
Validation f1 = 0.866873
Validation binary_cross_entropy = 0.603560
Model 0 best validation auc = 0.927320 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.905244
Model 0 test accuracy = 0.841085
Model 0 test f1 = 0.881844
Model 0 test binary_cross_entropy = 0.437109
Ensemble test auc = 0.905244
Ensemble test accuracy = 0.841085
Ensemble test f1 = 0.881844
Ensemble test binary_cross_entropy = 0.437109
Fold 4
Splitting data with seed 4
Class sizes
active 0: 33.44%, 1: 66.56%
Total size = 1,286 | train size = 1,028 | val size = 227 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.0143e-01, PNorm = 37.2351, GNorm = 3.1983, lr_0 = 3.4750e-04
Loss = 4.4588e-01, PNorm = 37.2562, GNorm = 2.7462, lr_0 = 5.7250e-04
Loss = 4.7454e-01, PNorm = 37.2599, GNorm = 3.5592, lr_0 = 5.9500e-04
Validation auc = 0.909715
Validation accuracy = 0.850220
Validation f1 = 0.891026
Validation binary_cross_entropy = 0.359087
Epoch 1
Loss = 1.7961e-01, PNorm = 37.3079, GNorm = 1.1891, lr_0 = 8.2000e-04
Loss = 1.8472e-01, PNorm = 37.3471, GNorm = 1.5188, lr_0 = 9.9521e-04
Validation auc = 0.916306
Validation accuracy = 0.854626
Validation f1 = 0.896552
Validation binary_cross_entropy = 0.354717
Epoch 2
Loss = 7.0808e-02, PNorm = 37.3969, GNorm = 0.3517, lr_0 = 9.7163e-04
Loss = 9.2405e-02, PNorm = 37.4356, GNorm = 0.5978, lr_0 = 9.4860e-04
Validation auc = 0.920910
Validation accuracy = 0.850220
Validation f1 = 0.893750
Validation binary_cross_entropy = 0.369359
Epoch 3
Loss = 5.2298e-02, PNorm = 37.4671, GNorm = 0.2091, lr_0 = 9.2390e-04
Loss = 5.7119e-02, PNorm = 37.4914, GNorm = 0.4053, lr_0 = 9.0200e-04
Validation auc = 0.926056
Validation accuracy = 0.850220
Validation f1 = 0.893750
Validation binary_cross_entropy = 0.362811
Epoch 4
Loss = 3.5210e-02, PNorm = 37.5072, GNorm = 0.3224, lr_0 = 8.8063e-04
Loss = 4.2782e-02, PNorm = 37.5338, GNorm = 0.2471, lr_0 = 8.5976e-04
Validation auc = 0.923438
Validation accuracy = 0.845815
Validation f1 = 0.890966
Validation binary_cross_entropy = 0.394299
Epoch 5
Loss = 4.1928e-02, PNorm = 37.5572, GNorm = 0.5225, lr_0 = 8.3737e-04
Loss = 2.7080e-02, PNorm = 37.5680, GNorm = 0.3197, lr_0 = 8.1752e-04
Validation auc = 0.924431
Validation accuracy = 0.859031
Validation f1 = 0.898734
Validation binary_cross_entropy = 0.384054
Epoch 6
Loss = 3.0143e-02, PNorm = 37.5860, GNorm = 0.4074, lr_0 = 7.9815e-04
Loss = 3.3703e-02, PNorm = 37.6050, GNorm = 0.2714, lr_0 = 7.7923e-04
Validation auc = 0.924702
Validation accuracy = 0.872247
Validation f1 = 0.909091
Validation binary_cross_entropy = 0.402745
Epoch 7
Loss = 1.1388e-02, PNorm = 37.6254, GNorm = 0.0732, lr_0 = 7.5894e-04
Loss = 3.0973e-02, PNorm = 37.6360, GNorm = 0.8800, lr_0 = 7.4095e-04
Validation auc = 0.923709
Validation accuracy = 0.850220
Validation f1 = 0.891026
Validation binary_cross_entropy = 0.418086
Epoch 8
Loss = 1.4313e-02, PNorm = 37.6411, GNorm = 0.3184, lr_0 = 7.2339e-04
Loss = 2.3454e-02, PNorm = 37.6540, GNorm = 0.3919, lr_0 = 7.0625e-04
Validation auc = 0.922896
Validation accuracy = 0.854626
Validation f1 = 0.896552
Validation binary_cross_entropy = 0.427327
Epoch 9
Loss = 2.0749e-02, PNorm = 37.6722, GNorm = 0.2222, lr_0 = 6.8951e-04
Loss = 1.5238e-02, PNorm = 37.6772, GNorm = 0.0515, lr_0 = 6.7317e-04
Validation auc = 0.921542
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.429867
Epoch 10
Loss = 1.3655e-02, PNorm = 37.6874, GNorm = 0.1094, lr_0 = 6.5564e-04
Loss = 1.8185e-02, PNorm = 37.7010, GNorm = 0.0867, lr_0 = 6.4010e-04
Validation auc = 0.923619
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.437822
Epoch 11
Loss = 1.4101e-02, PNorm = 37.7151, GNorm = 0.1729, lr_0 = 6.2493e-04
Loss = 1.9685e-02, PNorm = 37.7185, GNorm = 0.0755, lr_0 = 6.1012e-04
Validation auc = 0.920730
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.449486
Epoch 12
Loss = 1.8467e-02, PNorm = 37.7330, GNorm = 0.6590, lr_0 = 5.9424e-04
Loss = 1.1611e-02, PNorm = 37.7412, GNorm = 0.0491, lr_0 = 5.8015e-04
Validation auc = 0.919556
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.456536
Epoch 13
Loss = 1.0168e-02, PNorm = 37.7407, GNorm = 0.3453, lr_0 = 5.6640e-04
Loss = 1.9134e-02, PNorm = 37.7480, GNorm = 0.7660, lr_0 = 5.5298e-04
Validation auc = 0.922264
Validation accuracy = 0.863436
Validation f1 = 0.902821
Validation binary_cross_entropy = 0.451876
Epoch 14
Loss = 1.1110e-02, PNorm = 37.7622, GNorm = 0.1395, lr_0 = 5.3858e-04
Loss = 1.1676e-02, PNorm = 37.7736, GNorm = 0.2909, lr_0 = 5.2582e-04
Validation auc = 0.921091
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.463775
Epoch 15
Loss = 1.4167e-02, PNorm = 37.7739, GNorm = 0.0498, lr_0 = 5.1335e-04
Loss = 1.3005e-02, PNorm = 37.7782, GNorm = 0.5091, lr_0 = 5.0119e-04
Validation auc = 0.918021
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.473258
Epoch 16
Loss = 1.1777e-02, PNorm = 37.7870, GNorm = 0.0913, lr_0 = 4.8814e-04
Loss = 1.3374e-02, PNorm = 37.7952, GNorm = 0.6823, lr_0 = 4.7657e-04
Validation auc = 0.920368
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.473751
Epoch 17
Loss = 3.9310e-03, PNorm = 37.8011, GNorm = 0.0539, lr_0 = 4.6527e-04
Loss = 1.4301e-02, PNorm = 37.8095, GNorm = 0.5698, lr_0 = 4.5425e-04
Loss = 1.4320e-02, PNorm = 37.8106, GNorm = 0.0617, lr_0 = 4.4348e-04
Validation auc = 0.921993
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.470806
Epoch 18
Loss = 1.5209e-02, PNorm = 37.8133, GNorm = 0.6070, lr_0 = 4.3297e-04
Loss = 1.0091e-02, PNorm = 37.8218, GNorm = 0.0424, lr_0 = 4.2271e-04
Loss = 7.1185e-02, PNorm = 37.8226, GNorm = 1.2194, lr_0 = 4.2170e-04
Validation auc = 0.920098
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.477992
Epoch 19
Loss = 1.1471e-02, PNorm = 37.8303, GNorm = 0.0231, lr_0 = 4.1170e-04
Loss = 1.7062e-02, PNorm = 37.8352, GNorm = 0.0204, lr_0 = 4.0195e-04
Validation auc = 0.921271
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.477658
Epoch 20
Loss = 8.0437e-03, PNorm = 37.8380, GNorm = 0.0584, lr_0 = 3.9242e-04
Loss = 1.8648e-02, PNorm = 37.8459, GNorm = 0.1105, lr_0 = 3.8312e-04
Validation auc = 0.919104
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.486690
Epoch 21
Loss = 1.1754e-02, PNorm = 37.8508, GNorm = 0.0208, lr_0 = 3.7314e-04
Loss = 1.1873e-02, PNorm = 37.8571, GNorm = 0.0244, lr_0 = 3.6430e-04
Validation auc = 0.918021
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.493781
Epoch 22
Loss = 9.0938e-03, PNorm = 37.8636, GNorm = 0.0222, lr_0 = 3.5567e-04
Loss = 1.5901e-02, PNorm = 37.8668, GNorm = 0.2139, lr_0 = 3.4724e-04
Validation auc = 0.918924
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.495790
Epoch 23
Loss = 1.3360e-02, PNorm = 37.8678, GNorm = 0.0548, lr_0 = 3.3819e-04
Loss = 1.2818e-02, PNorm = 37.8733, GNorm = 0.0190, lr_0 = 3.3018e-04
Validation auc = 0.919375
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.496746
Epoch 24
Loss = 1.0797e-02, PNorm = 37.8779, GNorm = 0.0505, lr_0 = 3.2235e-04
Loss = 9.7508e-03, PNorm = 37.8843, GNorm = 0.0345, lr_0 = 3.1471e-04
Validation auc = 0.919014
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.496777
Epoch 25
Loss = 1.4643e-02, PNorm = 37.8831, GNorm = 0.0632, lr_0 = 3.0726e-04
Loss = 1.0848e-02, PNorm = 37.8879, GNorm = 0.5739, lr_0 = 2.9997e-04
Validation auc = 0.918653
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.497776
Epoch 26
Loss = 1.6355e-02, PNorm = 37.8879, GNorm = 0.0872, lr_0 = 2.9216e-04
Loss = 1.2472e-02, PNorm = 37.8929, GNorm = 0.0279, lr_0 = 2.8524e-04
Validation auc = 0.918563
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.498830
Epoch 27
Loss = 1.8159e-02, PNorm = 37.8982, GNorm = 0.1552, lr_0 = 2.7848e-04
Loss = 1.3767e-02, PNorm = 37.9019, GNorm = 0.0368, lr_0 = 2.7188e-04
Validation auc = 0.918472
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.507177
Epoch 28
Loss = 1.3330e-02, PNorm = 37.9067, GNorm = 0.2559, lr_0 = 2.6480e-04
Loss = 6.0988e-03, PNorm = 37.9107, GNorm = 0.0303, lr_0 = 2.5852e-04
Validation auc = 0.918202
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.510244
Epoch 29
Loss = 1.1065e-02, PNorm = 37.9130, GNorm = 0.0275, lr_0 = 2.5240e-04
Loss = 8.3574e-03, PNorm = 37.9147, GNorm = 0.0116, lr_0 = 2.4641e-04
Validation auc = 0.918743
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.507635
Epoch 30
Loss = 9.5859e-03, PNorm = 37.9186, GNorm = 0.0710, lr_0 = 2.4000e-04
Loss = 1.5999e-02, PNorm = 37.9211, GNorm = 0.4669, lr_0 = 2.3431e-04
Validation auc = 0.918292
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.510377
Epoch 31
Loss = 2.5324e-02, PNorm = 37.9223, GNorm = 0.4601, lr_0 = 2.2876e-04
Loss = 7.7268e-03, PNorm = 37.9244, GNorm = 0.5628, lr_0 = 2.2334e-04
Validation auc = 0.917840
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.512027
Epoch 32
Loss = 9.9173e-03, PNorm = 37.9296, GNorm = 0.0380, lr_0 = 2.1752e-04
Loss = 9.4757e-03, PNorm = 37.9339, GNorm = 0.4633, lr_0 = 2.1237e-04
Validation auc = 0.918202
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.516323
Epoch 33
Loss = 9.6786e-03, PNorm = 37.9346, GNorm = 0.2821, lr_0 = 2.0733e-04
Loss = 7.1868e-03, PNorm = 37.9359, GNorm = 0.0212, lr_0 = 2.0242e-04
Validation auc = 0.918021
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.516331
Epoch 34
Loss = 1.8279e-03, PNorm = 37.9373, GNorm = 0.0233, lr_0 = 1.9762e-04
Loss = 1.2151e-02, PNorm = 37.9402, GNorm = 0.0237, lr_0 = 1.9294e-04
Validation auc = 0.917299
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.520322
Epoch 35
Loss = 2.1173e-02, PNorm = 37.9429, GNorm = 0.4339, lr_0 = 1.8791e-04
Loss = 1.1028e-02, PNorm = 37.9452, GNorm = 0.0252, lr_0 = 1.8346e-04
Loss = 8.0436e-03, PNorm = 37.9470, GNorm = 0.2894, lr_0 = 1.7911e-04
Validation auc = 0.917931
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.519451
Epoch 36
Loss = 9.4219e-03, PNorm = 37.9492, GNorm = 0.0541, lr_0 = 1.7487e-04
Loss = 1.2383e-02, PNorm = 37.9510, GNorm = 0.0386, lr_0 = 1.7072e-04
Loss = 3.2695e-03, PNorm = 37.9512, GNorm = 0.1025, lr_0 = 1.7031e-04
Validation auc = 0.918472
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.519090
Epoch 37
Loss = 6.1290e-03, PNorm = 37.9533, GNorm = 0.0279, lr_0 = 1.6628e-04
Loss = 1.6453e-02, PNorm = 37.9564, GNorm = 0.6884, lr_0 = 1.6234e-04
Validation auc = 0.918202
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.521430
Epoch 38
Loss = 1.0829e-02, PNorm = 37.9583, GNorm = 0.0301, lr_0 = 1.5849e-04
Loss = 1.1152e-02, PNorm = 37.9601, GNorm = 0.0283, lr_0 = 1.5473e-04
Validation auc = 0.917840
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.525990
Epoch 39
Loss = 8.3303e-03, PNorm = 37.9622, GNorm = 0.0196, lr_0 = 1.5070e-04
Loss = 8.2448e-03, PNorm = 37.9627, GNorm = 0.2874, lr_0 = 1.4713e-04
Validation auc = 0.917840
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.524443
Epoch 40
Loss = 9.3078e-03, PNorm = 37.9649, GNorm = 0.3946, lr_0 = 1.4365e-04
Loss = 8.4131e-03, PNorm = 37.9668, GNorm = 0.0111, lr_0 = 1.4024e-04
Validation auc = 0.917750
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.524974
Epoch 41
Loss = 7.5326e-03, PNorm = 37.9683, GNorm = 0.0253, lr_0 = 1.3659e-04
Loss = 1.1775e-02, PNorm = 37.9707, GNorm = 0.0151, lr_0 = 1.3335e-04
Validation auc = 0.918382
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.528178
Epoch 42
Loss = 1.3989e-02, PNorm = 37.9719, GNorm = 0.0179, lr_0 = 1.3019e-04
Loss = 7.1535e-03, PNorm = 37.9736, GNorm = 0.0154, lr_0 = 1.2711e-04
Validation auc = 0.916667
Validation accuracy = 0.859031
Validation f1 = 0.899371
Validation binary_cross_entropy = 0.532651
Epoch 43
Loss = 1.5606e-03, PNorm = 37.9747, GNorm = 0.0169, lr_0 = 1.2409e-04
Loss = 1.5999e-02, PNorm = 37.9760, GNorm = 0.4927, lr_0 = 1.2115e-04
Validation auc = 0.916847
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.531963
Epoch 44
Loss = 4.7719e-03, PNorm = 37.9774, GNorm = 0.0202, lr_0 = 1.1800e-04
Loss = 7.9443e-03, PNorm = 37.9795, GNorm = 0.0259, lr_0 = 1.1520e-04
Validation auc = 0.917750
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.531354
Epoch 45
Loss = 1.8457e-03, PNorm = 37.9802, GNorm = 0.0262, lr_0 = 1.1247e-04
Loss = 1.0946e-02, PNorm = 37.9813, GNorm = 0.4942, lr_0 = 1.0981e-04
Validation auc = 0.917931
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.530693
Epoch 46
Loss = 7.5702e-03, PNorm = 37.9831, GNorm = 0.3118, lr_0 = 1.0695e-04
Loss = 9.4416e-03, PNorm = 37.9849, GNorm = 0.5372, lr_0 = 1.0441e-04
Validation auc = 0.917570
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.531918
Epoch 47
Loss = 1.3186e-03, PNorm = 37.9860, GNorm = 0.0436, lr_0 = 1.0194e-04
Loss = 1.2295e-02, PNorm = 37.9873, GNorm = 0.8410, lr_0 = 1.0000e-04
Validation auc = 0.917750
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.532903
Epoch 48
Loss = 9.8724e-03, PNorm = 37.9892, GNorm = 0.2663, lr_0 = 1.0000e-04
Loss = 1.2199e-02, PNorm = 37.9903, GNorm = 0.4486, lr_0 = 1.0000e-04
Validation auc = 0.917750
Validation accuracy = 0.867841
Validation f1 = 0.905063
Validation binary_cross_entropy = 0.535032
Epoch 49
Loss = 4.5001e-03, PNorm = 37.9923, GNorm = 0.0177, lr_0 = 1.0000e-04
Loss = 1.0551e-02, PNorm = 37.9935, GNorm = 0.0159, lr_0 = 1.0000e-04
Validation auc = 0.917389
Validation accuracy = 0.863436
Validation f1 = 0.902208
Validation binary_cross_entropy = 0.536140
Model 0 best validation auc = 0.926056 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.896888
Model 0 test accuracy = 0.833333
Model 0 test f1 = 0.874636
Model 0 test binary_cross_entropy = 0.446365
Ensemble test auc = 0.896888
Ensemble test accuracy = 0.833333
Ensemble test f1 = 0.874636
Ensemble test binary_cross_entropy = 0.446365
5-fold cross validation
	Seed 0 ==> test auc = 0.905080
	Seed 0 ==> test accuracy = 0.817829
	Seed 0 ==> test f1 = 0.863768
	Seed 0 ==> test binary_cross_entropy = 0.431686
	Seed 1 ==> test auc = 0.890257
	Seed 1 ==> test accuracy = 0.829457
	Seed 1 ==> test f1 = 0.870588
	Seed 1 ==> test binary_cross_entropy = 0.495855
	Seed 2 ==> test auc = 0.919173
	Seed 2 ==> test accuracy = 0.844961
	Seed 2 ==> test f1 = 0.889503
	Seed 2 ==> test binary_cross_entropy = 0.383963
	Seed 3 ==> test auc = 0.905244
	Seed 3 ==> test accuracy = 0.841085
	Seed 3 ==> test f1 = 0.881844
	Seed 3 ==> test binary_cross_entropy = 0.437109
	Seed 4 ==> test auc = 0.896888
	Seed 4 ==> test accuracy = 0.833333
	Seed 4 ==> test f1 = 0.874636
	Seed 4 ==> test binary_cross_entropy = 0.446365
Overall test auc = 0.903329 +/- 0.009697
Overall test accuracy = 0.833333 +/- 0.009494
Overall test f1 = 0.876068 +/- 0.008913
Overall test binary_cross_entropy = 0.438996 +/- 0.035701
Elapsed time = 0:04:04
