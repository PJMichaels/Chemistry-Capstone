Command line
python /home/ddunstan/.conda/envs/chemprop/bin/chemprop_train --data_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/clintox-random-train.csv --dataset_type classification --save_dir /home/ddunstan/Chemistry-Capstone/Complex_Models/clintox-random --epochs 50 --extra_metrics accuracy f1 binary_cross_entropy --metric auc --target_columns CT_TOX --smiles_columns smiles --num_folds 5 --split_sizes 0.8 0 0.2 --separate_val_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/clintox-random-validate.csv --features_generator morgan
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/clintox-random-train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy', 'f1', 'binary_cross_entropy'],
 'features_generator': ['morgan'],
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy', 'f1', 'binary_cross_entropy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/ddunstan/Chemistry-Capstone/Complex_Models/clintox-random',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/clintox-random-validate.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.0, 0.2],
 'split_type': 'random',
 'target_columns': ['CT_TOX'],
 'target_weights': None,
 'task_names': ['CT_TOX'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
CT_TOX 0: 91.72%, 1: 8.28%
Total size = 1,256 | train size = 1,004 | val size = 222 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 5.8187e-01, PNorm = 37.2516, GNorm = 2.1626, lr_0 = 3.4750e-04
Loss = 3.9408e-01, PNorm = 37.2780, GNorm = 2.1731, lr_0 = 5.7250e-04
Loss = 8.8320e-01, PNorm = 37.2803, GNorm = 27.7816, lr_0 = 5.9500e-04
Validation auc = 0.547021
Validation accuracy = 0.945946
Validation f1 = 0.142857
Validation binary_cross_entropy = 0.212256
Epoch 1
Loss = 1.2473e-01, PNorm = 37.3112, GNorm = 1.2472, lr_0 = 8.2000e-04
Loss = 1.2535e-01, PNorm = 37.3489, GNorm = 1.2924, lr_0 = 9.9521e-04
Loss = 2.3574e-02, PNorm = 37.3518, GNorm = 0.6491, lr_0 = 9.9283e-04
Validation auc = 0.721379
Validation accuracy = 0.891892
Validation f1 = 0.076923
Validation binary_cross_entropy = 0.300277
Epoch 2
Loss = 7.1319e-02, PNorm = 37.3966, GNorm = 1.1558, lr_0 = 9.6930e-04
Loss = 6.3248e-02, PNorm = 37.4375, GNorm = 1.2645, lr_0 = 9.4633e-04
Loss = 3.2321e-01, PNorm = 37.4366, GNorm = 6.9063, lr_0 = 9.4406e-04
Validation auc = 0.700350
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.252320
Epoch 3
Loss = 6.4766e-02, PNorm = 37.4548, GNorm = 0.9660, lr_0 = 9.2169e-04
Loss = 5.9768e-02, PNorm = 37.5087, GNorm = 1.1007, lr_0 = 8.9984e-04
Loss = 3.3808e-01, PNorm = 37.5092, GNorm = 1.8889, lr_0 = 8.9769e-04
Validation auc = 0.738026
Validation accuracy = 0.932432
Validation f1 = 0.117647
Validation binary_cross_entropy = 0.246852
Epoch 4
Loss = 3.8598e-02, PNorm = 37.5205, GNorm = 0.7674, lr_0 = 8.7641e-04
Loss = 6.7779e-02, PNorm = 37.5472, GNorm = 0.9074, lr_0 = 8.5564e-04
Loss = 8.2997e-03, PNorm = 37.5499, GNorm = 0.2647, lr_0 = 8.5359e-04
Validation auc = 0.740362
Validation accuracy = 0.932432
Validation f1 = 0.117647
Validation binary_cross_entropy = 0.252292
Epoch 5
Loss = 4.0055e-02, PNorm = 37.5743, GNorm = 0.7092, lr_0 = 8.3336e-04
Loss = 4.3685e-02, PNorm = 37.5963, GNorm = 0.3081, lr_0 = 8.1361e-04
Loss = 2.1270e-03, PNorm = 37.5977, GNorm = 0.0744, lr_0 = 8.1166e-04
Validation auc = 0.742699
Validation accuracy = 0.932432
Validation f1 = 0.117647
Validation binary_cross_entropy = 0.257261
Epoch 6
Loss = 3.1021e-02, PNorm = 37.6141, GNorm = 0.8127, lr_0 = 7.9243e-04
Loss = 4.5360e-02, PNorm = 37.6351, GNorm = 0.9853, lr_0 = 7.7364e-04
Loss = 6.5485e-04, PNorm = 37.6374, GNorm = 0.0199, lr_0 = 7.7179e-04
Validation auc = 0.753797
Validation accuracy = 0.932432
Validation f1 = 0.117647
Validation binary_cross_entropy = 0.264279
Epoch 7
Loss = 3.8615e-02, PNorm = 37.6486, GNorm = 1.0789, lr_0 = 7.5350e-04
Loss = 4.3510e-02, PNorm = 37.6575, GNorm = 0.0509, lr_0 = 7.3564e-04
Loss = 9.0772e-03, PNorm = 37.6593, GNorm = 0.2300, lr_0 = 7.3388e-04
Validation auc = 0.764311
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.276793
Epoch 8
Loss = 2.2663e-02, PNorm = 37.6780, GNorm = 0.0291, lr_0 = 7.1649e-04
Loss = 5.4539e-02, PNorm = 37.6961, GNorm = 1.2011, lr_0 = 6.9951e-04
Loss = 2.6940e-04, PNorm = 37.6956, GNorm = 0.0082, lr_0 = 6.9783e-04
Validation auc = 0.761390
Validation accuracy = 0.936937
Validation f1 = 0.125000
Validation binary_cross_entropy = 0.266879
Epoch 9
Loss = 2.6026e-02, PNorm = 37.6940, GNorm = 0.0572, lr_0 = 6.8129e-04
Loss = 5.4399e-02, PNorm = 37.7008, GNorm = 0.6581, lr_0 = 6.6515e-04
Loss = 9.6102e-04, PNorm = 37.7022, GNorm = 0.0257, lr_0 = 6.6355e-04
Validation auc = 0.768692
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.293416
Epoch 10
Loss = 3.4564e-02, PNorm = 37.7240, GNorm = 0.4880, lr_0 = 6.4783e-04
Loss = 4.5619e-02, PNorm = 37.7269, GNorm = 0.0344, lr_0 = 6.3247e-04
Loss = 3.7412e-04, PNorm = 37.7265, GNorm = 0.0113, lr_0 = 6.3096e-04
Validation auc = 0.759638
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.282281
Epoch 11
Loss = 2.5381e-02, PNorm = 37.7301, GNorm = 0.5953, lr_0 = 6.1600e-04
Loss = 4.8877e-02, PNorm = 37.7530, GNorm = 0.5757, lr_0 = 6.0140e-04
Loss = 1.0442e-03, PNorm = 37.7552, GNorm = 0.0309, lr_0 = 5.9996e-04
Validation auc = 0.764895
Validation accuracy = 0.932432
Validation f1 = 0.117647
Validation binary_cross_entropy = 0.270083
Epoch 12
Loss = 2.7641e-02, PNorm = 37.7618, GNorm = 0.6373, lr_0 = 5.8574e-04
Loss = 4.1991e-02, PNorm = 37.7705, GNorm = 0.2462, lr_0 = 5.7186e-04
Validation auc = 0.770444
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.282954
Epoch 13
Loss = 1.7176e-02, PNorm = 37.7709, GNorm = 0.1773, lr_0 = 5.5831e-04
Loss = 7.2655e-02, PNorm = 37.8088, GNorm = 1.1108, lr_0 = 5.4508e-04
Validation auc = 0.774825
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.285819
Epoch 14
Loss = 2.9836e-02, PNorm = 37.8508, GNorm = 0.2162, lr_0 = 5.3088e-04
Loss = 5.5362e-02, PNorm = 37.8479, GNorm = 0.7497, lr_0 = 5.1830e-04
Validation auc = 0.774825
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.292187
Epoch 15
Loss = 2.3768e-02, PNorm = 37.8623, GNorm = 0.2715, lr_0 = 5.0481e-04
Loss = 4.0871e-02, PNorm = 37.8837, GNorm = 0.0198, lr_0 = 4.9284e-04
Validation auc = 0.776577
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.276241
Epoch 16
Loss = 2.9966e-02, PNorm = 37.9013, GNorm = 0.0305, lr_0 = 4.8001e-04
Loss = 2.4096e-02, PNorm = 37.9094, GNorm = 0.5434, lr_0 = 4.6863e-04
Validation auc = 0.787091
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.280444
Epoch 17
Loss = 3.0735e-02, PNorm = 37.9243, GNorm = 0.7509, lr_0 = 4.5643e-04
Loss = 2.7489e-02, PNorm = 37.9369, GNorm = 0.5894, lr_0 = 4.4561e-04
Validation auc = 0.787967
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.273795
Epoch 18
Loss = 2.3272e-02, PNorm = 37.9433, GNorm = 0.0129, lr_0 = 4.3401e-04
Loss = 4.1178e-02, PNorm = 37.9548, GNorm = 0.5603, lr_0 = 4.2372e-04
Validation auc = 0.780374
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.286973
Epoch 19
Loss = 2.0579e-02, PNorm = 37.9681, GNorm = 0.7626, lr_0 = 4.1269e-04
Loss = 4.2972e-02, PNorm = 37.9741, GNorm = 1.3189, lr_0 = 4.0291e-04
Validation auc = 0.791180
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.280806
Epoch 20
Loss = 2.3274e-02, PNorm = 37.9833, GNorm = 0.4168, lr_0 = 3.9242e-04
Loss = 3.2172e-02, PNorm = 37.9912, GNorm = 0.0128, lr_0 = 3.8312e-04
Validation auc = 0.792640
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.281622
Epoch 21
Loss = 2.4995e-02, PNorm = 37.9989, GNorm = 0.3775, lr_0 = 3.7314e-04
Loss = 2.8199e-02, PNorm = 38.0080, GNorm = 0.4420, lr_0 = 3.6430e-04
Validation auc = 0.797605
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.280387
Epoch 22
Loss = 2.1161e-02, PNorm = 38.0103, GNorm = 0.5936, lr_0 = 3.5481e-04
Loss = 2.6192e-02, PNorm = 38.0190, GNorm = 0.5141, lr_0 = 3.4640e-04
Validation auc = 0.795561
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.284898
Epoch 23
Loss = 2.9335e-02, PNorm = 38.0287, GNorm = 0.3595, lr_0 = 3.3738e-04
Loss = 2.8263e-02, PNorm = 38.0349, GNorm = 0.0132, lr_0 = 3.2939e-04
Validation auc = 0.796729
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.285204
Epoch 24
Loss = 1.4812e-02, PNorm = 38.0436, GNorm = 0.0180, lr_0 = 3.2081e-04
Loss = 3.1949e-02, PNorm = 38.0459, GNorm = 0.3573, lr_0 = 3.1321e-04
Validation auc = 0.799357
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.287034
Epoch 25
Loss = 2.7897e-02, PNorm = 38.0493, GNorm = 0.0551, lr_0 = 3.0579e-04
Loss = 2.7004e-02, PNorm = 38.0577, GNorm = 0.5549, lr_0 = 2.9854e-04
Validation auc = 0.799357
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.288169
Epoch 26
Loss = 2.3134e-02, PNorm = 38.0638, GNorm = 0.3435, lr_0 = 2.9076e-04
Loss = 2.5968e-02, PNorm = 38.0715, GNorm = 0.3606, lr_0 = 2.8387e-04
Validation auc = 0.800818
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.287878
Epoch 27
Loss = 1.3602e-02, PNorm = 38.0751, GNorm = 0.3589, lr_0 = 2.7648e-04
Loss = 3.1091e-02, PNorm = 38.0801, GNorm = 0.8343, lr_0 = 2.6993e-04
Validation auc = 0.804907
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.290255
Epoch 28
Loss = 1.7018e-02, PNorm = 38.0891, GNorm = 0.0152, lr_0 = 2.6290e-04
Loss = 2.9074e-02, PNorm = 38.0930, GNorm = 0.4676, lr_0 = 2.5667e-04
Validation auc = 0.806367
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.290450
Epoch 29
Loss = 1.8399e-02, PNorm = 38.0974, GNorm = 0.2848, lr_0 = 2.4999e-04
Loss = 2.9433e-02, PNorm = 38.1041, GNorm = 0.6150, lr_0 = 2.4406e-04
Validation auc = 0.811332
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.290170
Epoch 30
Loss = 2.0676e-02, PNorm = 38.1123, GNorm = 0.4513, lr_0 = 2.3771e-04
Loss = 2.9147e-02, PNorm = 38.1152, GNorm = 0.9184, lr_0 = 2.3207e-04
Validation auc = 0.804614
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.294836
Epoch 31
Loss = 3.0682e-02, PNorm = 38.1159, GNorm = 0.5323, lr_0 = 2.2603e-04
Loss = 2.1617e-02, PNorm = 38.1196, GNorm = 0.8224, lr_0 = 2.2067e-04
Validation auc = 0.801402
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.299023
Epoch 32
Loss = 1.9744e-02, PNorm = 38.1245, GNorm = 0.8026, lr_0 = 2.1493e-04
Loss = 2.6404e-02, PNorm = 38.1305, GNorm = 0.0047, lr_0 = 2.0983e-04
Validation auc = 0.807535
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.295372
Epoch 33
Loss = 1.9915e-02, PNorm = 38.1343, GNorm = 0.3300, lr_0 = 2.0437e-04
Loss = 2.5567e-02, PNorm = 38.1392, GNorm = 0.8178, lr_0 = 1.9953e-04
Validation auc = 0.806075
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.298097
Epoch 34
Loss = 2.4076e-02, PNorm = 38.1438, GNorm = 0.0070, lr_0 = 1.9433e-04
Loss = 2.4201e-02, PNorm = 38.1458, GNorm = 0.8769, lr_0 = 1.8973e-04
Validation auc = 0.808703
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.297396
Epoch 35
Loss = 2.4082e-02, PNorm = 38.1524, GNorm = 0.6621, lr_0 = 1.8478e-04
Loss = 3.0509e-02, PNorm = 38.1537, GNorm = 0.5587, lr_0 = 1.8041e-04
Validation auc = 0.813376
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.295866
Epoch 36
Loss = 1.7836e-02, PNorm = 38.1568, GNorm = 0.5471, lr_0 = 1.7571e-04
Loss = 3.0000e-02, PNorm = 38.1603, GNorm = 0.5658, lr_0 = 1.7154e-04
Validation auc = 0.814836
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.298598
Epoch 37
Loss = 1.2115e-02, PNorm = 38.1621, GNorm = 0.4649, lr_0 = 1.6708e-04
Loss = 3.1067e-02, PNorm = 38.1644, GNorm = 0.0091, lr_0 = 1.6312e-04
Validation auc = 0.811916
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.300143
Epoch 38
Loss = 2.2796e-02, PNorm = 38.1657, GNorm = 0.4356, lr_0 = 1.5925e-04
Loss = 2.5010e-02, PNorm = 38.1696, GNorm = 0.1182, lr_0 = 1.5548e-04
Validation auc = 0.807535
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.301371
Epoch 39
Loss = 1.7838e-02, PNorm = 38.1757, GNorm = 0.5725, lr_0 = 1.5143e-04
Loss = 2.5010e-02, PNorm = 38.1782, GNorm = 0.6415, lr_0 = 1.4784e-04
Validation auc = 0.811040
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.301764
Epoch 40
Loss = 2.7908e-02, PNorm = 38.1735, GNorm = 0.3131, lr_0 = 1.4399e-04
Loss = 2.1762e-02, PNorm = 38.1774, GNorm = 0.5741, lr_0 = 1.4058e-04
Validation auc = 0.799942
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.308663
Epoch 41
Loss = 2.6453e-02, PNorm = 38.1835, GNorm = 0.8098, lr_0 = 1.3692e-04
Loss = 3.4864e-02, PNorm = 38.1890, GNorm = 0.0377, lr_0 = 1.3367e-04
Validation auc = 0.803446
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.305677
Epoch 42
Loss = 1.9237e-02, PNorm = 38.1948, GNorm = 0.6496, lr_0 = 1.3019e-04
Loss = 2.9504e-02, PNorm = 38.1988, GNorm = 0.2812, lr_0 = 1.2711e-04
Validation auc = 0.806075
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.304434
Epoch 43
Loss = 1.3273e-02, PNorm = 38.2020, GNorm = 0.2922, lr_0 = 1.2380e-04
Loss = 3.4958e-02, PNorm = 38.2052, GNorm = 0.7364, lr_0 = 1.2086e-04
Validation auc = 0.810164
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.304067
Epoch 44
Loss = 2.6547e-02, PNorm = 38.2084, GNorm = 0.2533, lr_0 = 1.1772e-04
Loss = 2.4011e-02, PNorm = 38.2105, GNorm = 0.3517, lr_0 = 1.1493e-04
Validation auc = 0.815129
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.304440
Epoch 45
Loss = 2.2279e-02, PNorm = 38.2139, GNorm = 0.7208, lr_0 = 1.1193e-04
Loss = 3.1010e-02, PNorm = 38.2163, GNorm = 0.4783, lr_0 = 1.0928e-04
Validation auc = 0.818341
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.302600
Epoch 46
Loss = 2.2245e-02, PNorm = 38.2207, GNorm = 0.4012, lr_0 = 1.0643e-04
Loss = 2.0905e-02, PNorm = 38.2235, GNorm = 0.3934, lr_0 = 1.0391e-04
Validation auc = 0.819801
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.302178
Epoch 47
Loss = 2.4275e-02, PNorm = 38.2205, GNorm = 0.2956, lr_0 = 1.0121e-04
Loss = 3.1885e-02, PNorm = 38.2217, GNorm = 0.7277, lr_0 = 1.0000e-04
Validation auc = 0.816589
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.306305
Epoch 48
Loss = 2.6184e-02, PNorm = 38.2246, GNorm = 0.4179, lr_0 = 1.0000e-04
Loss = 2.8928e-02, PNorm = 38.2288, GNorm = 0.6728, lr_0 = 1.0000e-04
Validation auc = 0.818925
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.303979
Epoch 49
Loss = 1.4289e-02, PNorm = 38.2348, GNorm = 0.6769, lr_0 = 1.0000e-04
Loss = 2.6466e-02, PNorm = 38.2390, GNorm = 0.2319, lr_0 = 1.0000e-04
Validation auc = 0.813960
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.304704
Model 0 best validation auc = 0.819801 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.754235
Model 0 test accuracy = 0.912698
Model 0 test f1 = 0.214286
Model 0 test binary_cross_entropy = 0.467996
Ensemble test auc = 0.754235
Ensemble test accuracy = 0.912698
Ensemble test f1 = 0.214286
Ensemble test binary_cross_entropy = 0.467996
Fold 1
Splitting data with seed 1
Class sizes
CT_TOX 0: 91.72%, 1: 8.28%
Total size = 1,256 | train size = 1,004 | val size = 222 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 5.9194e-01, PNorm = 37.2519, GNorm = 2.3833, lr_0 = 3.4750e-04
Loss = 3.4972e-01, PNorm = 37.2774, GNorm = 3.3812, lr_0 = 5.7250e-04
Loss = 4.9849e-01, PNorm = 37.2769, GNorm = 9.2013, lr_0 = 5.9500e-04
Validation auc = 0.575350
Validation accuracy = 0.941441
Validation f1 = 0.133333
Validation binary_cross_entropy = 0.218825
Epoch 1
Loss = 1.2922e-01, PNorm = 37.3139, GNorm = 0.8996, lr_0 = 8.2000e-04
Loss = 1.3741e-01, PNorm = 37.3853, GNorm = 2.2015, lr_0 = 9.9521e-04
Loss = 2.0337e-02, PNorm = 37.3891, GNorm = 0.2824, lr_0 = 9.9283e-04
Validation auc = 0.759054
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.250324
Epoch 2
Loss = 5.2107e-02, PNorm = 37.4353, GNorm = 0.4002, lr_0 = 9.6930e-04
Loss = 4.1406e-02, PNorm = 37.4666, GNorm = 0.6965, lr_0 = 9.4633e-04
Loss = 4.7551e-03, PNorm = 37.4686, GNorm = 0.1184, lr_0 = 9.4406e-04
Validation auc = 0.825058
Validation accuracy = 0.918919
Validation f1 = 0.250000
Validation binary_cross_entropy = 0.288271
Epoch 3
Loss = 3.8465e-02, PNorm = 37.4984, GNorm = 1.1750, lr_0 = 9.2169e-04
Loss = 4.0752e-02, PNorm = 37.5041, GNorm = 0.6899, lr_0 = 8.9984e-04
Loss = 7.0733e-03, PNorm = 37.5046, GNorm = 0.1527, lr_0 = 8.9769e-04
Validation auc = 0.822138
Validation accuracy = 0.918919
Validation f1 = 0.250000
Validation binary_cross_entropy = 0.326397
Epoch 4
Loss = 3.6358e-02, PNorm = 37.5266, GNorm = 0.5644, lr_0 = 8.7641e-04
Loss = 3.2493e-02, PNorm = 37.5601, GNorm = 0.0254, lr_0 = 8.5564e-04
Loss = 1.3077e-04, PNorm = 37.5620, GNorm = 0.0053, lr_0 = 8.5359e-04
Validation auc = 0.787675
Validation accuracy = 0.932432
Validation f1 = 0.117647
Validation binary_cross_entropy = 0.261080
Epoch 5
Loss = 3.5990e-02, PNorm = 37.5552, GNorm = 0.0932, lr_0 = 8.3336e-04
Loss = 4.3948e-02, PNorm = 37.5693, GNorm = 0.1856, lr_0 = 8.1361e-04
Loss = 1.9932e-03, PNorm = 37.5714, GNorm = 0.0710, lr_0 = 8.1166e-04
Validation auc = 0.819801
Validation accuracy = 0.914414
Validation f1 = 0.240000
Validation binary_cross_entropy = 0.328999
Epoch 6
Loss = 2.6623e-02, PNorm = 37.5972, GNorm = 0.8014, lr_0 = 7.9243e-04
Loss = 4.0257e-02, PNorm = 37.5965, GNorm = 0.1742, lr_0 = 7.7364e-04
Loss = 7.3806e-03, PNorm = 37.5976, GNorm = 0.1981, lr_0 = 7.7179e-04
Validation auc = 0.798189
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.327782
Epoch 7
Loss = 1.4715e-02, PNorm = 37.6122, GNorm = 0.3544, lr_0 = 7.5350e-04
Loss = 3.9478e-02, PNorm = 37.6289, GNorm = 1.2870, lr_0 = 7.3564e-04
Loss = 9.3521e-04, PNorm = 37.6311, GNorm = 0.0215, lr_0 = 7.3388e-04
Validation auc = 0.783586
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.305775
Epoch 8
Loss = 1.5752e-02, PNorm = 37.6458, GNorm = 0.0469, lr_0 = 7.1649e-04
Loss = 3.1152e-02, PNorm = 37.6494, GNorm = 0.0275, lr_0 = 6.9951e-04
Loss = 1.8145e-03, PNorm = 37.6493, GNorm = 0.0709, lr_0 = 6.9783e-04
Validation auc = 0.792348
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.320455
Epoch 9
Loss = 1.9550e-02, PNorm = 37.6551, GNorm = 0.6450, lr_0 = 6.8129e-04
Loss = 3.1426e-02, PNorm = 37.6744, GNorm = 0.5971, lr_0 = 6.6515e-04
Loss = 2.9398e-03, PNorm = 37.6760, GNorm = 0.1374, lr_0 = 6.6355e-04
Validation auc = 0.797021
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.306994
Epoch 10
Loss = 1.9860e-02, PNorm = 37.6901, GNorm = 0.1634, lr_0 = 6.4783e-04
Loss = 3.8187e-02, PNorm = 37.6890, GNorm = 1.1592, lr_0 = 6.3247e-04
Loss = 9.0930e-04, PNorm = 37.6891, GNorm = 0.0314, lr_0 = 6.3096e-04
Validation auc = 0.792348
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.325699
Epoch 11
Loss = 1.9982e-02, PNorm = 37.6962, GNorm = 0.3008, lr_0 = 6.1600e-04
Loss = 3.2499e-02, PNorm = 37.7094, GNorm = 0.0317, lr_0 = 6.0140e-04
Loss = 1.7265e-01, PNorm = 37.7083, GNorm = 4.5662, lr_0 = 5.9996e-04
Validation auc = 0.807535
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.325939
Epoch 12
Loss = 3.6594e-02, PNorm = 37.7215, GNorm = 1.1544, lr_0 = 5.8574e-04
Loss = 2.6153e-02, PNorm = 37.7439, GNorm = 0.7474, lr_0 = 5.7186e-04
Validation auc = 0.751460
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.331769
Epoch 13
Loss = 1.3450e-02, PNorm = 37.7493, GNorm = 0.2085, lr_0 = 5.5831e-04
Loss = 5.1630e-02, PNorm = 37.7554, GNorm = 0.2794, lr_0 = 5.4508e-04
Validation auc = 0.808119
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.342103
Epoch 14
Loss = 1.4235e-02, PNorm = 37.7634, GNorm = 0.0245, lr_0 = 5.3088e-04
Loss = 4.4505e-02, PNorm = 37.7794, GNorm = 0.5092, lr_0 = 5.1830e-04
Validation auc = 0.794977
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.317588
Epoch 15
Loss = 1.1733e-02, PNorm = 37.7948, GNorm = 0.0370, lr_0 = 5.0481e-04
Loss = 3.7730e-02, PNorm = 37.7961, GNorm = 0.0150, lr_0 = 4.9284e-04
Validation auc = 0.808703
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.319342
Epoch 16
Loss = 1.9687e-02, PNorm = 37.7984, GNorm = 0.0142, lr_0 = 4.8001e-04
Loss = 2.2311e-02, PNorm = 37.8077, GNorm = 0.0138, lr_0 = 4.6863e-04
Validation auc = 0.805199
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.320963
Epoch 17
Loss = 2.4865e-02, PNorm = 37.8371, GNorm = 0.0162, lr_0 = 4.5643e-04
Loss = 3.2246e-02, PNorm = 37.8509, GNorm = 0.8412, lr_0 = 4.4561e-04
Validation auc = 0.748540
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.335873
Epoch 18
Loss = 2.1234e-02, PNorm = 37.8413, GNorm = 0.5277, lr_0 = 4.3401e-04
Loss = 4.0566e-02, PNorm = 37.8438, GNorm = 0.0189, lr_0 = 4.2372e-04
Validation auc = 0.768400
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.349209
Epoch 19
Loss = 3.5102e-02, PNorm = 37.8446, GNorm = 1.0608, lr_0 = 4.1269e-04
Loss = 2.9917e-02, PNorm = 37.8585, GNorm = 0.0258, lr_0 = 4.0291e-04
Validation auc = 0.781834
Validation accuracy = 0.914414
Validation f1 = 0.173913
Validation binary_cross_entropy = 0.345969
Epoch 20
Loss = 3.6110e-02, PNorm = 37.8769, GNorm = 0.0111, lr_0 = 3.9242e-04
Loss = 2.8225e-02, PNorm = 37.8838, GNorm = 0.4445, lr_0 = 3.8312e-04
Validation auc = 0.792348
Validation accuracy = 0.914414
Validation f1 = 0.173913
Validation binary_cross_entropy = 0.328598
Epoch 21
Loss = 1.9341e-02, PNorm = 37.8959, GNorm = 0.5033, lr_0 = 3.7314e-04
Loss = 2.3044e-02, PNorm = 37.9018, GNorm = 0.4898, lr_0 = 3.6430e-04
Validation auc = 0.800526
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.324287
Epoch 22
Loss = 1.1097e-02, PNorm = 37.9095, GNorm = 0.4563, lr_0 = 3.5481e-04
Loss = 3.8103e-02, PNorm = 37.9212, GNorm = 0.0215, lr_0 = 3.4640e-04
Validation auc = 0.796437
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.321122
Epoch 23
Loss = 1.2301e-02, PNorm = 37.9350, GNorm = 0.5006, lr_0 = 3.3738e-04
Loss = 2.9300e-02, PNorm = 37.9397, GNorm = 0.4931, lr_0 = 3.2939e-04
Validation auc = 0.800526
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.321861
Epoch 24
Loss = 1.7171e-02, PNorm = 37.9474, GNorm = 0.4611, lr_0 = 3.2081e-04
Loss = 2.0702e-02, PNorm = 37.9490, GNorm = 0.3420, lr_0 = 3.1321e-04
Validation auc = 0.816881
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.329832
Epoch 25
Loss = 1.5341e-02, PNorm = 37.9563, GNorm = 0.0142, lr_0 = 3.0579e-04
Loss = 1.7888e-02, PNorm = 37.9681, GNorm = 0.7242, lr_0 = 2.9854e-04
Validation auc = 0.808703
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.322734
Epoch 26
Loss = 1.4657e-02, PNorm = 37.9746, GNorm = 0.3372, lr_0 = 2.9076e-04
Loss = 1.7330e-02, PNorm = 37.9832, GNorm = 0.1950, lr_0 = 2.8387e-04
Validation auc = 0.812208
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.316779
Epoch 27
Loss = 1.5608e-02, PNorm = 37.9855, GNorm = 0.4073, lr_0 = 2.7648e-04
Loss = 1.4730e-02, PNorm = 37.9905, GNorm = 0.0116, lr_0 = 2.6993e-04
Validation auc = 0.810456
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.323440
Epoch 28
Loss = 1.2895e-02, PNorm = 38.0003, GNorm = 0.0099, lr_0 = 2.6290e-04
Loss = 1.5265e-02, PNorm = 38.0052, GNorm = 0.0082, lr_0 = 2.5667e-04
Validation auc = 0.809287
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.318944
Epoch 29
Loss = 1.9714e-02, PNorm = 38.0094, GNorm = 0.3201, lr_0 = 2.4999e-04
Loss = 1.3291e-02, PNorm = 38.0127, GNorm = 0.0561, lr_0 = 2.4406e-04
Validation auc = 0.818049
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.321149
Epoch 30
Loss = 2.4102e-02, PNorm = 38.0202, GNorm = 0.5378, lr_0 = 2.3771e-04
Loss = 1.1849e-02, PNorm = 38.0230, GNorm = 0.4826, lr_0 = 2.3207e-04
Validation auc = 0.813376
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.322068
Epoch 31
Loss = 1.3176e-02, PNorm = 38.0272, GNorm = 0.4461, lr_0 = 2.2603e-04
Loss = 1.5731e-02, PNorm = 38.0286, GNorm = 0.5722, lr_0 = 2.2067e-04
Validation auc = 0.815713
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.325924
Epoch 32
Loss = 1.6633e-02, PNorm = 38.0353, GNorm = 0.5691, lr_0 = 2.1493e-04
Loss = 1.6376e-02, PNorm = 38.0411, GNorm = 0.0125, lr_0 = 2.0983e-04
Validation auc = 0.815129
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.321102
Epoch 33
Loss = 1.3516e-02, PNorm = 38.0443, GNorm = 0.3056, lr_0 = 2.0437e-04
Loss = 1.5705e-02, PNorm = 38.0464, GNorm = 0.0169, lr_0 = 1.9953e-04
Validation auc = 0.813084
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.325851
Epoch 34
Loss = 2.1854e-02, PNorm = 38.0511, GNorm = 0.5165, lr_0 = 1.9433e-04
Loss = 7.7798e-03, PNorm = 38.0570, GNorm = 0.0071, lr_0 = 1.8973e-04
Validation auc = 0.809871
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.321144
Epoch 35
Loss = 1.2612e-02, PNorm = 38.0539, GNorm = 0.0052, lr_0 = 1.8478e-04
Loss = 2.1212e-02, PNorm = 38.0569, GNorm = 0.5977, lr_0 = 1.8041e-04
Validation auc = 0.825643
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.328976
Epoch 36
Loss = 8.8141e-03, PNorm = 38.0636, GNorm = 0.2870, lr_0 = 1.7571e-04
Loss = 2.3129e-02, PNorm = 38.0682, GNorm = 0.2867, lr_0 = 1.7154e-04
Validation auc = 0.814544
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.326323
Epoch 37
Loss = 7.6318e-03, PNorm = 38.0716, GNorm = 0.2022, lr_0 = 1.6708e-04
Loss = 1.6924e-02, PNorm = 38.0761, GNorm = 0.6150, lr_0 = 1.6312e-04
Validation auc = 0.813376
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.326399
Epoch 38
Loss = 2.2022e-02, PNorm = 38.0765, GNorm = 0.4489, lr_0 = 1.5925e-04
Loss = 1.3609e-02, PNorm = 38.0780, GNorm = 0.5555, lr_0 = 1.5548e-04
Validation auc = 0.827979
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.331708
Epoch 39
Loss = 2.1266e-02, PNorm = 38.0820, GNorm = 0.3149, lr_0 = 1.5143e-04
Loss = 1.4614e-02, PNorm = 38.0859, GNorm = 0.4517, lr_0 = 1.4784e-04
Validation auc = 0.821554
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.327931
Epoch 40
Loss = 2.3038e-02, PNorm = 38.0862, GNorm = 0.2231, lr_0 = 1.4399e-04
Loss = 1.0227e-02, PNorm = 38.0886, GNorm = 0.5045, lr_0 = 1.4058e-04
Validation auc = 0.819801
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.331405
Epoch 41
Loss = 8.2533e-03, PNorm = 38.0926, GNorm = 0.3089, lr_0 = 1.3692e-04
Loss = 1.8768e-02, PNorm = 38.0955, GNorm = 0.3045, lr_0 = 1.3367e-04
Validation auc = 0.822722
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.331198
Epoch 42
Loss = 1.2485e-02, PNorm = 38.0989, GNorm = 0.2806, lr_0 = 1.3019e-04
Loss = 1.1624e-02, PNorm = 38.1005, GNorm = 0.0102, lr_0 = 1.2711e-04
Validation auc = 0.821554
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.330302
Epoch 43
Loss = 7.5909e-03, PNorm = 38.1053, GNorm = 0.5044, lr_0 = 1.2380e-04
Loss = 2.2066e-02, PNorm = 38.1084, GNorm = 0.0089, lr_0 = 1.2086e-04
Validation auc = 0.819217
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.328732
Epoch 44
Loss = 1.9810e-02, PNorm = 38.1079, GNorm = 0.2576, lr_0 = 1.1772e-04
Loss = 1.1262e-02, PNorm = 38.1091, GNorm = 0.0400, lr_0 = 1.1493e-04
Validation auc = 0.823306
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.332236
Epoch 45
Loss = 1.1801e-02, PNorm = 38.1125, GNorm = 0.3859, lr_0 = 1.1193e-04
Loss = 1.6548e-02, PNorm = 38.1150, GNorm = 0.0039, lr_0 = 1.0928e-04
Validation auc = 0.820386
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.331694
Epoch 46
Loss = 1.9519e-02, PNorm = 38.1162, GNorm = 0.3373, lr_0 = 1.0643e-04
Loss = 1.0234e-02, PNorm = 38.1175, GNorm = 0.0064, lr_0 = 1.0391e-04
Validation auc = 0.824474
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.333695
Epoch 47
Loss = 1.2500e-02, PNorm = 38.1210, GNorm = 0.3581, lr_0 = 1.0121e-04
Loss = 1.0591e-02, PNorm = 38.1239, GNorm = 0.0054, lr_0 = 1.0000e-04
Validation auc = 0.822138
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.331803
Epoch 48
Loss = 2.0714e-02, PNorm = 38.1275, GNorm = 0.6850, lr_0 = 1.0000e-04
Loss = 1.2930e-02, PNorm = 38.1266, GNorm = 0.0062, lr_0 = 1.0000e-04
Validation auc = 0.825058
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.333418
Epoch 49
Loss = 1.5856e-02, PNorm = 38.1278, GNorm = 0.0113, lr_0 = 1.0000e-04
Loss = 1.6226e-02, PNorm = 38.1300, GNorm = 0.0085, lr_0 = 1.0000e-04
Validation auc = 0.823306
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.333421
Model 0 best validation auc = 0.827979 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.735939
Model 0 test accuracy = 0.900794
Model 0 test f1 = 0.193548
Model 0 test binary_cross_entropy = 0.465021
Ensemble test auc = 0.735939
Ensemble test accuracy = 0.900794
Ensemble test f1 = 0.193548
Ensemble test binary_cross_entropy = 0.465021
Fold 2
Splitting data with seed 2
Class sizes
CT_TOX 0: 91.72%, 1: 8.28%
Total size = 1,256 | train size = 1,004 | val size = 222 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 5.8808e-01, PNorm = 37.2535, GNorm = 3.1971, lr_0 = 3.4750e-04
Loss = 3.8471e-01, PNorm = 37.2800, GNorm = 2.6329, lr_0 = 5.7250e-04
Loss = 4.6081e-03, PNorm = 37.2810, GNorm = 0.1670, lr_0 = 5.9500e-04
Validation auc = 0.517815
Validation accuracy = 0.954955
Validation f1 = 0.166667
Validation binary_cross_entropy = 0.197866
Epoch 1
Loss = 1.3652e-01, PNorm = 37.3085, GNorm = 1.1373, lr_0 = 8.2000e-04
Loss = 1.4970e-01, PNorm = 37.3802, GNorm = 0.7406, lr_0 = 9.9521e-04
Loss = 2.6230e-01, PNorm = 37.3902, GNorm = 8.6952, lr_0 = 9.9283e-04
Validation auc = 0.691297
Validation accuracy = 0.959459
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.218811
Epoch 2
Loss = 1.0345e-01, PNorm = 37.4182, GNorm = 1.0972, lr_0 = 9.6930e-04
Loss = 1.0391e-01, PNorm = 37.4496, GNorm = 0.9186, lr_0 = 9.4633e-04
Loss = 1.8379e-02, PNorm = 37.4545, GNorm = 0.4825, lr_0 = 9.4406e-04
Validation auc = 0.758470
Validation accuracy = 0.905405
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.336260
Epoch 3
Loss = 1.0537e-01, PNorm = 37.5086, GNorm = 1.1705, lr_0 = 9.2169e-04
Loss = 5.4718e-02, PNorm = 37.5229, GNorm = 0.5901, lr_0 = 8.9984e-04
Loss = 3.1139e-03, PNorm = 37.5245, GNorm = 0.0635, lr_0 = 8.9769e-04
Validation auc = 0.714661
Validation accuracy = 0.927928
Validation f1 = 0.200000
Validation binary_cross_entropy = 0.265515
Epoch 4
Loss = 4.9074e-02, PNorm = 37.5420, GNorm = 1.3449, lr_0 = 8.7641e-04
Loss = 6.2003e-02, PNorm = 37.5576, GNorm = 0.8363, lr_0 = 8.5564e-04
Loss = 5.1639e-03, PNorm = 37.5594, GNorm = 0.1437, lr_0 = 8.5359e-04
Validation auc = 0.691589
Validation accuracy = 0.932432
Validation f1 = 0.210526
Validation binary_cross_entropy = 0.266020
Epoch 5
Loss = 4.7362e-02, PNorm = 37.5772, GNorm = 0.0272, lr_0 = 8.3336e-04
Loss = 4.2611e-02, PNorm = 37.5881, GNorm = 0.0691, lr_0 = 8.1361e-04
Loss = 1.0770e-03, PNorm = 37.5884, GNorm = 0.0292, lr_0 = 8.1166e-04
Validation auc = 0.719334
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.254951
Epoch 6
Loss = 2.0754e-02, PNorm = 37.5990, GNorm = 0.2324, lr_0 = 7.9243e-04
Loss = 5.1840e-02, PNorm = 37.6197, GNorm = 0.6631, lr_0 = 7.7364e-04
Loss = 5.8203e-03, PNorm = 37.6222, GNorm = 0.0909, lr_0 = 7.7179e-04
Validation auc = 0.716121
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.251190
Epoch 7
Loss = 3.4061e-02, PNorm = 37.6321, GNorm = 0.0408, lr_0 = 7.5350e-04
Loss = 3.6394e-02, PNorm = 37.6540, GNorm = 0.0220, lr_0 = 7.3564e-04
Loss = 6.3776e-04, PNorm = 37.6562, GNorm = 0.0170, lr_0 = 7.3388e-04
Validation auc = 0.703855
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.255709
Epoch 8
Loss = 3.2463e-02, PNorm = 37.6675, GNorm = 0.3260, lr_0 = 7.1649e-04
Loss = 4.1936e-02, PNorm = 37.6755, GNorm = 0.0499, lr_0 = 6.9951e-04
Loss = 7.8366e-04, PNorm = 37.6768, GNorm = 0.0223, lr_0 = 6.9783e-04
Validation auc = 0.718750
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.263133
Epoch 9
Loss = 2.2255e-02, PNorm = 37.6851, GNorm = 0.5061, lr_0 = 6.8129e-04
Loss = 3.1530e-02, PNorm = 37.6997, GNorm = 0.6690, lr_0 = 6.6515e-04
Loss = 8.4252e-04, PNorm = 37.7011, GNorm = 0.0206, lr_0 = 6.6355e-04
Validation auc = 0.725175
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.258234
Epoch 10
Loss = 3.0821e-02, PNorm = 37.7125, GNorm = 0.7839, lr_0 = 6.4783e-04
Loss = 3.6951e-02, PNorm = 37.7198, GNorm = 1.2044, lr_0 = 6.3247e-04
Loss = 2.2113e-04, PNorm = 37.7195, GNorm = 0.0075, lr_0 = 6.3096e-04
Validation auc = 0.721671
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.263895
Epoch 11
Loss = 2.2501e-02, PNorm = 37.7234, GNorm = 0.0331, lr_0 = 6.1600e-04
Loss = 3.9357e-02, PNorm = 37.7387, GNorm = 0.4537, lr_0 = 6.0140e-04
Loss = 2.9919e-01, PNorm = 37.7370, GNorm = 6.6873, lr_0 = 5.9996e-04
Validation auc = 0.743575
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.266821
Epoch 12
Loss = 4.2499e-02, PNorm = 37.7405, GNorm = 0.0751, lr_0 = 5.8574e-04
Loss = 3.0859e-02, PNorm = 37.7675, GNorm = 0.5531, lr_0 = 5.7186e-04
Validation auc = 0.709404
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.272914
Epoch 13
Loss = 4.6689e-02, PNorm = 37.7832, GNorm = 0.7232, lr_0 = 5.5831e-04
Loss = 2.5270e-02, PNorm = 37.8016, GNorm = 0.0274, lr_0 = 5.4508e-04
Validation auc = 0.726343
Validation accuracy = 0.932432
Validation f1 = 0.210526
Validation binary_cross_entropy = 0.270387
Epoch 14
Loss = 2.5538e-02, PNorm = 37.8190, GNorm = 0.6354, lr_0 = 5.3088e-04
Loss = 2.7890e-02, PNorm = 37.8234, GNorm = 0.0163, lr_0 = 5.1830e-04
Validation auc = 0.734521
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.275393
Epoch 15
Loss = 2.0798e-02, PNorm = 37.8353, GNorm = 0.7479, lr_0 = 5.0481e-04
Loss = 3.2403e-02, PNorm = 37.8462, GNorm = 1.0680, lr_0 = 4.9284e-04
Validation auc = 0.747956
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.270670
Epoch 16
Loss = 1.3801e-02, PNorm = 37.8584, GNorm = 0.3217, lr_0 = 4.8001e-04
Loss = 3.4852e-02, PNorm = 37.8657, GNorm = 0.4577, lr_0 = 4.6863e-04
Validation auc = 0.739778
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.268240
Epoch 17
Loss = 2.3794e-02, PNorm = 37.8722, GNorm = 0.6705, lr_0 = 4.5643e-04
Loss = 2.9457e-02, PNorm = 37.8790, GNorm = 0.0199, lr_0 = 4.4561e-04
Validation auc = 0.743283
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.272764
Epoch 18
Loss = 2.1769e-02, PNorm = 37.8848, GNorm = 0.5994, lr_0 = 4.3401e-04
Loss = 2.7162e-02, PNorm = 37.8941, GNorm = 0.5568, lr_0 = 4.2372e-04
Validation auc = 0.745619
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.275289
Epoch 19
Loss = 2.0958e-02, PNorm = 37.9084, GNorm = 0.5517, lr_0 = 4.1269e-04
Loss = 2.6723e-02, PNorm = 37.9108, GNorm = 0.5557, lr_0 = 4.0291e-04
Validation auc = 0.744451
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.273041
Epoch 20
Loss = 1.5859e-02, PNorm = 37.9139, GNorm = 0.5865, lr_0 = 3.9242e-04
Loss = 2.7259e-02, PNorm = 37.9214, GNorm = 0.5978, lr_0 = 3.8312e-04
Validation auc = 0.740362
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.278661
Epoch 21
Loss = 2.0422e-02, PNorm = 37.9260, GNorm = 0.4482, lr_0 = 3.7314e-04
Loss = 2.8939e-02, PNorm = 37.9333, GNorm = 0.3315, lr_0 = 3.6430e-04
Validation auc = 0.747371
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.279053
Epoch 22
Loss = 1.3965e-02, PNorm = 37.9432, GNorm = 0.6619, lr_0 = 3.5481e-04
Loss = 2.8563e-02, PNorm = 37.9477, GNorm = 0.4588, lr_0 = 3.4640e-04
Validation auc = 0.750292
Validation accuracy = 0.932432
Validation f1 = 0.210526
Validation binary_cross_entropy = 0.277437
Epoch 23
Loss = 2.4592e-02, PNorm = 37.9569, GNorm = 0.6964, lr_0 = 3.3738e-04
Loss = 2.2040e-02, PNorm = 37.9615, GNorm = 0.5618, lr_0 = 3.2939e-04
Validation auc = 0.748540
Validation accuracy = 0.932432
Validation f1 = 0.210526
Validation binary_cross_entropy = 0.278460
Epoch 24
Loss = 2.9587e-02, PNorm = 37.9660, GNorm = 0.7250, lr_0 = 3.2081e-04
Loss = 1.7473e-02, PNorm = 37.9732, GNorm = 0.4730, lr_0 = 3.1321e-04
Validation auc = 0.745911
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.279756
Epoch 25
Loss = 2.7597e-02, PNorm = 37.9765, GNorm = 0.5866, lr_0 = 3.0579e-04
Loss = 1.8474e-02, PNorm = 37.9857, GNorm = 0.0159, lr_0 = 2.9854e-04
Validation auc = 0.746203
Validation accuracy = 0.941441
Validation f1 = 0.235294
Validation binary_cross_entropy = 0.278428
Epoch 26
Loss = 1.5139e-02, PNorm = 37.9913, GNorm = 0.4197, lr_0 = 2.9076e-04
Loss = 2.7977e-02, PNorm = 37.9955, GNorm = 0.9103, lr_0 = 2.8387e-04
Validation auc = 0.747079
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.281925
Epoch 27
Loss = 2.7435e-02, PNorm = 37.9981, GNorm = 0.7560, lr_0 = 2.7648e-04
Loss = 1.4419e-02, PNorm = 38.0023, GNorm = 0.0119, lr_0 = 2.6993e-04
Validation auc = 0.751752
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.284364
Epoch 28
Loss = 2.2686e-02, PNorm = 38.0104, GNorm = 0.0149, lr_0 = 2.6290e-04
Loss = 2.3472e-02, PNorm = 38.0141, GNorm = 0.0095, lr_0 = 2.5667e-04
Validation auc = 0.753505
Validation accuracy = 0.932432
Validation f1 = 0.210526
Validation binary_cross_entropy = 0.283019
Epoch 29
Loss = 1.5103e-02, PNorm = 38.0201, GNorm = 0.4011, lr_0 = 2.4999e-04
Loss = 2.9043e-02, PNorm = 38.0258, GNorm = 0.9108, lr_0 = 2.4406e-04
Validation auc = 0.754673
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.280970
Epoch 30
Loss = 2.1313e-02, PNorm = 38.0353, GNorm = 0.6541, lr_0 = 2.3771e-04
Loss = 2.5073e-02, PNorm = 38.0374, GNorm = 0.8314, lr_0 = 2.3207e-04
Validation auc = 0.750584
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.282546
Epoch 31
Loss = 1.2306e-02, PNorm = 38.0344, GNorm = 0.4121, lr_0 = 2.2603e-04
Loss = 3.1322e-02, PNorm = 38.0409, GNorm = 0.3101, lr_0 = 2.2067e-04
Validation auc = 0.759054
Validation accuracy = 0.932432
Validation f1 = 0.285714
Validation binary_cross_entropy = 0.284130
Epoch 32
Loss = 2.7125e-02, PNorm = 38.0508, GNorm = 0.4839, lr_0 = 2.1493e-04
Loss = 1.8871e-02, PNorm = 38.0540, GNorm = 0.1565, lr_0 = 2.0983e-04
Validation auc = 0.755257
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.283903
Epoch 33
Loss = 1.8700e-02, PNorm = 38.0567, GNorm = 0.4769, lr_0 = 2.0437e-04
Loss = 1.9990e-02, PNorm = 38.0609, GNorm = 0.4892, lr_0 = 1.9953e-04
Validation auc = 0.762266
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.286093
Epoch 34
Loss = 2.2116e-02, PNorm = 38.0644, GNorm = 0.0097, lr_0 = 1.9433e-04
Loss = 2.1903e-02, PNorm = 38.0693, GNorm = 0.4743, lr_0 = 1.8973e-04
Validation auc = 0.760806
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.286733
Epoch 35
Loss = 1.7604e-02, PNorm = 38.0745, GNorm = 0.0116, lr_0 = 1.8478e-04
Loss = 2.5241e-02, PNorm = 38.0800, GNorm = 0.0155, lr_0 = 1.8041e-04
Validation auc = 0.762850
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.284132
Epoch 36
Loss = 1.8133e-02, PNorm = 38.0836, GNorm = 0.3867, lr_0 = 1.7571e-04
Loss = 2.5204e-02, PNorm = 38.0831, GNorm = 0.5976, lr_0 = 1.7154e-04
Validation auc = 0.763435
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.287568
Epoch 37
Loss = 1.6270e-02, PNorm = 38.0841, GNorm = 0.5116, lr_0 = 1.6708e-04
Loss = 1.8525e-02, PNorm = 38.0888, GNorm = 0.4395, lr_0 = 1.6312e-04
Validation auc = 0.766939
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.288245
Epoch 38
Loss = 9.5483e-03, PNorm = 38.0955, GNorm = 0.2358, lr_0 = 1.5925e-04
Loss = 2.3470e-02, PNorm = 38.1021, GNorm = 0.2314, lr_0 = 1.5548e-04
Validation auc = 0.766355
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.285224
Epoch 39
Loss = 1.6765e-02, PNorm = 38.1066, GNorm = 0.4841, lr_0 = 1.5143e-04
Loss = 2.2659e-02, PNorm = 38.1075, GNorm = 0.0077, lr_0 = 1.4784e-04
Validation auc = 0.767815
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.288303
Epoch 40
Loss = 2.5916e-02, PNorm = 38.1131, GNorm = 0.0041, lr_0 = 1.4399e-04
Loss = 2.1188e-02, PNorm = 38.1149, GNorm = 0.7682, lr_0 = 1.4058e-04
Validation auc = 0.767231
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.287091
Epoch 41
Loss = 1.7630e-02, PNorm = 38.1149, GNorm = 0.3197, lr_0 = 1.3692e-04
Loss = 2.3216e-02, PNorm = 38.1185, GNorm = 0.5783, lr_0 = 1.3367e-04
Validation auc = 0.770152
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.288775
Epoch 42
Loss = 2.4259e-02, PNorm = 38.1197, GNorm = 0.4432, lr_0 = 1.3019e-04
Loss = 1.9600e-02, PNorm = 38.1228, GNorm = 0.0105, lr_0 = 1.2711e-04
Validation auc = 0.766063
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.290134
Epoch 43
Loss = 1.6763e-02, PNorm = 38.1262, GNorm = 0.3644, lr_0 = 1.2380e-04
Loss = 1.8538e-02, PNorm = 38.1304, GNorm = 0.2270, lr_0 = 1.2086e-04
Validation auc = 0.771904
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.288210
Epoch 44
Loss = 1.9288e-02, PNorm = 38.1310, GNorm = 0.3824, lr_0 = 1.1772e-04
Loss = 1.8103e-02, PNorm = 38.1330, GNorm = 0.7008, lr_0 = 1.1493e-04
Validation auc = 0.772196
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.290046
Epoch 45
Loss = 1.8774e-02, PNorm = 38.1355, GNorm = 0.5477, lr_0 = 1.1193e-04
Loss = 1.7548e-02, PNorm = 38.1389, GNorm = 0.4240, lr_0 = 1.0928e-04
Validation auc = 0.770736
Validation accuracy = 0.936937
Validation f1 = 0.300000
Validation binary_cross_entropy = 0.291401
Epoch 46
Loss = 1.4759e-02, PNorm = 38.1431, GNorm = 0.5382, lr_0 = 1.0643e-04
Loss = 2.0454e-02, PNorm = 38.1449, GNorm = 0.5974, lr_0 = 1.0391e-04
Validation auc = 0.776577
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.289425
Epoch 47
Loss = 2.8520e-02, PNorm = 38.1466, GNorm = 0.7634, lr_0 = 1.0121e-04
Loss = 1.4408e-02, PNorm = 38.1477, GNorm = 0.6450, lr_0 = 1.0000e-04
Validation auc = 0.774825
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.290140
Epoch 48
Loss = 2.8112e-02, PNorm = 38.1497, GNorm = 0.3701, lr_0 = 1.0000e-04
Loss = 1.4397e-02, PNorm = 38.1512, GNorm = 0.0971, lr_0 = 1.0000e-04
Validation auc = 0.778329
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.290003
Epoch 49
Loss = 1.8674e-02, PNorm = 38.1549, GNorm = 0.0113, lr_0 = 1.0000e-04
Loss = 2.2584e-02, PNorm = 38.1573, GNorm = 1.0021, lr_0 = 1.0000e-04
Validation auc = 0.774825
Validation accuracy = 0.936937
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.290171
Model 0 best validation auc = 0.778329 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.800557
Model 0 test accuracy = 0.924603
Model 0 test f1 = 0.173913
Model 0 test binary_cross_entropy = 0.405923
Ensemble test auc = 0.800557
Ensemble test accuracy = 0.924603
Ensemble test f1 = 0.173913
Ensemble test binary_cross_entropy = 0.405923
Fold 3
Splitting data with seed 3
Class sizes
CT_TOX 0: 91.72%, 1: 8.28%
Total size = 1,256 | train size = 1,004 | val size = 222 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 5.9909e-01, PNorm = 37.2519, GNorm = 4.0687, lr_0 = 3.4750e-04
Loss = 3.9172e-01, PNorm = 37.2759, GNorm = 2.0077, lr_0 = 5.7250e-04
Loss = 5.9235e-02, PNorm = 37.2778, GNorm = 2.0381, lr_0 = 5.9500e-04
Validation auc = 0.488610
Validation accuracy = 0.954955
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.210063
Epoch 1
Loss = 1.2869e-01, PNorm = 37.3069, GNorm = 0.8123, lr_0 = 8.2000e-04
Loss = 1.2585e-01, PNorm = 37.3612, GNorm = 0.7925, lr_0 = 9.9521e-04
Loss = 9.6595e-03, PNorm = 37.3662, GNorm = 0.1713, lr_0 = 9.9283e-04
Validation auc = 0.711741
Validation accuracy = 0.932432
Validation f1 = 0.117647
Validation binary_cross_entropy = 0.217382
Epoch 2
Loss = 6.2992e-02, PNorm = 37.4043, GNorm = 0.3973, lr_0 = 9.6930e-04
Loss = 6.8952e-02, PNorm = 37.4323, GNorm = 0.2152, lr_0 = 9.4633e-04
Loss = 2.8622e-02, PNorm = 37.4362, GNorm = 0.8189, lr_0 = 9.4406e-04
Validation auc = 0.781834
Validation accuracy = 0.909910
Validation f1 = 0.166667
Validation binary_cross_entropy = 0.264692
Epoch 3
Loss = 2.1873e-02, PNorm = 37.4712, GNorm = 0.3487, lr_0 = 9.2169e-04
Loss = 7.9014e-02, PNorm = 37.4788, GNorm = 0.4295, lr_0 = 8.9984e-04
Loss = 1.2299e-02, PNorm = 37.4798, GNorm = 0.2820, lr_0 = 8.9769e-04
Validation auc = 0.792348
Validation accuracy = 0.914414
Validation f1 = 0.173913
Validation binary_cross_entropy = 0.255989
Epoch 4
Loss = 3.1942e-02, PNorm = 37.5081, GNorm = 0.0410, lr_0 = 8.7641e-04
Loss = 5.0488e-02, PNorm = 37.5224, GNorm = 0.8932, lr_0 = 8.5564e-04
Loss = 3.1586e-03, PNorm = 37.5236, GNorm = 0.0883, lr_0 = 8.5359e-04
Validation auc = 0.805783
Validation accuracy = 0.918919
Validation f1 = 0.100000
Validation binary_cross_entropy = 0.257907
Epoch 5
Loss = 2.4630e-02, PNorm = 37.5398, GNorm = 0.7659, lr_0 = 8.3336e-04
Loss = 7.0233e-02, PNorm = 37.5569, GNorm = 0.8257, lr_0 = 8.1361e-04
Loss = 1.0203e-03, PNorm = 37.5578, GNorm = 0.0315, lr_0 = 8.1166e-04
Validation auc = 0.797605
Validation accuracy = 0.932432
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.237112
Epoch 6
Loss = 3.2242e-02, PNorm = 37.5616, GNorm = 0.0466, lr_0 = 7.9243e-04
Loss = 4.1974e-02, PNorm = 37.5852, GNorm = 1.2761, lr_0 = 7.7364e-04
Loss = 3.1710e-04, PNorm = 37.5884, GNorm = 0.0063, lr_0 = 7.7179e-04
Validation auc = 0.797897
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.226308
Epoch 7
Loss = 3.7951e-02, PNorm = 37.5982, GNorm = 0.0313, lr_0 = 7.5350e-04
Loss = 3.6572e-02, PNorm = 37.6063, GNorm = 0.9299, lr_0 = 7.3564e-04
Loss = 3.1928e-01, PNorm = 37.6106, GNorm = 8.0487, lr_0 = 7.3388e-04
Validation auc = 0.818049
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.248921
Epoch 8
Loss = 2.5332e-02, PNorm = 37.6474, GNorm = 0.0359, lr_0 = 7.1649e-04
Loss = 3.4182e-02, PNorm = 37.6665, GNorm = 0.0436, lr_0 = 6.9951e-04
Loss = 3.7226e-04, PNorm = 37.6679, GNorm = 0.0130, lr_0 = 6.9783e-04
Validation auc = 0.707068
Validation accuracy = 0.936937
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.275261
Epoch 9
Loss = 5.8708e-02, PNorm = 37.6684, GNorm = 0.5827, lr_0 = 6.8129e-04
Loss = 3.6406e-02, PNorm = 37.6785, GNorm = 0.7065, lr_0 = 6.6515e-04
Loss = 1.0850e-02, PNorm = 37.6806, GNorm = 0.3335, lr_0 = 6.6355e-04
Validation auc = 0.715829
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.282535
Epoch 10
Loss = 5.2023e-02, PNorm = 37.6947, GNorm = 0.7077, lr_0 = 6.4783e-04
Loss = 3.3728e-02, PNorm = 37.7031, GNorm = 0.0294, lr_0 = 6.3247e-04
Loss = 2.8535e-03, PNorm = 37.7033, GNorm = 0.0948, lr_0 = 6.3096e-04
Validation auc = 0.761974
Validation accuracy = 0.927928
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.266667
Epoch 11
Loss = 2.2888e-02, PNorm = 37.7069, GNorm = 0.0626, lr_0 = 6.1600e-04
Loss = 6.1605e-02, PNorm = 37.7288, GNorm = 1.3918, lr_0 = 6.0140e-04
Loss = 8.7906e-03, PNorm = 37.7299, GNorm = 0.2305, lr_0 = 5.9996e-04
Validation auc = 0.780666
Validation accuracy = 0.927928
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.265641
Epoch 12
Loss = 3.4313e-02, PNorm = 37.7344, GNorm = 0.2443, lr_0 = 5.8574e-04
Loss = 3.5031e-02, PNorm = 37.7474, GNorm = 0.0188, lr_0 = 5.7186e-04
Validation auc = 0.800818
Validation accuracy = 0.914414
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.266881
Epoch 13
Loss = 3.6539e-02, PNorm = 37.7569, GNorm = 0.4596, lr_0 = 5.5831e-04
Loss = 3.1416e-02, PNorm = 37.7738, GNorm = 0.5178, lr_0 = 5.4508e-04
Validation auc = 0.808119
Validation accuracy = 0.927928
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246162
Epoch 14
Loss = 3.0056e-02, PNorm = 37.7819, GNorm = 0.0232, lr_0 = 5.3088e-04
Loss = 3.6737e-02, PNorm = 37.7844, GNorm = 0.6867, lr_0 = 5.1830e-04
Validation auc = 0.823890
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.267448
Epoch 15
Loss = 1.4516e-02, PNorm = 37.8023, GNorm = 0.4318, lr_0 = 5.0481e-04
Loss = 4.5083e-02, PNorm = 37.8113, GNorm = 1.6936, lr_0 = 4.9284e-04
Validation auc = 0.819509
Validation accuracy = 0.909910
Validation f1 = 0.166667
Validation binary_cross_entropy = 0.269074
Epoch 16
Loss = 2.7098e-02, PNorm = 37.8286, GNorm = 0.4726, lr_0 = 4.8001e-04
Loss = 2.2670e-02, PNorm = 37.8292, GNorm = 0.2632, lr_0 = 4.6863e-04
Validation auc = 0.823598
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.256279
Epoch 17
Loss = 1.9708e-02, PNorm = 37.8387, GNorm = 0.0314, lr_0 = 4.5643e-04
Loss = 4.2110e-02, PNorm = 37.8472, GNorm = 0.6646, lr_0 = 4.4561e-04
Validation auc = 0.822430
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.253689
Epoch 18
Loss = 2.5365e-02, PNorm = 37.8555, GNorm = 0.2662, lr_0 = 4.3401e-04
Loss = 2.6905e-02, PNorm = 37.8645, GNorm = 0.0237, lr_0 = 4.2372e-04
Validation auc = 0.816881
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.257830
Epoch 19
Loss = 1.7357e-02, PNorm = 37.8769, GNorm = 0.0110, lr_0 = 4.1269e-04
Loss = 3.5241e-02, PNorm = 37.8806, GNorm = 0.7076, lr_0 = 4.0291e-04
Validation auc = 0.822722
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.259081
Epoch 20
Loss = 1.5969e-02, PNorm = 37.8808, GNorm = 0.3109, lr_0 = 3.9242e-04
Loss = 2.1756e-02, PNorm = 37.8913, GNorm = 0.4589, lr_0 = 3.8312e-04
Validation auc = 0.823014
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.263664
Epoch 21
Loss = 1.8726e-02, PNorm = 37.9124, GNorm = 0.3355, lr_0 = 3.7314e-04
Loss = 3.3680e-02, PNorm = 37.9103, GNorm = 0.7240, lr_0 = 3.6430e-04
Validation auc = 0.824474
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.265229
Epoch 22
Loss = 1.9989e-02, PNorm = 37.9123, GNorm = 0.1850, lr_0 = 3.5481e-04
Loss = 2.5319e-02, PNorm = 37.9226, GNorm = 0.4518, lr_0 = 3.4640e-04
Validation auc = 0.822722
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.262793
Epoch 23
Loss = 2.0065e-02, PNorm = 37.9376, GNorm = 0.5014, lr_0 = 3.3738e-04
Loss = 2.2894e-02, PNorm = 37.9436, GNorm = 0.0145, lr_0 = 3.2939e-04
Validation auc = 0.820970
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.259933
Epoch 24
Loss = 2.2425e-02, PNorm = 37.9465, GNorm = 0.0261, lr_0 = 3.2081e-04
Loss = 2.2670e-02, PNorm = 37.9518, GNorm = 0.0224, lr_0 = 3.1321e-04
Validation auc = 0.826227
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.269370
Epoch 25
Loss = 2.2369e-02, PNorm = 37.9569, GNorm = 1.0293, lr_0 = 3.0579e-04
Loss = 2.4938e-02, PNorm = 37.9663, GNorm = 0.6576, lr_0 = 2.9854e-04
Validation auc = 0.820093
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.264986
Epoch 26
Loss = 1.5081e-02, PNorm = 37.9743, GNorm = 0.6524, lr_0 = 2.9076e-04
Loss = 2.6891e-02, PNorm = 37.9786, GNorm = 1.0257, lr_0 = 2.8387e-04
Validation auc = 0.823306
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.267543
Epoch 27
Loss = 1.8749e-02, PNorm = 37.9888, GNorm = 0.3599, lr_0 = 2.7648e-04
Loss = 2.0073e-02, PNorm = 37.9958, GNorm = 0.1370, lr_0 = 2.6993e-04
Validation auc = 0.823598
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.265070
Epoch 28
Loss = 1.8692e-02, PNorm = 37.9948, GNorm = 0.0112, lr_0 = 2.6290e-04
Loss = 2.6155e-02, PNorm = 38.0017, GNorm = 0.5179, lr_0 = 2.5667e-04
Validation auc = 0.828855
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.271639
Epoch 29
Loss = 1.6285e-02, PNorm = 38.0091, GNorm = 0.6357, lr_0 = 2.4999e-04
Loss = 2.3171e-02, PNorm = 38.0157, GNorm = 0.9245, lr_0 = 2.4406e-04
Validation auc = 0.829731
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.271507
Epoch 30
Loss = 1.0411e-02, PNorm = 38.0170, GNorm = 0.0117, lr_0 = 2.3771e-04
Loss = 2.4164e-02, PNorm = 38.0240, GNorm = 0.0124, lr_0 = 2.3207e-04
Validation auc = 0.829439
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.269011
Epoch 31
Loss = 1.8976e-02, PNorm = 38.0376, GNorm = 0.4659, lr_0 = 2.2603e-04
Loss = 2.1567e-02, PNorm = 38.0413, GNorm = 1.0229, lr_0 = 2.2067e-04
Validation auc = 0.829731
Validation accuracy = 0.923423
Validation f1 = 0.105263
Validation binary_cross_entropy = 0.266899
Epoch 32
Loss = 2.0164e-02, PNorm = 38.0356, GNorm = 0.2718, lr_0 = 2.1493e-04
Loss = 2.4777e-02, PNorm = 38.0464, GNorm = 0.4367, lr_0 = 2.0983e-04
Validation auc = 0.839661
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.286167
Epoch 33
Loss = 1.5072e-02, PNorm = 38.0608, GNorm = 0.3378, lr_0 = 2.0437e-04
Loss = 2.5031e-02, PNorm = 38.0713, GNorm = 0.5812, lr_0 = 1.9953e-04
Validation auc = 0.843750
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.272984
Epoch 34
Loss = 3.1394e-02, PNorm = 38.0838, GNorm = 0.3714, lr_0 = 1.9433e-04
Loss = 1.3457e-02, PNorm = 38.0868, GNorm = 0.0166, lr_0 = 1.8973e-04
Validation auc = 0.840245
Validation accuracy = 0.927928
Validation f1 = 0.200000
Validation binary_cross_entropy = 0.266332
Epoch 35
Loss = 3.0679e-02, PNorm = 38.0874, GNorm = 0.6771, lr_0 = 1.8478e-04
Loss = 1.3638e-02, PNorm = 38.0876, GNorm = 0.0134, lr_0 = 1.8041e-04
Validation auc = 0.840829
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.280114
Epoch 36
Loss = 1.3339e-02, PNorm = 38.0935, GNorm = 0.5223, lr_0 = 1.7571e-04
Loss = 2.8543e-02, PNorm = 38.1002, GNorm = 0.6187, lr_0 = 1.7154e-04
Validation auc = 0.840537
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.273788
Epoch 37
Loss = 1.7061e-02, PNorm = 38.1093, GNorm = 0.5599, lr_0 = 1.6708e-04
Loss = 1.5751e-02, PNorm = 38.1121, GNorm = 0.0145, lr_0 = 1.6312e-04
Validation auc = 0.839661
Validation accuracy = 0.927928
Validation f1 = 0.200000
Validation binary_cross_entropy = 0.269716
Epoch 38
Loss = 1.9052e-02, PNorm = 38.1041, GNorm = 0.7279, lr_0 = 1.5925e-04
Loss = 1.5557e-02, PNorm = 38.1085, GNorm = 0.0213, lr_0 = 1.5548e-04
Validation auc = 0.839077
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.283263
Epoch 39
Loss = 1.7644e-02, PNorm = 38.1148, GNorm = 0.0147, lr_0 = 1.5143e-04
Loss = 2.7522e-02, PNorm = 38.1220, GNorm = 0.4727, lr_0 = 1.4784e-04
Validation auc = 0.835572
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.271011
Epoch 40
Loss = 3.0573e-02, PNorm = 38.1396, GNorm = 0.1971, lr_0 = 1.4399e-04
Loss = 1.4797e-02, PNorm = 38.1461, GNorm = 0.0151, lr_0 = 1.4058e-04
Validation auc = 0.838493
Validation accuracy = 0.927928
Validation f1 = 0.200000
Validation binary_cross_entropy = 0.257595
Epoch 41
Loss = 2.6708e-02, PNorm = 38.1448, GNorm = 0.6770, lr_0 = 1.3692e-04
Loss = 2.5261e-02, PNorm = 38.1437, GNorm = 0.0093, lr_0 = 1.3367e-04
Validation auc = 0.840245
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.268294
Epoch 42
Loss = 3.7060e-02, PNorm = 38.1515, GNorm = 0.7040, lr_0 = 1.3019e-04
Loss = 3.0626e-02, PNorm = 38.1549, GNorm = 0.4592, lr_0 = 1.2711e-04
Validation auc = 0.841121
Validation accuracy = 0.927928
Validation f1 = 0.200000
Validation binary_cross_entropy = 0.267409
Epoch 43
Loss = 2.3444e-02, PNorm = 38.1559, GNorm = 0.0067, lr_0 = 1.2380e-04
Loss = 2.5015e-02, PNorm = 38.1563, GNorm = 0.4343, lr_0 = 1.2086e-04
Validation auc = 0.841706
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.271764
Epoch 44
Loss = 2.1602e-02, PNorm = 38.1576, GNorm = 0.6413, lr_0 = 1.1772e-04
Loss = 2.4593e-02, PNorm = 38.1577, GNorm = 0.3689, lr_0 = 1.1493e-04
Validation auc = 0.839077
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.275886
Epoch 45
Loss = 1.2782e-02, PNorm = 38.1616, GNorm = 0.3808, lr_0 = 1.1193e-04
Loss = 3.3585e-02, PNorm = 38.1644, GNorm = 0.5482, lr_0 = 1.0928e-04
Validation auc = 0.838785
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.271799
Epoch 46
Loss = 2.8432e-02, PNorm = 38.1640, GNorm = 0.0128, lr_0 = 1.0643e-04
Loss = 1.6181e-02, PNorm = 38.1657, GNorm = 0.0072, lr_0 = 1.0391e-04
Validation auc = 0.839369
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.276207
Epoch 47
Loss = 1.4709e-02, PNorm = 38.1686, GNorm = 0.3841, lr_0 = 1.0121e-04
Loss = 1.6705e-02, PNorm = 38.1706, GNorm = 0.3353, lr_0 = 1.0000e-04
Validation auc = 0.837909
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.274094
Epoch 48
Loss = 1.7612e-02, PNorm = 38.1749, GNorm = 0.4538, lr_0 = 1.0000e-04
Loss = 1.7086e-02, PNorm = 38.1764, GNorm = 0.3685, lr_0 = 1.0000e-04
Validation auc = 0.838785
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.275659
Epoch 49
Loss = 2.5796e-02, PNorm = 38.1717, GNorm = 0.1233, lr_0 = 1.0000e-04
Loss = 1.6633e-02, PNorm = 38.1734, GNorm = 0.0151, lr_0 = 1.0000e-04
Validation auc = 0.836741
Validation accuracy = 0.918919
Validation f1 = 0.181818
Validation binary_cross_entropy = 0.285502
Model 0 best validation auc = 0.843750 on epoch 33
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.784052
Model 0 test accuracy = 0.896825
Model 0 test f1 = 0.187500
Model 0 test binary_cross_entropy = 0.457315
Ensemble test auc = 0.784052
Ensemble test accuracy = 0.896825
Ensemble test f1 = 0.187500
Ensemble test binary_cross_entropy = 0.457315
Fold 4
Splitting data with seed 4
Class sizes
CT_TOX 0: 91.72%, 1: 8.28%
Total size = 1,256 | train size = 1,004 | val size = 222 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 5.8628e-01, PNorm = 37.2527, GNorm = 2.6331, lr_0 = 3.4750e-04
Loss = 3.9764e-01, PNorm = 37.2804, GNorm = 2.2898, lr_0 = 5.7250e-04
Loss = 9.8141e-01, PNorm = 37.2780, GNorm = 15.4955, lr_0 = 5.9500e-04
Validation auc = 0.509930
Validation accuracy = 0.950450
Validation f1 = 0.153846
Validation binary_cross_entropy = 0.210522
Epoch 1
Loss = 1.7172e-01, PNorm = 37.3049, GNorm = 1.3080, lr_0 = 8.2000e-04
Loss = 1.7211e-01, PNorm = 37.4037, GNorm = 2.0613, lr_0 = 9.9521e-04
Loss = 2.6813e-02, PNorm = 37.4116, GNorm = 1.1393, lr_0 = 9.9283e-04
Validation auc = 0.562792
Validation accuracy = 0.923423
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.267788
Epoch 2
Loss = 6.3163e-02, PNorm = 37.4552, GNorm = 1.3745, lr_0 = 9.6930e-04
Loss = 5.9112e-02, PNorm = 37.4946, GNorm = 0.2834, lr_0 = 9.4633e-04
Loss = 2.0653e-03, PNorm = 37.4978, GNorm = 0.0505, lr_0 = 9.4406e-04
Validation auc = 0.618575
Validation accuracy = 0.909910
Validation f1 = 0.166667
Validation binary_cross_entropy = 0.372040
Epoch 3
Loss = 2.6994e-02, PNorm = 37.5296, GNorm = 0.9511, lr_0 = 9.2169e-04
Loss = 5.6685e-02, PNorm = 37.5609, GNorm = 0.1783, lr_0 = 8.9984e-04
Loss = 1.6691e-04, PNorm = 37.5631, GNorm = 0.0068, lr_0 = 8.9769e-04
Validation auc = 0.627921
Validation accuracy = 0.927928
Validation f1 = 0.111111
Validation binary_cross_entropy = 0.291472
Epoch 4
Loss = 4.3212e-02, PNorm = 37.5737, GNorm = 1.6195, lr_0 = 8.7641e-04
Loss = 2.7919e-02, PNorm = 37.5739, GNorm = 0.4130, lr_0 = 8.5564e-04
Loss = 5.0556e-03, PNorm = 37.5751, GNorm = 0.1391, lr_0 = 8.5359e-04
Validation auc = 0.673773
Validation accuracy = 0.905405
Validation f1 = 0.222222
Validation binary_cross_entropy = 0.372992
Epoch 5
Loss = 3.4490e-02, PNorm = 37.6032, GNorm = 0.0281, lr_0 = 8.3336e-04
Loss = 4.6953e-02, PNorm = 37.6264, GNorm = 1.3351, lr_0 = 8.1361e-04
Loss = 3.0037e-02, PNorm = 37.6258, GNorm = 1.2398, lr_0 = 8.1166e-04
Validation auc = 0.672897
Validation accuracy = 0.918919
Validation f1 = 0.100000
Validation binary_cross_entropy = 0.302267
Epoch 6
Loss = 3.3819e-02, PNorm = 37.6290, GNorm = 0.0334, lr_0 = 7.9243e-04
Loss = 3.7897e-02, PNorm = 37.6483, GNorm = 0.0446, lr_0 = 7.7364e-04
Loss = 2.9738e-03, PNorm = 37.6508, GNorm = 0.0864, lr_0 = 7.7179e-04
Validation auc = 0.672605
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.315077
Epoch 7
Loss = 2.2193e-02, PNorm = 37.6661, GNorm = 1.2043, lr_0 = 7.5350e-04
Loss = 2.8896e-02, PNorm = 37.6815, GNorm = 0.0611, lr_0 = 7.3564e-04
Loss = 2.2132e-03, PNorm = 37.6832, GNorm = 0.0385, lr_0 = 7.3388e-04
Validation auc = 0.673189
Validation accuracy = 0.909910
Validation f1 = 0.090909
Validation binary_cross_entropy = 0.322285
Epoch 8
Loss = 2.1610e-02, PNorm = 37.6881, GNorm = 0.5050, lr_0 = 7.1649e-04
Loss = 2.8316e-02, PNorm = 37.6999, GNorm = 0.7126, lr_0 = 6.9951e-04
Loss = 1.8047e-03, PNorm = 37.7018, GNorm = 0.0345, lr_0 = 6.9783e-04
Validation auc = 0.674065
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.311974
Epoch 9
Loss = 1.4176e-02, PNorm = 37.7158, GNorm = 0.0095, lr_0 = 6.8129e-04
Loss = 3.9745e-02, PNorm = 37.7155, GNorm = 1.2093, lr_0 = 6.6515e-04
Loss = 8.7936e-03, PNorm = 37.7169, GNorm = 0.1826, lr_0 = 6.6355e-04
Validation auc = 0.680783
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.324654
Epoch 10
Loss = 9.8861e-03, PNorm = 37.7301, GNorm = 0.3546, lr_0 = 6.4783e-04
Loss = 3.3251e-02, PNorm = 37.7408, GNorm = 0.0335, lr_0 = 6.3247e-04
Loss = 1.6564e-02, PNorm = 37.7410, GNorm = 0.8763, lr_0 = 6.3096e-04
Validation auc = 0.684287
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.320396
Epoch 11
Loss = 2.2469e-02, PNorm = 37.7480, GNorm = 0.7108, lr_0 = 6.1600e-04
Loss = 3.1705e-02, PNorm = 37.7627, GNorm = 0.0101, lr_0 = 6.0140e-04
Loss = 5.3614e-03, PNorm = 37.7636, GNorm = 0.2296, lr_0 = 5.9996e-04
Validation auc = 0.686332
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.317478
Epoch 12
Loss = 1.9852e-02, PNorm = 37.7735, GNorm = 0.4332, lr_0 = 5.8574e-04
Loss = 2.4649e-02, PNorm = 37.7769, GNorm = 0.9916, lr_0 = 5.7186e-04
Validation auc = 0.686040
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.333831
Epoch 13
Loss = 1.2885e-02, PNorm = 37.7801, GNorm = 0.1869, lr_0 = 5.5831e-04
Loss = 3.6727e-02, PNorm = 37.7953, GNorm = 0.8691, lr_0 = 5.4508e-04
Validation auc = 0.679614
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.325135
Epoch 14
Loss = 1.9664e-02, PNorm = 37.8152, GNorm = 0.2238, lr_0 = 5.3088e-04
Loss = 2.5292e-02, PNorm = 37.8143, GNorm = 0.0583, lr_0 = 5.1830e-04
Validation auc = 0.684287
Validation accuracy = 0.914414
Validation f1 = 0.173913
Validation binary_cross_entropy = 0.337301
Epoch 15
Loss = 2.1402e-02, PNorm = 37.8204, GNorm = 0.3867, lr_0 = 5.0481e-04
Loss = 1.9177e-02, PNorm = 37.8330, GNorm = 0.6537, lr_0 = 4.9284e-04
Validation auc = 0.687208
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.325671
Epoch 16
Loss = 1.7173e-02, PNorm = 37.8416, GNorm = 0.6086, lr_0 = 4.8001e-04
Loss = 2.2785e-02, PNorm = 37.8454, GNorm = 0.0144, lr_0 = 4.6863e-04
Validation auc = 0.683703
Validation accuracy = 0.914414
Validation f1 = 0.240000
Validation binary_cross_entropy = 0.348221
Epoch 17
Loss = 1.9519e-02, PNorm = 37.8510, GNorm = 0.8854, lr_0 = 4.5643e-04
Loss = 2.0154e-02, PNorm = 37.8651, GNorm = 0.5599, lr_0 = 4.4561e-04
Validation auc = 0.679030
Validation accuracy = 0.927928
Validation f1 = 0.200000
Validation binary_cross_entropy = 0.327489
Epoch 18
Loss = 1.2233e-02, PNorm = 37.8764, GNorm = 0.0090, lr_0 = 4.3401e-04
Loss = 2.9879e-02, PNorm = 37.8773, GNorm = 0.4151, lr_0 = 4.2372e-04
Validation auc = 0.688084
Validation accuracy = 0.914414
Validation f1 = 0.173913
Validation binary_cross_entropy = 0.336733
Epoch 19
Loss = 1.9388e-02, PNorm = 37.8801, GNorm = 0.7789, lr_0 = 4.1269e-04
Loss = 1.7920e-02, PNorm = 37.8892, GNorm = 0.6308, lr_0 = 4.0291e-04
Validation auc = 0.689544
Validation accuracy = 0.923423
Validation f1 = 0.190476
Validation binary_cross_entropy = 0.334796
Epoch 20
Loss = 1.7896e-02, PNorm = 37.8903, GNorm = 0.7320, lr_0 = 3.9242e-04
Loss = 2.5831e-02, PNorm = 37.8970, GNorm = 0.4079, lr_0 = 3.8312e-04
Validation auc = 0.680783
Validation accuracy = 0.918919
Validation f1 = 0.250000
Validation binary_cross_entropy = 0.367028
Epoch 21
Loss = 3.0924e-02, PNorm = 37.9156, GNorm = 0.6377, lr_0 = 3.7314e-04
Loss = 2.2548e-02, PNorm = 37.9279, GNorm = 1.1174, lr_0 = 3.6430e-04
Validation auc = 0.676402
Validation accuracy = 0.918919
Validation f1 = 0.250000
Validation binary_cross_entropy = 0.342557
Epoch 22
Loss = 8.4738e-03, PNorm = 37.9368, GNorm = 0.5588, lr_0 = 3.5481e-04
Loss = 3.2724e-02, PNorm = 37.9430, GNorm = 1.0811, lr_0 = 3.4640e-04
Validation auc = 0.680783
Validation accuracy = 0.909910
Validation f1 = 0.230769
Validation binary_cross_entropy = 0.355601
Epoch 23
Loss = 2.4282e-02, PNorm = 37.9499, GNorm = 0.5533, lr_0 = 3.3738e-04
Loss = 1.8730e-02, PNorm = 37.9587, GNorm = 0.0250, lr_0 = 3.2939e-04
Validation auc = 0.689544
Validation accuracy = 0.918919
Validation f1 = 0.250000
Validation binary_cross_entropy = 0.335038
Epoch 24
Loss = 2.3643e-02, PNorm = 37.9667, GNorm = 0.6743, lr_0 = 3.2081e-04
Loss = 1.0493e-02, PNorm = 37.9717, GNorm = 0.0063, lr_0 = 3.1321e-04
Validation auc = 0.687792
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.332472
Epoch 25
Loss = 8.6073e-03, PNorm = 37.9754, GNorm = 0.0048, lr_0 = 3.0579e-04
Loss = 2.0985e-02, PNorm = 37.9794, GNorm = 0.0142, lr_0 = 2.9854e-04
Validation auc = 0.687208
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.340219
Epoch 26
Loss = 1.3709e-02, PNorm = 37.9817, GNorm = 1.1423, lr_0 = 2.9076e-04
Loss = 1.8258e-02, PNorm = 37.9879, GNorm = 0.6018, lr_0 = 2.8387e-04
Validation auc = 0.695678
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.338201
Epoch 27
Loss = 2.4361e-02, PNorm = 37.9961, GNorm = 0.4440, lr_0 = 2.7648e-04
Loss = 1.2363e-02, PNorm = 37.9994, GNorm = 0.9949, lr_0 = 2.6993e-04
Validation auc = 0.697138
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.341579
Epoch 28
Loss = 1.1154e-02, PNorm = 38.0038, GNorm = 0.9261, lr_0 = 2.6290e-04
Loss = 2.0887e-02, PNorm = 38.0100, GNorm = 1.1384, lr_0 = 2.5667e-04
Validation auc = 0.698890
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.336843
Epoch 29
Loss = 1.8227e-02, PNorm = 38.0136, GNorm = 1.0036, lr_0 = 2.4999e-04
Loss = 1.3185e-02, PNorm = 38.0188, GNorm = 0.0093, lr_0 = 2.4406e-04
Validation auc = 0.697722
Validation accuracy = 0.914414
Validation f1 = 0.240000
Validation binary_cross_entropy = 0.348216
Epoch 30
Loss = 1.3624e-02, PNorm = 38.0255, GNorm = 0.0107, lr_0 = 2.3771e-04
Loss = 1.3818e-02, PNorm = 38.0306, GNorm = 0.6775, lr_0 = 2.3207e-04
Validation auc = 0.700058
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.336742
Epoch 31
Loss = 9.5943e-03, PNorm = 38.0310, GNorm = 0.3181, lr_0 = 2.2603e-04
Loss = 2.2686e-02, PNorm = 38.0365, GNorm = 0.3229, lr_0 = 2.2067e-04
Validation auc = 0.703563
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.340649
Epoch 32
Loss = 7.5186e-03, PNorm = 38.0436, GNorm = 0.0056, lr_0 = 2.1493e-04
Loss = 2.0645e-02, PNorm = 38.0471, GNorm = 0.0132, lr_0 = 2.0983e-04
Validation auc = 0.704147
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.340328
Epoch 33
Loss = 6.1028e-03, PNorm = 38.0512, GNorm = 0.0126, lr_0 = 2.0437e-04
Loss = 2.1093e-02, PNorm = 38.0546, GNorm = 0.7549, lr_0 = 1.9953e-04
Validation auc = 0.705315
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.341511
Epoch 34
Loss = 1.2151e-02, PNorm = 38.0557, GNorm = 0.0098, lr_0 = 1.9433e-04
Loss = 1.5444e-02, PNorm = 38.0602, GNorm = 0.0149, lr_0 = 1.8973e-04
Validation auc = 0.705315
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.342998
Epoch 35
Loss = 1.0735e-02, PNorm = 38.0652, GNorm = 0.0150, lr_0 = 1.8478e-04
Loss = 1.5363e-02, PNorm = 38.0689, GNorm = 0.4952, lr_0 = 1.8041e-04
Validation auc = 0.704147
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.340198
Epoch 36
Loss = 1.2688e-02, PNorm = 38.0765, GNorm = 0.6640, lr_0 = 1.7571e-04
Loss = 1.1981e-02, PNorm = 38.0812, GNorm = 0.0109, lr_0 = 1.7154e-04
Validation auc = 0.715829
Validation accuracy = 0.927928
Validation f1 = 0.200000
Validation binary_cross_entropy = 0.331316
Epoch 37
Loss = 9.7046e-03, PNorm = 38.0777, GNorm = 0.0478, lr_0 = 1.6708e-04
Loss = 2.1903e-02, PNorm = 38.0763, GNorm = 0.5304, lr_0 = 1.6312e-04
Validation auc = 0.713201
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.351783
Epoch 38
Loss = 1.0432e-02, PNorm = 38.0784, GNorm = 0.0097, lr_0 = 1.5925e-04
Loss = 1.7062e-02, PNorm = 38.0823, GNorm = 0.0065, lr_0 = 1.5548e-04
Validation auc = 0.714661
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.345256
Epoch 39
Loss = 7.5559e-03, PNorm = 38.0942, GNorm = 0.5229, lr_0 = 1.5143e-04
Loss = 3.4855e-02, PNorm = 38.0981, GNorm = 0.3598, lr_0 = 1.4784e-04
Validation auc = 0.706776
Validation accuracy = 0.932432
Validation f1 = 0.210526
Validation binary_cross_entropy = 0.327310
Epoch 40
Loss = 1.0002e-02, PNorm = 38.1004, GNorm = 0.0175, lr_0 = 1.4399e-04
Loss = 3.4473e-02, PNorm = 38.1024, GNorm = 1.3453, lr_0 = 1.4058e-04
Validation auc = 0.711741
Validation accuracy = 0.927928
Validation f1 = 0.200000
Validation binary_cross_entropy = 0.330888
Epoch 41
Loss = 1.4807e-02, PNorm = 38.0997, GNorm = 0.0105, lr_0 = 1.3692e-04
Loss = 3.0798e-02, PNorm = 38.1010, GNorm = 0.5806, lr_0 = 1.3367e-04
Validation auc = 0.715829
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.339438
Epoch 42
Loss = 1.3224e-02, PNorm = 38.1007, GNorm = 0.0042, lr_0 = 1.3019e-04
Loss = 2.7411e-02, PNorm = 38.1021, GNorm = 0.6295, lr_0 = 1.2711e-04
Validation auc = 0.718166
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.343082
Epoch 43
Loss = 9.5479e-03, PNorm = 38.1070, GNorm = 0.0082, lr_0 = 1.2380e-04
Loss = 2.3693e-02, PNorm = 38.1112, GNorm = 0.0079, lr_0 = 1.2086e-04
Validation auc = 0.717582
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.339258
Epoch 44
Loss = 2.7274e-02, PNorm = 38.1116, GNorm = 0.4013, lr_0 = 1.1772e-04
Loss = 7.1386e-03, PNorm = 38.1131, GNorm = 0.0076, lr_0 = 1.1493e-04
Validation auc = 0.720794
Validation accuracy = 0.927928
Validation f1 = 0.272727
Validation binary_cross_entropy = 0.342925
Epoch 45
Loss = 1.7895e-02, PNorm = 38.1153, GNorm = 0.0082, lr_0 = 1.1193e-04
Loss = 2.0171e-02, PNorm = 38.1188, GNorm = 0.8080, lr_0 = 1.0928e-04
Validation auc = 0.722255
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.342412
Epoch 46
Loss = 9.2321e-03, PNorm = 38.1220, GNorm = 0.7889, lr_0 = 1.0643e-04
Loss = 1.8565e-02, PNorm = 38.1240, GNorm = 0.7196, lr_0 = 1.0391e-04
Validation auc = 0.722255
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.343504
Epoch 47
Loss = 1.1248e-02, PNorm = 38.1269, GNorm = 0.4742, lr_0 = 1.0121e-04
Loss = 2.0889e-02, PNorm = 38.1287, GNorm = 0.2763, lr_0 = 1.0000e-04
Validation auc = 0.722839
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.344339
Epoch 48
Loss = 1.1266e-02, PNorm = 38.1302, GNorm = 0.4927, lr_0 = 1.0000e-04
Loss = 1.1737e-02, PNorm = 38.1333, GNorm = 0.0086, lr_0 = 1.0000e-04
Validation auc = 0.723131
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.345984
Epoch 49
Loss = 1.0412e-02, PNorm = 38.1343, GNorm = 0.3862, lr_0 = 1.0000e-04
Loss = 9.9966e-03, PNorm = 38.1363, GNorm = 0.3488, lr_0 = 1.0000e-04
Validation auc = 0.724299
Validation accuracy = 0.923423
Validation f1 = 0.260870
Validation binary_cross_entropy = 0.350169
Model 0 best validation auc = 0.724299 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.816309
Model 0 test accuracy = 0.904762
Model 0 test f1 = 0.400000
Model 0 test binary_cross_entropy = 0.456717
Ensemble test auc = 0.816309
Ensemble test accuracy = 0.904762
Ensemble test f1 = 0.400000
Ensemble test binary_cross_entropy = 0.456717
5-fold cross validation
	Seed 0 ==> test auc = 0.754235
	Seed 0 ==> test accuracy = 0.912698
	Seed 0 ==> test f1 = 0.214286
	Seed 0 ==> test binary_cross_entropy = 0.467996
	Seed 1 ==> test auc = 0.735939
	Seed 1 ==> test accuracy = 0.900794
	Seed 1 ==> test f1 = 0.193548
	Seed 1 ==> test binary_cross_entropy = 0.465021
	Seed 2 ==> test auc = 0.800557
	Seed 2 ==> test accuracy = 0.924603
	Seed 2 ==> test f1 = 0.173913
	Seed 2 ==> test binary_cross_entropy = 0.405923
	Seed 3 ==> test auc = 0.784052
	Seed 3 ==> test accuracy = 0.896825
	Seed 3 ==> test f1 = 0.187500
	Seed 3 ==> test binary_cross_entropy = 0.457315
	Seed 4 ==> test auc = 0.816309
	Seed 4 ==> test accuracy = 0.904762
	Seed 4 ==> test f1 = 0.400000
	Seed 4 ==> test binary_cross_entropy = 0.456717
Overall test auc = 0.778218 +/- 0.029485
Overall test accuracy = 0.907937 +/- 0.009849
Overall test f1 = 0.233849 +/- 0.084088
Overall test binary_cross_entropy = 0.450595 +/- 0.022756
Elapsed time = 0:03:21
