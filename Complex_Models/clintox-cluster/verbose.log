Command line
python /home/ddunstan/.conda/envs/chemprop/bin/chemprop_train --data_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/clintox-cluster-train.csv --dataset_type classification --save_dir /home/ddunstan/Chemistry-Capstone/Complex_Models/clintox-cluster --epochs 50 --extra_metrics accuracy f1 binary_cross_entropy --metric auc --target_columns CT_TOX --smiles_columns smiles --num_folds 5 --split_sizes 0.8 0 0.2 --separate_val_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/clintox-cluster-validate.csv --features_generator morgan
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/clintox-cluster-train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy', 'f1', 'binary_cross_entropy'],
 'features_generator': ['morgan'],
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy', 'f1', 'binary_cross_entropy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/ddunstan/Chemistry-Capstone/Complex_Models/clintox-cluster',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/clintox-cluster-validate.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.0, 0.2],
 'split_type': 'random',
 'target_columns': ['CT_TOX'],
 'target_weights': None,
 'task_names': ['CT_TOX'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
CT_TOX 0: 91.65%, 1: 8.35%
Total size = 1,257 | train size = 1,005 | val size = 221 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.1105e-01, PNorm = 37.2523, GNorm = 2.8527, lr_0 = 3.4750e-04
Loss = 3.9037e-01, PNorm = 37.2788, GNorm = 2.8851, lr_0 = 5.7250e-04
Loss = 8.1336e-02, PNorm = 37.2796, GNorm = 3.0167, lr_0 = 5.9500e-04
Validation auc = 0.328438
Validation accuracy = 0.950226
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.216894
Epoch 1
Loss = 1.4244e-01, PNorm = 37.3109, GNorm = 1.5560, lr_0 = 8.2000e-04
Loss = 1.5299e-01, PNorm = 37.3796, GNorm = 2.3361, lr_0 = 9.9521e-04
Loss = 4.0372e-01, PNorm = 37.3874, GNorm = 11.5845, lr_0 = 9.9283e-04
Validation auc = 0.354473
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.224640
Epoch 2
Loss = 1.1034e-01, PNorm = 37.4283, GNorm = 0.3641, lr_0 = 9.6930e-04
Loss = 1.0827e-01, PNorm = 37.4565, GNorm = 1.4643, lr_0 = 9.4633e-04
Loss = 7.0762e-02, PNorm = 37.4605, GNorm = 1.9375, lr_0 = 9.4406e-04
Validation auc = 0.414553
Validation accuracy = 0.950226
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.220538
Epoch 3
Loss = 6.6040e-02, PNorm = 37.5001, GNorm = 0.4642, lr_0 = 9.2169e-04
Loss = 6.8684e-02, PNorm = 37.5206, GNorm = 0.6441, lr_0 = 8.9984e-04
Loss = 5.6817e-01, PNorm = 37.5184, GNorm = 9.0701, lr_0 = 8.9769e-04
Validation auc = 0.413218
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.219220
Epoch 4
Loss = 5.5892e-02, PNorm = 37.5233, GNorm = 0.2175, lr_0 = 8.7641e-04
Loss = 8.0197e-02, PNorm = 37.5568, GNorm = 1.0347, lr_0 = 8.5564e-04
Loss = 6.6983e-01, PNorm = 37.5566, GNorm = 12.0095, lr_0 = 8.5359e-04
Validation auc = 0.472630
Validation accuracy = 0.950226
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.214625
Epoch 5
Loss = 5.7241e-02, PNorm = 37.5747, GNorm = 0.4612, lr_0 = 8.3336e-04
Loss = 7.4319e-02, PNorm = 37.6185, GNorm = 0.5773, lr_0 = 8.1361e-04
Loss = 1.0969e-02, PNorm = 37.6218, GNorm = 0.2844, lr_0 = 8.1166e-04
Validation auc = 0.443925
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.217443
Epoch 6
Loss = 4.7522e-02, PNorm = 37.6346, GNorm = 0.5619, lr_0 = 7.9243e-04
Loss = 6.7368e-02, PNorm = 37.6473, GNorm = 1.4882, lr_0 = 7.7364e-04
Loss = 1.5325e-03, PNorm = 37.6474, GNorm = 0.0407, lr_0 = 7.7179e-04
Validation auc = 0.421228
Validation accuracy = 0.950226
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229509
Epoch 7
Loss = 3.9683e-02, PNorm = 37.6563, GNorm = 0.4727, lr_0 = 7.5350e-04
Loss = 3.8074e-02, PNorm = 37.6770, GNorm = 1.0981, lr_0 = 7.3564e-04
Loss = 6.9030e-03, PNorm = 37.6794, GNorm = 0.2063, lr_0 = 7.3388e-04
Validation auc = 0.412550
Validation accuracy = 0.950226
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229409
Epoch 8
Loss = 3.3585e-02, PNorm = 37.6972, GNorm = 0.0397, lr_0 = 7.1649e-04
Loss = 4.4088e-02, PNorm = 37.7142, GNorm = 0.7127, lr_0 = 6.9951e-04
Loss = 6.2167e-04, PNorm = 37.7146, GNorm = 0.0186, lr_0 = 6.9783e-04
Validation auc = 0.395194
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.235021
Epoch 9
Loss = 3.5730e-02, PNorm = 37.7157, GNorm = 0.7624, lr_0 = 6.8129e-04
Loss = 3.9630e-02, PNorm = 37.7208, GNorm = 0.8286, lr_0 = 6.6515e-04
Validation auc = 0.406542
Validation accuracy = 0.950226
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.233637
Epoch 10
Loss = 4.4539e-02, PNorm = 37.7360, GNorm = 0.8316, lr_0 = 6.4938e-04
Loss = 1.9794e-02, PNorm = 37.7441, GNorm = 0.2842, lr_0 = 6.3399e-04
Validation auc = 0.394526
Validation accuracy = 0.950226
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.236568
Epoch 11
Loss = 3.7873e-02, PNorm = 37.7552, GNorm = 0.8101, lr_0 = 6.1748e-04
Loss = 2.9795e-02, PNorm = 37.7657, GNorm = 0.5135, lr_0 = 6.0285e-04
Validation auc = 0.405874
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.236933
Epoch 12
Loss = 1.6873e-02, PNorm = 37.7748, GNorm = 0.2911, lr_0 = 5.8715e-04
Loss = 4.4521e-02, PNorm = 37.7823, GNorm = 0.9224, lr_0 = 5.7324e-04
Validation auc = 0.402537
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.240048
Epoch 13
Loss = 2.1768e-02, PNorm = 37.7918, GNorm = 0.4844, lr_0 = 5.5831e-04
Loss = 3.5840e-02, PNorm = 37.8004, GNorm = 0.0221, lr_0 = 5.4508e-04
Validation auc = 0.395861
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.242232
Epoch 14
Loss = 2.8774e-02, PNorm = 37.8028, GNorm = 0.3628, lr_0 = 5.3088e-04
Loss = 3.0044e-02, PNorm = 37.8119, GNorm = 1.0553, lr_0 = 5.1830e-04
Validation auc = 0.400534
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.240710
Epoch 15
Loss = 1.8429e-02, PNorm = 37.8314, GNorm = 0.3052, lr_0 = 5.0481e-04
Loss = 3.6264e-02, PNorm = 37.8308, GNorm = 0.8664, lr_0 = 4.9284e-04
Validation auc = 0.407877
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.241947
Epoch 16
Loss = 1.4319e-02, PNorm = 37.8393, GNorm = 0.4655, lr_0 = 4.8001e-04
Loss = 3.9226e-02, PNorm = 37.8434, GNorm = 0.2970, lr_0 = 4.6863e-04
Validation auc = 0.399866
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.245280
Epoch 17
Loss = 2.7646e-02, PNorm = 37.8479, GNorm = 0.3072, lr_0 = 4.5643e-04
Loss = 2.4364e-02, PNorm = 37.8563, GNorm = 0.3756, lr_0 = 4.4561e-04
Validation auc = 0.407210
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.245852
Epoch 18
Loss = 2.0749e-02, PNorm = 37.8656, GNorm = 0.8744, lr_0 = 4.3401e-04
Loss = 3.3752e-02, PNorm = 37.8727, GNorm = 0.2675, lr_0 = 4.2372e-04
Validation auc = 0.412550
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246533
Epoch 19
Loss = 1.5031e-02, PNorm = 37.8807, GNorm = 0.0387, lr_0 = 4.1269e-04
Loss = 4.1357e-02, PNorm = 37.8808, GNorm = 0.6021, lr_0 = 4.0291e-04
Validation auc = 0.406542
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.245278
Epoch 20
Loss = 1.6840e-02, PNorm = 37.8803, GNorm = 0.0185, lr_0 = 3.9336e-04
Loss = 2.6443e-02, PNorm = 37.8904, GNorm = 0.3988, lr_0 = 3.8404e-04
Validation auc = 0.406542
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.248194
Epoch 21
Loss = 1.2977e-02, PNorm = 37.8971, GNorm = 0.2754, lr_0 = 3.7404e-04
Loss = 3.4296e-02, PNorm = 37.9041, GNorm = 0.9110, lr_0 = 3.6517e-04
Validation auc = 0.409880
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.249086
Epoch 22
Loss = 2.0103e-02, PNorm = 37.9077, GNorm = 0.4278, lr_0 = 3.5567e-04
Loss = 3.7364e-02, PNorm = 37.9165, GNorm = 1.0140, lr_0 = 3.4724e-04
Validation auc = 0.417891
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.250488
Epoch 23
Loss = 2.3344e-02, PNorm = 37.9263, GNorm = 0.3051, lr_0 = 3.3819e-04
Loss = 2.5672e-02, PNorm = 37.9368, GNorm = 0.6837, lr_0 = 3.3018e-04
Validation auc = 0.421228
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.252703
Epoch 24
Loss = 1.0841e-02, PNorm = 37.9404, GNorm = 0.0381, lr_0 = 3.2158e-04
Loss = 3.2314e-02, PNorm = 37.9443, GNorm = 0.6379, lr_0 = 3.1396e-04
Validation auc = 0.421896
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.247927
Epoch 25
Loss = 2.0572e-02, PNorm = 37.9513, GNorm = 0.3451, lr_0 = 3.0579e-04
Loss = 2.4322e-02, PNorm = 37.9590, GNorm = 0.5042, lr_0 = 2.9854e-04
Validation auc = 0.433244
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.251093
Epoch 26
Loss = 2.5772e-02, PNorm = 37.9683, GNorm = 0.5668, lr_0 = 2.9076e-04
Loss = 2.4900e-02, PNorm = 37.9737, GNorm = 0.5730, lr_0 = 2.8387e-04
Validation auc = 0.446595
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.253517
Epoch 27
Loss = 1.8475e-02, PNorm = 37.9757, GNorm = 0.6265, lr_0 = 2.7648e-04
Loss = 2.7776e-02, PNorm = 37.9795, GNorm = 0.5452, lr_0 = 2.6993e-04
Validation auc = 0.439920
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.250462
Epoch 28
Loss = 1.9238e-02, PNorm = 37.9831, GNorm = 0.3335, lr_0 = 2.6290e-04
Loss = 2.9866e-02, PNorm = 37.9900, GNorm = 1.1126, lr_0 = 2.5667e-04
Validation auc = 0.452603
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.250647
Epoch 29
Loss = 1.6774e-02, PNorm = 38.0001, GNorm = 0.5147, lr_0 = 2.4999e-04
Loss = 2.6675e-02, PNorm = 38.0058, GNorm = 0.5760, lr_0 = 2.4406e-04
Validation auc = 0.462617
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.252328
Epoch 30
Loss = 1.5394e-02, PNorm = 38.0004, GNorm = 0.4810, lr_0 = 2.3828e-04
Loss = 3.5338e-02, PNorm = 38.0060, GNorm = 0.8576, lr_0 = 2.3263e-04
Validation auc = 0.459947
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.244480
Epoch 31
Loss = 1.0592e-02, PNorm = 38.0138, GNorm = 0.4658, lr_0 = 2.2657e-04
Loss = 2.4173e-02, PNorm = 38.0225, GNorm = 0.9809, lr_0 = 2.2120e-04
Validation auc = 0.481976
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.243170
Epoch 32
Loss = 2.9417e-02, PNorm = 38.0408, GNorm = 0.7182, lr_0 = 2.1544e-04
Loss = 3.0748e-02, PNorm = 38.0477, GNorm = 0.1572, lr_0 = 2.1034e-04
Validation auc = 0.491989
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246198
Epoch 33
Loss = 2.4185e-02, PNorm = 38.0402, GNorm = 0.0133, lr_0 = 2.0486e-04
Loss = 3.0016e-02, PNorm = 38.0404, GNorm = 0.3823, lr_0 = 2.0001e-04
Validation auc = 0.471295
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.238630
Epoch 34
Loss = 2.8368e-02, PNorm = 38.0499, GNorm = 0.3825, lr_0 = 1.9480e-04
Loss = 3.5285e-02, PNorm = 38.0594, GNorm = 0.8055, lr_0 = 1.9018e-04
Validation auc = 0.494660
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.239721
Epoch 35
Loss = 3.0779e-02, PNorm = 38.0654, GNorm = 0.5058, lr_0 = 1.8523e-04
Loss = 1.4918e-02, PNorm = 38.0719, GNorm = 0.4347, lr_0 = 1.8084e-04
Validation auc = 0.504005
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.239675
Epoch 36
Loss = 1.6647e-02, PNorm = 38.0755, GNorm = 0.5026, lr_0 = 1.7613e-04
Loss = 2.5850e-02, PNorm = 38.0802, GNorm = 0.6578, lr_0 = 1.7196e-04
Validation auc = 0.502670
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.241357
Epoch 37
Loss = 2.1740e-02, PNorm = 38.0861, GNorm = 0.1799, lr_0 = 1.6748e-04
Loss = 2.4522e-02, PNorm = 38.0906, GNorm = 0.6612, lr_0 = 1.6351e-04
Validation auc = 0.512016
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.240937
Epoch 38
Loss = 2.0361e-02, PNorm = 38.0946, GNorm = 0.5298, lr_0 = 1.5925e-04
Loss = 2.4667e-02, PNorm = 38.0977, GNorm = 0.0130, lr_0 = 1.5548e-04
Validation auc = 0.514686
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.241371
Epoch 39
Loss = 1.9263e-02, PNorm = 38.1020, GNorm = 0.4040, lr_0 = 1.5143e-04
Loss = 2.1633e-02, PNorm = 38.1051, GNorm = 0.0071, lr_0 = 1.4784e-04
Validation auc = 0.524700
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.243723
Epoch 40
Loss = 3.7873e-02, PNorm = 38.1121, GNorm = 0.8750, lr_0 = 1.4434e-04
Loss = 1.9791e-02, PNorm = 38.1167, GNorm = 0.0098, lr_0 = 1.4092e-04
Validation auc = 0.528705
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.255028
Epoch 41
Loss = 3.1697e-02, PNorm = 38.1200, GNorm = 0.3271, lr_0 = 1.3725e-04
Loss = 2.0225e-02, PNorm = 38.1192, GNorm = 0.3382, lr_0 = 1.3399e-04
Validation auc = 0.520694
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.251378
Epoch 42
Loss = 1.9325e-02, PNorm = 38.1223, GNorm = 0.3267, lr_0 = 1.3050e-04
Loss = 3.0022e-02, PNorm = 38.1254, GNorm = 0.0073, lr_0 = 1.2741e-04
Validation auc = 0.526702
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.249921
Epoch 43
Loss = 1.7233e-02, PNorm = 38.1254, GNorm = 0.2231, lr_0 = 1.2409e-04
Loss = 3.0113e-02, PNorm = 38.1259, GNorm = 0.3293, lr_0 = 1.2115e-04
Validation auc = 0.527370
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.244780
Epoch 44
Loss = 2.3733e-02, PNorm = 38.1287, GNorm = 0.3379, lr_0 = 1.1800e-04
Loss = 2.6444e-02, PNorm = 38.1318, GNorm = 0.3673, lr_0 = 1.1520e-04
Validation auc = 0.532043
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.245900
Epoch 45
Loss = 1.4744e-02, PNorm = 38.1395, GNorm = 0.0871, lr_0 = 1.1220e-04
Loss = 3.1113e-02, PNorm = 38.1431, GNorm = 0.0080, lr_0 = 1.0954e-04
Validation auc = 0.539386
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.250392
Epoch 46
Loss = 3.4098e-02, PNorm = 38.1434, GNorm = 0.7140, lr_0 = 1.0669e-04
Loss = 2.1283e-02, PNorm = 38.1435, GNorm = 0.5793, lr_0 = 1.0416e-04
Validation auc = 0.534713
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.245330
Epoch 47
Loss = 1.6108e-02, PNorm = 38.1455, GNorm = 0.3193, lr_0 = 1.0145e-04
Loss = 2.2965e-02, PNorm = 38.1475, GNorm = 0.0086, lr_0 = 1.0000e-04
Validation auc = 0.533378
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.244198
Epoch 48
Loss = 1.2561e-02, PNorm = 38.1484, GNorm = 0.3529, lr_0 = 1.0000e-04
Loss = 2.4530e-02, PNorm = 38.1518, GNorm = 0.7348, lr_0 = 1.0000e-04
Validation auc = 0.538051
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.243648
Epoch 49
Loss = 1.4259e-02, PNorm = 38.1536, GNorm = 0.3517, lr_0 = 1.0000e-04
Loss = 2.7109e-02, PNorm = 38.1559, GNorm = 0.4705, lr_0 = 1.0000e-04
Validation auc = 0.540721
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.243397
Model 0 best validation auc = 0.540721 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.808405
Model 0 test accuracy = 0.900794
Model 0 test f1 = 0.242424
Model 0 test binary_cross_entropy = 0.449051
Ensemble test auc = 0.808405
Ensemble test accuracy = 0.900794
Ensemble test f1 = 0.242424
Ensemble test binary_cross_entropy = 0.449051
Fold 1
Splitting data with seed 1
Class sizes
CT_TOX 0: 91.65%, 1: 8.35%
Total size = 1,257 | train size = 1,005 | val size = 221 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 5.8230e-01, PNorm = 37.2525, GNorm = 1.6626, lr_0 = 3.4750e-04
Loss = 3.5562e-01, PNorm = 37.2802, GNorm = 2.1876, lr_0 = 5.7250e-04
Loss = 4.8811e-01, PNorm = 37.2801, GNorm = 10.4827, lr_0 = 5.9500e-04
Validation auc = 0.319092
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.216248
Epoch 1
Loss = 1.4278e-01, PNorm = 37.3110, GNorm = 1.1803, lr_0 = 8.2000e-04
Loss = 1.5183e-01, PNorm = 37.3768, GNorm = 1.1280, lr_0 = 9.9521e-04
Loss = 5.3499e-03, PNorm = 37.3813, GNorm = 0.1314, lr_0 = 9.9283e-04
Validation auc = 0.311081
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.217215
Epoch 2
Loss = 2.9651e-02, PNorm = 37.4323, GNorm = 0.4730, lr_0 = 9.6930e-04
Loss = 8.3071e-02, PNorm = 37.4559, GNorm = 0.5679, lr_0 = 9.4633e-04
Loss = 1.6481e-02, PNorm = 37.4590, GNorm = 0.4034, lr_0 = 9.4406e-04
Validation auc = 0.387183
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.215944
Epoch 3
Loss = 5.6924e-02, PNorm = 37.5027, GNorm = 0.3842, lr_0 = 9.2169e-04
Loss = 5.8455e-02, PNorm = 37.5322, GNorm = 1.4738, lr_0 = 8.9984e-04
Loss = 5.6963e-04, PNorm = 37.5317, GNorm = 0.0160, lr_0 = 8.9769e-04
Validation auc = 0.415888
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.228424
Epoch 4
Loss = 2.1928e-02, PNorm = 37.5439, GNorm = 0.2215, lr_0 = 8.7641e-04
Loss = 8.7670e-02, PNorm = 37.5736, GNorm = 0.5730, lr_0 = 8.5564e-04
Loss = 2.0154e-02, PNorm = 37.5750, GNorm = 0.9845, lr_0 = 8.5359e-04
Validation auc = 0.441923
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.221686
Epoch 5
Loss = 3.9068e-02, PNorm = 37.5915, GNorm = 1.5735, lr_0 = 8.3336e-04
Loss = 5.3548e-02, PNorm = 37.6137, GNorm = 0.3236, lr_0 = 8.1361e-04
Loss = 1.5054e-03, PNorm = 37.6159, GNorm = 0.0507, lr_0 = 8.1166e-04
Validation auc = 0.428571
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229695
Epoch 6
Loss = 1.8200e-02, PNorm = 37.6408, GNorm = 0.4873, lr_0 = 7.9243e-04
Loss = 7.7297e-02, PNorm = 37.6504, GNorm = 1.0922, lr_0 = 7.7364e-04
Loss = 1.1561e-02, PNorm = 37.6516, GNorm = 0.2642, lr_0 = 7.7179e-04
Validation auc = 0.443925
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229723
Epoch 7
Loss = 2.3261e-02, PNorm = 37.6735, GNorm = 0.6112, lr_0 = 7.5350e-04
Loss = 5.0827e-02, PNorm = 37.6835, GNorm = 0.1430, lr_0 = 7.3564e-04
Loss = 1.3243e-03, PNorm = 37.6839, GNorm = 0.0330, lr_0 = 7.3388e-04
Validation auc = 0.473298
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.232329
Epoch 8
Loss = 2.8470e-02, PNorm = 37.6930, GNorm = 0.0426, lr_0 = 7.1649e-04
Loss = 4.1997e-02, PNorm = 37.7134, GNorm = 0.0240, lr_0 = 6.9951e-04
Loss = 2.0232e-01, PNorm = 37.7181, GNorm = 3.0641, lr_0 = 6.9783e-04
Validation auc = 0.471963
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.254403
Epoch 9
Loss = 3.9364e-02, PNorm = 37.7322, GNorm = 0.2696, lr_0 = 6.8129e-04
Loss = 6.0015e-02, PNorm = 37.7367, GNorm = 0.8853, lr_0 = 6.6515e-04
Validation auc = 0.454606
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.235928
Epoch 10
Loss = 2.7840e-02, PNorm = 37.7512, GNorm = 0.0117, lr_0 = 6.4938e-04
Loss = 5.4757e-02, PNorm = 37.7622, GNorm = 1.2619, lr_0 = 6.3399e-04
Validation auc = 0.468625
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.239530
Epoch 11
Loss = 2.2629e-02, PNorm = 37.7922, GNorm = 0.7350, lr_0 = 6.1748e-04
Loss = 6.6627e-02, PNorm = 37.7983, GNorm = 0.9467, lr_0 = 6.0285e-04
Validation auc = 0.462617
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246415
Epoch 12
Loss = 1.3862e-02, PNorm = 37.8066, GNorm = 0.0717, lr_0 = 5.8715e-04
Loss = 7.1825e-02, PNorm = 37.8186, GNorm = 0.0363, lr_0 = 5.7324e-04
Validation auc = 0.463952
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.236818
Epoch 13
Loss = 4.0873e-02, PNorm = 37.8319, GNorm = 0.7350, lr_0 = 5.5831e-04
Loss = 4.1872e-02, PNorm = 37.8353, GNorm = 0.5608, lr_0 = 5.4508e-04
Validation auc = 0.476636
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.230829
Epoch 14
Loss = 2.3559e-02, PNorm = 37.8470, GNorm = 0.0294, lr_0 = 5.3088e-04
Loss = 5.0273e-02, PNorm = 37.8601, GNorm = 0.6143, lr_0 = 5.1830e-04
Validation auc = 0.475968
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.244675
Epoch 15
Loss = 3.9627e-02, PNorm = 37.8745, GNorm = 1.0726, lr_0 = 5.0481e-04
Loss = 2.8554e-02, PNorm = 37.8798, GNorm = 0.0301, lr_0 = 4.9284e-04
Validation auc = 0.478638
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246127
Epoch 16
Loss = 2.6571e-02, PNorm = 37.8798, GNorm = 0.0149, lr_0 = 4.8001e-04
Loss = 3.0359e-02, PNorm = 37.8931, GNorm = 0.2748, lr_0 = 4.6863e-04
Validation auc = 0.494660
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.235690
Epoch 17
Loss = 3.4641e-02, PNorm = 37.9091, GNorm = 0.9709, lr_0 = 4.5643e-04
Loss = 2.6601e-02, PNorm = 37.9107, GNorm = 0.2800, lr_0 = 4.4561e-04
Validation auc = 0.488652
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.233474
Epoch 18
Loss = 2.2482e-02, PNorm = 37.9175, GNorm = 0.0430, lr_0 = 4.3401e-04
Loss = 2.1865e-02, PNorm = 37.9295, GNorm = 0.4118, lr_0 = 4.2372e-04
Validation auc = 0.494660
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.240303
Epoch 19
Loss = 2.2210e-02, PNorm = 37.9497, GNorm = 0.4936, lr_0 = 4.1269e-04
Loss = 3.9643e-02, PNorm = 37.9509, GNorm = 0.2517, lr_0 = 4.0291e-04
Validation auc = 0.488652
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.252612
Epoch 20
Loss = 3.4770e-02, PNorm = 37.9547, GNorm = 0.3879, lr_0 = 3.9336e-04
Loss = 2.7762e-02, PNorm = 37.9602, GNorm = 0.7039, lr_0 = 3.8404e-04
Validation auc = 0.485314
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.249239
Epoch 21
Loss = 3.0585e-02, PNorm = 37.9631, GNorm = 0.4102, lr_0 = 3.7404e-04
Loss = 2.9752e-02, PNorm = 37.9727, GNorm = 1.0464, lr_0 = 3.6517e-04
Validation auc = 0.504673
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246418
Epoch 22
Loss = 3.1763e-02, PNorm = 37.9853, GNorm = 0.3328, lr_0 = 3.5567e-04
Loss = 2.8288e-02, PNorm = 37.9905, GNorm = 0.8604, lr_0 = 3.4724e-04
Validation auc = 0.504005
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.247445
Epoch 23
Loss = 2.1099e-02, PNorm = 37.9965, GNorm = 0.4336, lr_0 = 3.3819e-04
Loss = 2.4831e-02, PNorm = 37.9983, GNorm = 0.1412, lr_0 = 3.3018e-04
Validation auc = 0.508011
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.236142
Epoch 24
Loss = 2.0842e-02, PNorm = 38.0080, GNorm = 0.0239, lr_0 = 3.2158e-04
Loss = 3.4966e-02, PNorm = 38.0162, GNorm = 0.9476, lr_0 = 3.1396e-04
Validation auc = 0.514019
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.242878
Epoch 25
Loss = 2.3259e-02, PNorm = 38.0253, GNorm = 0.6537, lr_0 = 3.0579e-04
Loss = 2.8582e-02, PNorm = 38.0328, GNorm = 0.5011, lr_0 = 2.9854e-04
Validation auc = 0.534045
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.240305
Epoch 26
Loss = 2.3805e-02, PNorm = 38.0411, GNorm = 0.3356, lr_0 = 2.9076e-04
Loss = 1.9115e-02, PNorm = 38.0482, GNorm = 0.0142, lr_0 = 2.8387e-04
Validation auc = 0.539386
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.242642
Epoch 27
Loss = 1.5752e-02, PNorm = 38.0570, GNorm = 0.0101, lr_0 = 2.7648e-04
Loss = 2.6677e-02, PNorm = 38.0635, GNorm = 0.5010, lr_0 = 2.6993e-04
Validation auc = 0.544059
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246273
Epoch 28
Loss = 1.9795e-02, PNorm = 38.0694, GNorm = 0.7526, lr_0 = 2.6290e-04
Loss = 2.5364e-02, PNorm = 38.0747, GNorm = 0.4289, lr_0 = 2.5667e-04
Validation auc = 0.548732
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246879
Epoch 29
Loss = 2.0926e-02, PNorm = 38.0776, GNorm = 1.0152, lr_0 = 2.4999e-04
Loss = 2.3352e-02, PNorm = 38.0842, GNorm = 0.7890, lr_0 = 2.4406e-04
Validation auc = 0.554740
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.242428
Epoch 30
Loss = 1.3246e-02, PNorm = 38.0916, GNorm = 0.4855, lr_0 = 2.3828e-04
Loss = 2.2656e-02, PNorm = 38.1006, GNorm = 0.5298, lr_0 = 2.3263e-04
Validation auc = 0.564085
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.251634
Epoch 31
Loss = 1.8701e-02, PNorm = 38.1081, GNorm = 0.2414, lr_0 = 2.2657e-04
Loss = 2.3396e-02, PNorm = 38.1121, GNorm = 0.2965, lr_0 = 2.2120e-04
Validation auc = 0.566756
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.245322
Epoch 32
Loss = 1.7027e-02, PNorm = 38.1109, GNorm = 0.7775, lr_0 = 2.1544e-04
Loss = 2.0156e-02, PNorm = 38.1163, GNorm = 0.6224, lr_0 = 2.1034e-04
Validation auc = 0.567423
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246060
Epoch 33
Loss = 2.3638e-02, PNorm = 38.1235, GNorm = 0.0072, lr_0 = 2.0486e-04
Loss = 1.9414e-02, PNorm = 38.1292, GNorm = 0.3859, lr_0 = 2.0001e-04
Validation auc = 0.572096
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246692
Epoch 34
Loss = 2.5040e-02, PNorm = 38.1330, GNorm = 0.6408, lr_0 = 1.9480e-04
Loss = 1.2317e-02, PNorm = 38.1382, GNorm = 0.5489, lr_0 = 1.9018e-04
Validation auc = 0.575434
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.250368
Epoch 35
Loss = 1.1646e-02, PNorm = 38.1432, GNorm = 0.6366, lr_0 = 1.8523e-04
Loss = 2.3816e-02, PNorm = 38.1461, GNorm = 0.4580, lr_0 = 1.8084e-04
Validation auc = 0.578772
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.250650
Epoch 36
Loss = 1.4008e-02, PNorm = 38.1570, GNorm = 0.0151, lr_0 = 1.7613e-04
Loss = 2.2251e-02, PNorm = 38.1627, GNorm = 0.3041, lr_0 = 1.7196e-04
Validation auc = 0.601469
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.272262
Epoch 37
Loss = 1.3365e-02, PNorm = 38.1625, GNorm = 0.6344, lr_0 = 1.6748e-04
Loss = 3.9593e-02, PNorm = 38.1631, GNorm = 1.1220, lr_0 = 1.6351e-04
Validation auc = 0.580107
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.257396
Epoch 38
Loss = 4.8642e-02, PNorm = 38.1630, GNorm = 0.2521, lr_0 = 1.5925e-04
Loss = 1.6822e-02, PNorm = 38.1655, GNorm = 0.0121, lr_0 = 1.5548e-04
Validation auc = 0.575434
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.253072
Epoch 39
Loss = 2.5468e-02, PNorm = 38.1689, GNorm = 0.0094, lr_0 = 1.5143e-04
Loss = 2.8023e-02, PNorm = 38.1714, GNorm = 0.3231, lr_0 = 1.4784e-04
Validation auc = 0.576101
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.250915
Epoch 40
Loss = 1.5483e-02, PNorm = 38.1762, GNorm = 0.6180, lr_0 = 1.4434e-04
Loss = 2.6302e-02, PNorm = 38.1810, GNorm = 0.5564, lr_0 = 1.4092e-04
Validation auc = 0.580107
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.253816
Epoch 41
Loss = 9.4658e-03, PNorm = 38.1815, GNorm = 0.3619, lr_0 = 1.3725e-04
Loss = 2.6623e-02, PNorm = 38.1828, GNorm = 0.5624, lr_0 = 1.3399e-04
Validation auc = 0.580107
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.245610
Epoch 42
Loss = 2.7579e-02, PNorm = 38.1873, GNorm = 0.5912, lr_0 = 1.3050e-04
Loss = 2.0495e-02, PNorm = 38.1919, GNorm = 0.0163, lr_0 = 1.2741e-04
Validation auc = 0.583445
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.251388
Epoch 43
Loss = 2.4394e-02, PNorm = 38.1943, GNorm = 0.6334, lr_0 = 1.2409e-04
Loss = 1.2790e-02, PNorm = 38.1967, GNorm = 0.0049, lr_0 = 1.2115e-04
Validation auc = 0.590120
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.247214
Epoch 44
Loss = 2.3023e-02, PNorm = 38.2007, GNorm = 0.3556, lr_0 = 1.1800e-04
Loss = 1.3637e-02, PNorm = 38.2055, GNorm = 0.0083, lr_0 = 1.1520e-04
Validation auc = 0.596128
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.251039
Epoch 45
Loss = 1.8989e-02, PNorm = 38.2054, GNorm = 0.4402, lr_0 = 1.1220e-04
Loss = 2.0827e-02, PNorm = 38.2090, GNorm = 0.6294, lr_0 = 1.0954e-04
Validation auc = 0.597463
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.249369
Epoch 46
Loss = 1.9586e-02, PNorm = 38.2101, GNorm = 0.6766, lr_0 = 1.0669e-04
Loss = 2.2553e-02, PNorm = 38.2130, GNorm = 0.6555, lr_0 = 1.0416e-04
Validation auc = 0.601469
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.249555
Epoch 47
Loss = 2.1180e-02, PNorm = 38.2189, GNorm = 0.0068, lr_0 = 1.0145e-04
Loss = 1.9015e-02, PNorm = 38.2221, GNorm = 0.0093, lr_0 = 1.0000e-04
Validation auc = 0.606142
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.252969
Epoch 48
Loss = 2.6817e-02, PNorm = 38.2211, GNorm = 0.4935, lr_0 = 1.0000e-04
Loss = 1.3079e-02, PNorm = 38.2221, GNorm = 0.9329, lr_0 = 1.0000e-04
Validation auc = 0.608144
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.242668
Epoch 49
Loss = 2.9246e-02, PNorm = 38.2272, GNorm = 0.0068, lr_0 = 1.0000e-04
Loss = 1.9478e-02, PNorm = 38.2325, GNorm = 0.0045, lr_0 = 1.0000e-04
Validation auc = 0.613485
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.250590
Model 0 best validation auc = 0.613485 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.742358
Model 0 test accuracy = 0.876984
Model 0 test f1 = 0.162162
Model 0 test binary_cross_entropy = 0.618175
Ensemble test auc = 0.742358
Ensemble test accuracy = 0.876984
Ensemble test f1 = 0.162162
Ensemble test binary_cross_entropy = 0.618175
Fold 2
Splitting data with seed 2
Class sizes
CT_TOX 0: 91.65%, 1: 8.35%
Total size = 1,257 | train size = 1,005 | val size = 221 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 6.4040e-01, PNorm = 37.2521, GNorm = 1.5930, lr_0 = 3.4750e-04
Loss = 3.4683e-01, PNorm = 37.2818, GNorm = 2.0917, lr_0 = 5.7250e-04
Loss = 1.1225e-01, PNorm = 37.2834, GNorm = 3.1709, lr_0 = 5.9500e-04
Validation auc = 0.266355
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.211282
Epoch 1
Loss = 1.6896e-01, PNorm = 37.3089, GNorm = 1.1783, lr_0 = 8.2000e-04
Loss = 1.1058e-01, PNorm = 37.3731, GNorm = 1.4984, lr_0 = 9.9521e-04
Loss = 3.0466e-03, PNorm = 37.3785, GNorm = 0.0870, lr_0 = 9.9283e-04
Validation auc = 0.350467
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.213319
Epoch 2
Loss = 4.6564e-02, PNorm = 37.4160, GNorm = 1.2024, lr_0 = 9.6930e-04
Loss = 7.5917e-02, PNorm = 37.4433, GNorm = 1.3488, lr_0 = 9.4633e-04
Loss = 5.0913e-03, PNorm = 37.4462, GNorm = 0.1030, lr_0 = 9.4406e-04
Validation auc = 0.413885
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.197631
Epoch 3
Loss = 5.1376e-02, PNorm = 37.4799, GNorm = 0.6720, lr_0 = 9.2169e-04
Loss = 4.4539e-02, PNorm = 37.5024, GNorm = 0.8517, lr_0 = 8.9984e-04
Loss = 7.9011e-04, PNorm = 37.5032, GNorm = 0.0185, lr_0 = 8.9769e-04
Validation auc = 0.432577
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.213738
Epoch 4
Loss = 4.3399e-02, PNorm = 37.5134, GNorm = 0.5219, lr_0 = 8.7641e-04
Loss = 4.8225e-02, PNorm = 37.5511, GNorm = 0.9016, lr_0 = 8.5564e-04
Loss = 1.9941e-03, PNorm = 37.5548, GNorm = 0.0413, lr_0 = 8.5359e-04
Validation auc = 0.417223
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.251955
Epoch 5
Loss = 2.4446e-02, PNorm = 37.5635, GNorm = 0.0235, lr_0 = 8.3336e-04
Loss = 5.3076e-02, PNorm = 37.5762, GNorm = 0.6731, lr_0 = 8.1361e-04
Loss = 2.0820e-03, PNorm = 37.5777, GNorm = 0.0501, lr_0 = 8.1166e-04
Validation auc = 0.421228
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.212071
Epoch 6
Loss = 3.6181e-02, PNorm = 37.5984, GNorm = 0.5199, lr_0 = 7.9243e-04
Loss = 4.1157e-02, PNorm = 37.6050, GNorm = 1.0674, lr_0 = 7.7364e-04
Loss = 1.0272e-03, PNorm = 37.6065, GNorm = 0.0233, lr_0 = 7.7179e-04
Validation auc = 0.452603
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.204414
Epoch 7
Loss = 3.0595e-02, PNorm = 37.6288, GNorm = 0.5151, lr_0 = 7.5350e-04
Loss = 4.4315e-02, PNorm = 37.6428, GNorm = 1.0828, lr_0 = 7.3564e-04
Loss = 8.0859e-04, PNorm = 37.6443, GNorm = 0.0214, lr_0 = 7.3388e-04
Validation auc = 0.442590
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.217277
Epoch 8
Loss = 3.1551e-02, PNorm = 37.6632, GNorm = 0.4349, lr_0 = 7.1649e-04
Loss = 3.3745e-02, PNorm = 37.6703, GNorm = 1.0025, lr_0 = 6.9951e-04
Loss = 3.3510e-03, PNorm = 37.6710, GNorm = 0.1333, lr_0 = 6.9783e-04
Validation auc = 0.469960
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.212218
Epoch 9
Loss = 2.3740e-02, PNorm = 37.6880, GNorm = 0.2115, lr_0 = 6.8129e-04
Loss = 4.0707e-02, PNorm = 37.6958, GNorm = 0.0439, lr_0 = 6.6515e-04
Validation auc = 0.444593
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.222693
Epoch 10
Loss = 2.1687e-02, PNorm = 37.7082, GNorm = 0.4205, lr_0 = 6.4938e-04
Loss = 3.4642e-02, PNorm = 37.7237, GNorm = 0.2752, lr_0 = 6.3399e-04
Validation auc = 0.457276
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.239487
Epoch 11
Loss = 2.3544e-02, PNorm = 37.7379, GNorm = 0.2470, lr_0 = 6.1748e-04
Loss = 3.8275e-02, PNorm = 37.7418, GNorm = 0.0182, lr_0 = 6.0285e-04
Validation auc = 0.473298
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.223343
Epoch 12
Loss = 1.8294e-02, PNorm = 37.7557, GNorm = 0.0228, lr_0 = 5.8715e-04
Loss = 4.3976e-02, PNorm = 37.7609, GNorm = 0.7374, lr_0 = 5.7324e-04
Validation auc = 0.472630
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.219113
Epoch 13
Loss = 2.2763e-02, PNorm = 37.7752, GNorm = 0.0157, lr_0 = 5.5831e-04
Loss = 3.4188e-02, PNorm = 37.7929, GNorm = 0.5477, lr_0 = 5.4508e-04
Validation auc = 0.465955
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.243126
Epoch 14
Loss = 2.2988e-02, PNorm = 37.8002, GNorm = 0.4612, lr_0 = 5.3088e-04
Loss = 2.8940e-02, PNorm = 37.8074, GNorm = 0.0286, lr_0 = 5.1830e-04
Validation auc = 0.479306
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.223640
Epoch 15
Loss = 2.3265e-02, PNorm = 37.8220, GNorm = 0.3448, lr_0 = 5.0481e-04
Loss = 3.2385e-02, PNorm = 37.8266, GNorm = 0.4180, lr_0 = 4.9284e-04
Validation auc = 0.464619
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.224745
Epoch 16
Loss = 2.3189e-02, PNorm = 37.8408, GNorm = 0.1973, lr_0 = 4.8001e-04
Loss = 3.2082e-02, PNorm = 37.8573, GNorm = 0.5097, lr_0 = 4.6863e-04
Validation auc = 0.464619
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.235463
Epoch 17
Loss = 2.7344e-02, PNorm = 37.8647, GNorm = 0.5091, lr_0 = 4.5643e-04
Loss = 2.4501e-02, PNorm = 37.8823, GNorm = 0.9955, lr_0 = 4.4561e-04
Validation auc = 0.480641
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.235650
Epoch 18
Loss = 1.3313e-02, PNorm = 37.8987, GNorm = 0.0321, lr_0 = 4.3401e-04
Loss = 4.1682e-02, PNorm = 37.8973, GNorm = 0.6941, lr_0 = 4.2372e-04
Validation auc = 0.488652
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.223223
Epoch 19
Loss = 2.2544e-02, PNorm = 37.9038, GNorm = 1.4423, lr_0 = 4.1269e-04
Loss = 2.1572e-02, PNorm = 37.9212, GNorm = 0.0119, lr_0 = 4.0291e-04
Validation auc = 0.476636
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.239283
Epoch 20
Loss = 2.3060e-02, PNorm = 37.9320, GNorm = 0.8934, lr_0 = 3.9336e-04
Loss = 2.8172e-02, PNorm = 37.9414, GNorm = 0.5242, lr_0 = 3.8404e-04
Validation auc = 0.489319
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.237326
Epoch 21
Loss = 1.8377e-02, PNorm = 37.9589, GNorm = 0.3682, lr_0 = 3.7404e-04
Loss = 2.8804e-02, PNorm = 37.9625, GNorm = 0.8121, lr_0 = 3.6517e-04
Validation auc = 0.496662
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.227063
Epoch 22
Loss = 2.0114e-02, PNorm = 37.9653, GNorm = 0.6602, lr_0 = 3.5567e-04
Loss = 2.4647e-02, PNorm = 37.9843, GNorm = 0.3285, lr_0 = 3.4724e-04
Validation auc = 0.513351
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.240895
Epoch 23
Loss = 2.4761e-02, PNorm = 38.0139, GNorm = 0.4974, lr_0 = 3.3819e-04
Loss = 4.1954e-02, PNorm = 38.0076, GNorm = 0.4532, lr_0 = 3.3018e-04
Validation auc = 0.500668
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.243116
Epoch 24
Loss = 3.4105e-02, PNorm = 38.0005, GNorm = 0.3025, lr_0 = 3.2158e-04
Loss = 3.0014e-02, PNorm = 38.0080, GNorm = 0.5673, lr_0 = 3.1396e-04
Validation auc = 0.497997
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.227309
Epoch 25
Loss = 3.5953e-02, PNorm = 38.0161, GNorm = 0.0336, lr_0 = 3.0579e-04
Loss = 4.7032e-02, PNorm = 38.0357, GNorm = 0.0224, lr_0 = 2.9854e-04
Validation auc = 0.512016
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.227149
Epoch 26
Loss = 2.1785e-02, PNorm = 38.0613, GNorm = 0.2673, lr_0 = 2.9076e-04
Loss = 3.1196e-02, PNorm = 38.0736, GNorm = 0.5710, lr_0 = 2.8387e-04
Validation auc = 0.549399
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.240271
Epoch 27
Loss = 3.0577e-02, PNorm = 38.0700, GNorm = 0.4821, lr_0 = 2.7648e-04
Loss = 3.0640e-02, PNorm = 38.0826, GNorm = 1.0211, lr_0 = 2.6993e-04
Validation auc = 0.564753
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.213696
Epoch 28
Loss = 2.2296e-02, PNorm = 38.0935, GNorm = 0.5000, lr_0 = 2.6290e-04
Loss = 4.2155e-02, PNorm = 38.1258, GNorm = 0.7046, lr_0 = 2.5667e-04
Validation auc = 0.627503
Validation accuracy = 0.945701
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.204083
Epoch 29
Loss = 3.1683e-02, PNorm = 38.1675, GNorm = 0.3274, lr_0 = 2.4999e-04
Loss = 3.2077e-02, PNorm = 38.1794, GNorm = 0.0091, lr_0 = 2.4406e-04
Validation auc = 0.670227
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.214160
Epoch 30
Loss = 2.1421e-02, PNorm = 38.1754, GNorm = 0.1930, lr_0 = 2.3828e-04
Loss = 2.5181e-02, PNorm = 38.1728, GNorm = 0.6093, lr_0 = 2.3263e-04
Validation auc = 0.616822
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.213350
Epoch 31
Loss = 4.1346e-02, PNorm = 38.1818, GNorm = 0.6050, lr_0 = 2.2657e-04
Loss = 1.6284e-02, PNorm = 38.1906, GNorm = 0.4468, lr_0 = 2.2120e-04
Validation auc = 0.622163
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.219266
Epoch 32
Loss = 1.7170e-02, PNorm = 38.1938, GNorm = 0.7231, lr_0 = 2.1544e-04
Loss = 2.9924e-02, PNorm = 38.1993, GNorm = 0.0120, lr_0 = 2.1034e-04
Validation auc = 0.622830
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.218638
Epoch 33
Loss = 1.7113e-02, PNorm = 38.2060, GNorm = 0.7542, lr_0 = 2.0486e-04
Loss = 2.5780e-02, PNorm = 38.2110, GNorm = 0.7959, lr_0 = 2.0001e-04
Validation auc = 0.636849
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.219528
Epoch 34
Loss = 2.4810e-02, PNorm = 38.2178, GNorm = 0.3664, lr_0 = 1.9480e-04
Loss = 2.3383e-02, PNorm = 38.2237, GNorm = 0.5515, lr_0 = 1.9018e-04
Validation auc = 0.644860
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.222294
Epoch 35
Loss = 2.2199e-02, PNorm = 38.2296, GNorm = 0.0067, lr_0 = 1.8523e-04
Loss = 1.9112e-02, PNorm = 38.2331, GNorm = 0.0120, lr_0 = 1.8084e-04
Validation auc = 0.653538
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.223300
Epoch 36
Loss = 1.8042e-02, PNorm = 38.2434, GNorm = 0.5038, lr_0 = 1.7613e-04
Loss = 2.3885e-02, PNorm = 38.2427, GNorm = 0.4453, lr_0 = 1.7196e-04
Validation auc = 0.646195
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.223639
Epoch 37
Loss = 1.4019e-02, PNorm = 38.2406, GNorm = 0.0128, lr_0 = 1.6748e-04
Loss = 2.6813e-02, PNorm = 38.2426, GNorm = 0.0165, lr_0 = 1.6351e-04
Validation auc = 0.644192
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.222953
Epoch 38
Loss = 2.3661e-02, PNorm = 38.2487, GNorm = 0.4254, lr_0 = 1.5925e-04
Loss = 1.8522e-02, PNorm = 38.2519, GNorm = 0.0131, lr_0 = 1.5548e-04
Validation auc = 0.648198
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.226599
Epoch 39
Loss = 1.4901e-02, PNorm = 38.2536, GNorm = 0.0073, lr_0 = 1.5143e-04
Loss = 2.0257e-02, PNorm = 38.2575, GNorm = 0.5254, lr_0 = 1.4784e-04
Validation auc = 0.647530
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.226545
Epoch 40
Loss = 2.3055e-02, PNorm = 38.2581, GNorm = 0.6875, lr_0 = 1.4434e-04
Loss = 1.6410e-02, PNorm = 38.2595, GNorm = 0.2782, lr_0 = 1.4092e-04
Validation auc = 0.649533
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.224978
Epoch 41
Loss = 1.1785e-02, PNorm = 38.2617, GNorm = 0.3114, lr_0 = 1.3725e-04
Loss = 1.5729e-02, PNorm = 38.2642, GNorm = 0.0082, lr_0 = 1.3399e-04
Validation auc = 0.652870
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.225543
Epoch 42
Loss = 5.6392e-03, PNorm = 38.2697, GNorm = 0.0145, lr_0 = 1.3050e-04
Loss = 2.4734e-02, PNorm = 38.2722, GNorm = 0.6465, lr_0 = 1.2741e-04
Validation auc = 0.663551
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229587
Epoch 43
Loss = 2.2241e-02, PNorm = 38.2748, GNorm = 0.0109, lr_0 = 1.2409e-04
Loss = 1.7435e-02, PNorm = 38.2775, GNorm = 0.0131, lr_0 = 1.2115e-04
Validation auc = 0.665554
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.231435
Epoch 44
Loss = 2.4113e-02, PNorm = 38.2810, GNorm = 0.5815, lr_0 = 1.1800e-04
Loss = 1.5981e-02, PNorm = 38.2812, GNorm = 0.3741, lr_0 = 1.1520e-04
Validation auc = 0.664887
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229046
Epoch 45
Loss = 1.4599e-02, PNorm = 38.2833, GNorm = 0.0072, lr_0 = 1.1220e-04
Loss = 2.0765e-02, PNorm = 38.2831, GNorm = 0.7464, lr_0 = 1.0954e-04
Validation auc = 0.665554
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229193
Epoch 46
Loss = 1.6971e-02, PNorm = 38.2836, GNorm = 0.3412, lr_0 = 1.0669e-04
Loss = 2.3422e-02, PNorm = 38.2836, GNorm = 0.6643, lr_0 = 1.0416e-04
Validation auc = 0.656208
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229874
Epoch 47
Loss = 2.7042e-02, PNorm = 38.2843, GNorm = 0.8915, lr_0 = 1.0145e-04
Loss = 1.4524e-02, PNorm = 38.2871, GNorm = 0.5528, lr_0 = 1.0000e-04
Validation auc = 0.664219
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.231643
Epoch 48
Loss = 2.4659e-02, PNorm = 38.2883, GNorm = 0.6678, lr_0 = 1.0000e-04
Loss = 9.3209e-03, PNorm = 38.2890, GNorm = 0.0171, lr_0 = 1.0000e-04
Validation auc = 0.665554
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.230540
Epoch 49
Loss = 1.2259e-02, PNorm = 38.2899, GNorm = 0.0111, lr_0 = 1.0000e-04
Loss = 2.4563e-02, PNorm = 38.2920, GNorm = 0.2703, lr_0 = 1.0000e-04
Validation auc = 0.666889
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.231237
Model 0 best validation auc = 0.670227 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.814978
Model 0 test accuracy = 0.896825
Model 0 test f1 = 0.235294
Model 0 test binary_cross_entropy = 0.509142
Ensemble test auc = 0.814978
Ensemble test accuracy = 0.896825
Ensemble test f1 = 0.235294
Ensemble test binary_cross_entropy = 0.509142
Fold 3
Splitting data with seed 3
Class sizes
CT_TOX 0: 91.65%, 1: 8.35%
Total size = 1,257 | train size = 1,005 | val size = 221 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 5.9074e-01, PNorm = 37.2524, GNorm = 2.4555, lr_0 = 3.4750e-04
Loss = 4.4844e-01, PNorm = 37.2734, GNorm = 2.0781, lr_0 = 5.7250e-04
Loss = 1.2163e+00, PNorm = 37.2730, GNorm = 16.3701, lr_0 = 5.9500e-04
Validation auc = 0.254339
Validation accuracy = 0.945701
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.248213
Epoch 1
Loss = 1.5914e-01, PNorm = 37.3102, GNorm = 1.6847, lr_0 = 8.2000e-04
Loss = 1.4604e-01, PNorm = 37.3792, GNorm = 0.9421, lr_0 = 9.9521e-04
Loss = 6.6635e-01, PNorm = 37.3867, GNorm = 9.3317, lr_0 = 9.9283e-04
Validation auc = 0.315087
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.231374
Epoch 2
Loss = 6.5602e-02, PNorm = 37.4359, GNorm = 0.7870, lr_0 = 9.6930e-04
Loss = 7.5765e-02, PNorm = 37.4661, GNorm = 0.7512, lr_0 = 9.4633e-04
Loss = 1.3337e-02, PNorm = 37.4697, GNorm = 0.2438, lr_0 = 9.4406e-04
Validation auc = 0.409212
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.216971
Epoch 3
Loss = 6.6625e-02, PNorm = 37.5051, GNorm = 0.5866, lr_0 = 9.2169e-04
Loss = 4.8387e-02, PNorm = 37.5192, GNorm = 0.2501, lr_0 = 8.9984e-04
Loss = 2.2000e-02, PNorm = 37.5208, GNorm = 0.5555, lr_0 = 8.9769e-04
Validation auc = 0.382510
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.226613
Epoch 4
Loss = 4.6052e-02, PNorm = 37.5408, GNorm = 1.1787, lr_0 = 8.7641e-04
Loss = 3.7487e-02, PNorm = 37.5652, GNorm = 0.5873, lr_0 = 8.5564e-04
Loss = 1.6181e-02, PNorm = 37.5693, GNorm = 0.6749, lr_0 = 8.5359e-04
Validation auc = 0.375834
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.244640
Epoch 5
Loss = 2.7028e-02, PNorm = 37.5900, GNorm = 0.0407, lr_0 = 8.3336e-04
Loss = 4.2035e-02, PNorm = 37.6020, GNorm = 0.0734, lr_0 = 8.1361e-04
Loss = 4.7361e-03, PNorm = 37.6027, GNorm = 0.1498, lr_0 = 8.1166e-04
Validation auc = 0.402537
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.241202
Epoch 6
Loss = 2.4789e-02, PNorm = 37.6207, GNorm = 1.0370, lr_0 = 7.9243e-04
Loss = 4.9293e-02, PNorm = 37.6393, GNorm = 0.4645, lr_0 = 7.7364e-04
Loss = 1.8451e-02, PNorm = 37.6405, GNorm = 0.8248, lr_0 = 7.7179e-04
Validation auc = 0.399866
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.250226
Epoch 7
Loss = 1.5347e-02, PNorm = 37.6555, GNorm = 0.0945, lr_0 = 7.5350e-04
Loss = 6.2205e-02, PNorm = 37.6604, GNorm = 0.8687, lr_0 = 7.3564e-04
Loss = 1.2310e-03, PNorm = 37.6624, GNorm = 0.0463, lr_0 = 7.3388e-04
Validation auc = 0.417223
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.235357
Epoch 8
Loss = 1.8765e-02, PNorm = 37.6894, GNorm = 0.0130, lr_0 = 7.1649e-04
Loss = 6.2083e-02, PNorm = 37.7060, GNorm = 0.0283, lr_0 = 6.9951e-04
Loss = 2.1430e-04, PNorm = 37.7076, GNorm = 0.0065, lr_0 = 6.9783e-04
Validation auc = 0.410547
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.261472
Epoch 9
Loss = 3.5164e-02, PNorm = 37.7218, GNorm = 0.3865, lr_0 = 6.8129e-04
Loss = 4.5068e-02, PNorm = 37.7228, GNorm = 0.3139, lr_0 = 6.6515e-04
Validation auc = 0.426569
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.237179
Epoch 10
Loss = 2.2261e-02, PNorm = 37.7372, GNorm = 0.8255, lr_0 = 6.4938e-04
Loss = 3.9591e-02, PNorm = 37.7559, GNorm = 1.1315, lr_0 = 6.3399e-04
Validation auc = 0.404539
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.259141
Epoch 11
Loss = 2.0774e-02, PNorm = 37.7613, GNorm = 0.4230, lr_0 = 6.1748e-04
Loss = 4.0387e-02, PNorm = 37.7822, GNorm = 0.9660, lr_0 = 6.0285e-04
Validation auc = 0.431242
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.246518
Epoch 12
Loss = 2.1475e-02, PNorm = 37.8049, GNorm = 1.0329, lr_0 = 5.8715e-04
Loss = 2.3240e-02, PNorm = 37.8107, GNorm = 0.4526, lr_0 = 5.7324e-04
Validation auc = 0.429907
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.249332
Epoch 13
Loss = 1.3533e-02, PNorm = 37.8280, GNorm = 0.6574, lr_0 = 5.5831e-04
Loss = 2.9450e-02, PNorm = 37.8378, GNorm = 0.0496, lr_0 = 5.4508e-04
Validation auc = 0.435915
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.251232
Epoch 14
Loss = 1.6657e-02, PNorm = 37.8519, GNorm = 0.3452, lr_0 = 5.3088e-04
Loss = 2.9874e-02, PNorm = 37.8636, GNorm = 0.0370, lr_0 = 5.1830e-04
Validation auc = 0.429239
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.263242
Epoch 15
Loss = 1.2621e-02, PNorm = 37.8754, GNorm = 0.0108, lr_0 = 5.0481e-04
Loss = 3.1852e-02, PNorm = 37.8837, GNorm = 0.9675, lr_0 = 4.9284e-04
Validation auc = 0.433912
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.254205
Epoch 16
Loss = 1.7855e-02, PNorm = 37.8949, GNorm = 0.5524, lr_0 = 4.8001e-04
Loss = 2.7700e-02, PNorm = 37.9111, GNorm = 0.0327, lr_0 = 4.6863e-04
Validation auc = 0.437917
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.255859
Epoch 17
Loss = 2.4822e-02, PNorm = 37.9073, GNorm = 0.3907, lr_0 = 4.5643e-04
Loss = 2.6617e-02, PNorm = 37.9327, GNorm = 1.0917, lr_0 = 4.4561e-04
Validation auc = 0.427904
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.254060
Epoch 18
Loss = 1.9950e-02, PNorm = 37.9571, GNorm = 0.2249, lr_0 = 4.3401e-04
Loss = 3.2242e-02, PNorm = 37.9659, GNorm = 0.3144, lr_0 = 4.2372e-04
Validation auc = 0.438585
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.249441
Epoch 19
Loss = 1.5149e-02, PNorm = 37.9849, GNorm = 0.5061, lr_0 = 4.1269e-04
Loss = 3.5750e-02, PNorm = 37.9997, GNorm = 0.0148, lr_0 = 4.0291e-04
Validation auc = 0.431909
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.262800
Epoch 20
Loss = 1.8635e-02, PNorm = 38.0130, GNorm = 0.0233, lr_0 = 3.9336e-04
Loss = 2.5480e-02, PNorm = 38.0239, GNorm = 0.0163, lr_0 = 3.8404e-04
Validation auc = 0.435915
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.263949
Epoch 21
Loss = 1.3916e-02, PNorm = 38.0274, GNorm = 0.0939, lr_0 = 3.7404e-04
Loss = 3.0764e-02, PNorm = 38.0391, GNorm = 0.5782, lr_0 = 3.6517e-04
Validation auc = 0.451268
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.258119
Epoch 22
Loss = 1.9637e-02, PNorm = 38.0526, GNorm = 0.0111, lr_0 = 3.5567e-04
Loss = 1.9061e-02, PNorm = 38.0602, GNorm = 0.6251, lr_0 = 3.4724e-04
Validation auc = 0.466622
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.258597
Epoch 23
Loss = 1.6452e-02, PNorm = 38.0782, GNorm = 0.0171, lr_0 = 3.3819e-04
Loss = 3.0147e-02, PNorm = 38.0862, GNorm = 0.6010, lr_0 = 3.3018e-04
Validation auc = 0.465955
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.268782
Epoch 24
Loss = 1.7755e-02, PNorm = 38.0898, GNorm = 0.3926, lr_0 = 3.2158e-04
Loss = 2.6709e-02, PNorm = 38.0968, GNorm = 1.1856, lr_0 = 3.1396e-04
Validation auc = 0.465287
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.259131
Epoch 25
Loss = 1.3870e-02, PNorm = 38.1088, GNorm = 0.5920, lr_0 = 3.0579e-04
Loss = 1.8703e-02, PNorm = 38.1183, GNorm = 0.2999, lr_0 = 2.9854e-04
Validation auc = 0.481976
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.261395
Epoch 26
Loss = 2.3851e-02, PNorm = 38.1292, GNorm = 0.9879, lr_0 = 2.9076e-04
Loss = 2.0675e-02, PNorm = 38.1352, GNorm = 0.3760, lr_0 = 2.8387e-04
Validation auc = 0.485981
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.270950
Epoch 27
Loss = 2.5376e-02, PNorm = 38.1410, GNorm = 0.0100, lr_0 = 2.7648e-04
Loss = 1.8550e-02, PNorm = 38.1505, GNorm = 0.0097, lr_0 = 2.6993e-04
Validation auc = 0.491989
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.268199
Epoch 28
Loss = 2.2698e-02, PNorm = 38.1581, GNorm = 0.7664, lr_0 = 2.6290e-04
Loss = 1.5916e-02, PNorm = 38.1624, GNorm = 0.3952, lr_0 = 2.5667e-04
Validation auc = 0.497997
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.265402
Epoch 29
Loss = 2.7234e-02, PNorm = 38.1720, GNorm = 0.8144, lr_0 = 2.4999e-04
Loss = 1.4909e-02, PNorm = 38.1805, GNorm = 0.0099, lr_0 = 2.4406e-04
Validation auc = 0.513351
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.265382
Epoch 30
Loss = 1.4213e-02, PNorm = 38.1839, GNorm = 0.0158, lr_0 = 2.3828e-04
Loss = 2.2095e-02, PNorm = 38.1929, GNorm = 0.7410, lr_0 = 2.3263e-04
Validation auc = 0.518692
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.264575
Epoch 31
Loss = 1.9001e-02, PNorm = 38.2033, GNorm = 0.5992, lr_0 = 2.2657e-04
Loss = 2.0732e-02, PNorm = 38.2078, GNorm = 0.3407, lr_0 = 2.2120e-04
Validation auc = 0.518024
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.265941
Epoch 32
Loss = 1.2510e-02, PNorm = 38.2084, GNorm = 0.0143, lr_0 = 2.1544e-04
Loss = 2.5873e-02, PNorm = 38.2126, GNorm = 0.5603, lr_0 = 2.1034e-04
Validation auc = 0.511348
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.263111
Epoch 33
Loss = 1.8000e-02, PNorm = 38.2258, GNorm = 0.4794, lr_0 = 2.0486e-04
Loss = 1.9337e-02, PNorm = 38.2303, GNorm = 0.0084, lr_0 = 2.0001e-04
Validation auc = 0.532043
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.265740
Epoch 34
Loss = 1.7306e-02, PNorm = 38.2368, GNorm = 0.3236, lr_0 = 1.9480e-04
Loss = 2.0978e-02, PNorm = 38.2423, GNorm = 0.0085, lr_0 = 1.9018e-04
Validation auc = 0.534713
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.268943
Epoch 35
Loss = 2.3864e-02, PNorm = 38.2461, GNorm = 0.9513, lr_0 = 1.8523e-04
Loss = 1.5749e-02, PNorm = 38.2511, GNorm = 0.4757, lr_0 = 1.8084e-04
Validation auc = 0.540721
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.264573
Epoch 36
Loss = 2.4129e-02, PNorm = 38.2587, GNorm = 0.0076, lr_0 = 1.7613e-04
Loss = 1.8020e-02, PNorm = 38.2630, GNorm = 0.1361, lr_0 = 1.7196e-04
Validation auc = 0.552737
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.270326
Epoch 37
Loss = 1.7104e-02, PNorm = 38.2727, GNorm = 0.6082, lr_0 = 1.6748e-04
Loss = 1.7125e-02, PNorm = 38.2742, GNorm = 0.0139, lr_0 = 1.6351e-04
Validation auc = 0.532043
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.287500
Epoch 38
Loss = 2.8975e-02, PNorm = 38.2735, GNorm = 0.0075, lr_0 = 1.5925e-04
Loss = 1.9978e-02, PNorm = 38.2754, GNorm = 0.0086, lr_0 = 1.5548e-04
Validation auc = 0.530708
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.269949
Epoch 39
Loss = 2.1219e-02, PNorm = 38.2802, GNorm = 0.5353, lr_0 = 1.5143e-04
Loss = 2.4634e-02, PNorm = 38.2863, GNorm = 1.0853, lr_0 = 1.4784e-04
Validation auc = 0.540053
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.271275
Epoch 40
Loss = 1.1026e-02, PNorm = 38.2893, GNorm = 0.3797, lr_0 = 1.4434e-04
Loss = 2.1630e-02, PNorm = 38.2938, GNorm = 0.9030, lr_0 = 1.4092e-04
Validation auc = 0.553405
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.267392
Epoch 41
Loss = 2.4413e-02, PNorm = 38.2947, GNorm = 0.6931, lr_0 = 1.3725e-04
Loss = 1.5539e-02, PNorm = 38.2995, GNorm = 0.2900, lr_0 = 1.3399e-04
Validation auc = 0.560748
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.262967
Epoch 42
Loss = 1.5883e-02, PNorm = 38.3045, GNorm = 0.8480, lr_0 = 1.3050e-04
Loss = 1.5027e-02, PNorm = 38.3083, GNorm = 0.1031, lr_0 = 1.2741e-04
Validation auc = 0.574766
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.259431
Epoch 43
Loss = 1.3306e-02, PNorm = 38.3146, GNorm = 0.5512, lr_0 = 1.2409e-04
Loss = 1.7059e-02, PNorm = 38.3193, GNorm = 0.4264, lr_0 = 1.2115e-04
Validation auc = 0.594793
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.258819
Epoch 44
Loss = 1.8443e-02, PNorm = 38.3200, GNorm = 0.0104, lr_0 = 1.1800e-04
Loss = 1.5667e-02, PNorm = 38.3238, GNorm = 0.9902, lr_0 = 1.1520e-04
Validation auc = 0.603471
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.255060
Epoch 45
Loss = 6.1339e-03, PNorm = 38.3284, GNorm = 0.4213, lr_0 = 1.1220e-04
Loss = 2.5854e-02, PNorm = 38.3330, GNorm = 0.6933, lr_0 = 1.0954e-04
Validation auc = 0.614152
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.262375
Epoch 46
Loss = 1.8113e-02, PNorm = 38.3439, GNorm = 0.6256, lr_0 = 1.0669e-04
Loss = 1.5338e-02, PNorm = 38.3454, GNorm = 0.2751, lr_0 = 1.0416e-04
Validation auc = 0.599466
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.265690
Epoch 47
Loss = 1.1777e-02, PNorm = 38.3451, GNorm = 0.4229, lr_0 = 1.0145e-04
Loss = 2.4335e-02, PNorm = 38.3469, GNorm = 0.3982, lr_0 = 1.0000e-04
Validation auc = 0.588785
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.262092
Epoch 48
Loss = 1.8702e-02, PNorm = 38.3507, GNorm = 0.3866, lr_0 = 1.0000e-04
Loss = 1.2589e-02, PNorm = 38.3536, GNorm = 0.4597, lr_0 = 1.0000e-04
Validation auc = 0.590788
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.264266
Epoch 49
Loss = 2.1366e-02, PNorm = 38.3548, GNorm = 0.1683, lr_0 = 1.0000e-04
Loss = 1.5027e-02, PNorm = 38.3557, GNorm = 0.7212, lr_0 = 1.0000e-04
Validation auc = 0.592123
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.258099
Model 0 best validation auc = 0.614152 on epoch 45
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.799750
Model 0 test accuracy = 0.920635
Model 0 test f1 = 0.285714
Model 0 test binary_cross_entropy = 0.434853
Ensemble test auc = 0.799750
Ensemble test accuracy = 0.920635
Ensemble test f1 = 0.285714
Ensemble test binary_cross_entropy = 0.434853
Fold 4
Splitting data with seed 4
Class sizes
CT_TOX 0: 91.65%, 1: 8.35%
Total size = 1,257 | train size = 1,005 | val size = 221 | test size = 252
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Moving model to cuda
Epoch 0
Loss = 5.9904e-01, PNorm = 37.2525, GNorm = 2.6231, lr_0 = 3.4750e-04
Loss = 3.5076e-01, PNorm = 37.2802, GNorm = 2.1445, lr_0 = 5.7250e-04
Loss = 6.2681e-01, PNorm = 37.2801, GNorm = 5.2633, lr_0 = 5.9500e-04
Validation auc = 0.317757
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.213838
Epoch 1
Loss = 1.9879e-01, PNorm = 37.3013, GNorm = 1.6850, lr_0 = 8.2000e-04
Loss = 1.2688e-01, PNorm = 37.3806, GNorm = 0.8492, lr_0 = 9.9521e-04
Loss = 4.1690e-03, PNorm = 37.3870, GNorm = 0.1014, lr_0 = 9.9283e-04
Validation auc = 0.287717
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229206
Epoch 2
Loss = 4.9031e-02, PNorm = 37.4148, GNorm = 0.2705, lr_0 = 9.6930e-04
Loss = 9.9992e-02, PNorm = 37.4544, GNorm = 1.2336, lr_0 = 9.4633e-04
Loss = 9.2829e-03, PNorm = 37.4576, GNorm = 0.1544, lr_0 = 9.4406e-04
Validation auc = 0.339119
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.217007
Epoch 3
Loss = 4.3521e-02, PNorm = 37.4850, GNorm = 0.4901, lr_0 = 9.2169e-04
Loss = 6.3492e-02, PNorm = 37.5002, GNorm = 0.4532, lr_0 = 8.9984e-04
Loss = 1.3472e-02, PNorm = 37.5018, GNorm = 0.4351, lr_0 = 8.9769e-04
Validation auc = 0.388518
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.210896
Epoch 4
Loss = 4.1781e-02, PNorm = 37.5213, GNorm = 0.8595, lr_0 = 8.7641e-04
Loss = 6.4746e-02, PNorm = 37.5405, GNorm = 0.7061, lr_0 = 8.5564e-04
Loss = 5.8441e-03, PNorm = 37.5441, GNorm = 0.0754, lr_0 = 8.5359e-04
Validation auc = 0.384513
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.236884
Epoch 5
Loss = 5.6670e-02, PNorm = 37.5524, GNorm = 0.7012, lr_0 = 8.3336e-04
Loss = 4.2109e-02, PNorm = 37.5601, GNorm = 0.7363, lr_0 = 8.1361e-04
Loss = 4.9921e-02, PNorm = 37.5625, GNorm = 1.9023, lr_0 = 8.1166e-04
Validation auc = 0.389186
Validation accuracy = 0.954751
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.217224
Epoch 6
Loss = 3.3782e-02, PNorm = 37.5927, GNorm = 1.2230, lr_0 = 7.9243e-04
Loss = 6.6783e-02, PNorm = 37.6014, GNorm = 1.3005, lr_0 = 7.7364e-04
Loss = 1.6892e-01, PNorm = 37.6034, GNorm = 4.2260, lr_0 = 7.7179e-04
Validation auc = 0.400534
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.220034
Epoch 7
Loss = 3.3106e-02, PNorm = 37.6193, GNorm = 0.6830, lr_0 = 7.5350e-04
Loss = 6.6956e-02, PNorm = 37.6202, GNorm = 1.1431, lr_0 = 7.3564e-04
Loss = 9.6142e-04, PNorm = 37.6201, GNorm = 0.0336, lr_0 = 7.3388e-04
Validation auc = 0.390521
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.223580
Epoch 8
Loss = 4.4601e-02, PNorm = 37.6302, GNorm = 0.7820, lr_0 = 7.1649e-04
Loss = 5.1917e-02, PNorm = 37.6362, GNorm = 0.4057, lr_0 = 6.9951e-04
Loss = 4.3296e-03, PNorm = 37.6368, GNorm = 0.0914, lr_0 = 6.9783e-04
Validation auc = 0.399199
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.219564
Epoch 9
Loss = 4.5947e-02, PNorm = 37.6488, GNorm = 0.2842, lr_0 = 6.8129e-04
Loss = 4.2803e-02, PNorm = 37.6573, GNorm = 0.0365, lr_0 = 6.6515e-04
Validation auc = 0.403204
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.220213
Epoch 10
Loss = 3.5464e-02, PNorm = 37.6735, GNorm = 0.5162, lr_0 = 6.4938e-04
Loss = 3.8036e-02, PNorm = 37.6809, GNorm = 0.0220, lr_0 = 6.3399e-04
Validation auc = 0.380507
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.228054
Epoch 11
Loss = 3.8430e-02, PNorm = 37.6868, GNorm = 0.4078, lr_0 = 6.1748e-04
Loss = 3.4632e-02, PNorm = 37.6986, GNorm = 0.6380, lr_0 = 6.0285e-04
Validation auc = 0.399199
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.228994
Epoch 12
Loss = 3.8981e-02, PNorm = 37.7062, GNorm = 0.5353, lr_0 = 5.8715e-04
Loss = 4.4772e-02, PNorm = 37.7130, GNorm = 0.4870, lr_0 = 5.7324e-04
Validation auc = 0.405207
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.224412
Epoch 13
Loss = 2.4497e-02, PNorm = 37.7229, GNorm = 0.6003, lr_0 = 5.5831e-04
Loss = 4.6123e-02, PNorm = 37.7380, GNorm = 0.6849, lr_0 = 5.4508e-04
Validation auc = 0.405207
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.239994
Epoch 14
Loss = 3.1910e-02, PNorm = 37.7304, GNorm = 0.5635, lr_0 = 5.3088e-04
Loss = 5.3863e-02, PNorm = 37.7456, GNorm = 0.5375, lr_0 = 5.1830e-04
Validation auc = 0.409880
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.228327
Epoch 15
Loss = 3.2507e-02, PNorm = 37.7575, GNorm = 0.9373, lr_0 = 5.0481e-04
Loss = 4.1026e-02, PNorm = 37.7696, GNorm = 0.0392, lr_0 = 4.9284e-04
Validation auc = 0.399866
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.239614
Epoch 16
Loss = 3.1344e-02, PNorm = 37.7760, GNorm = 0.9837, lr_0 = 4.8001e-04
Loss = 2.6736e-02, PNorm = 37.7809, GNorm = 0.7663, lr_0 = 4.6863e-04
Validation auc = 0.411883
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.228417
Epoch 17
Loss = 2.2967e-02, PNorm = 37.7900, GNorm = 0.0155, lr_0 = 4.5643e-04
Loss = 4.0388e-02, PNorm = 37.7955, GNorm = 0.7334, lr_0 = 4.4561e-04
Validation auc = 0.412550
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.234201
Epoch 18
Loss = 2.9866e-02, PNorm = 37.8068, GNorm = 0.8611, lr_0 = 4.3401e-04
Loss = 3.4712e-02, PNorm = 37.8090, GNorm = 0.5211, lr_0 = 4.2372e-04
Validation auc = 0.410547
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.233191
Epoch 19
Loss = 2.5274e-02, PNorm = 37.8185, GNorm = 0.3525, lr_0 = 4.1269e-04
Loss = 3.7736e-02, PNorm = 37.8200, GNorm = 0.4726, lr_0 = 4.0291e-04
Validation auc = 0.412550
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.232533
Epoch 20
Loss = 2.6476e-02, PNorm = 37.8270, GNorm = 0.4763, lr_0 = 3.9336e-04
Loss = 2.6245e-02, PNorm = 37.8418, GNorm = 0.9739, lr_0 = 3.8404e-04
Validation auc = 0.413218
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.240130
Epoch 21
Loss = 3.1121e-02, PNorm = 37.8411, GNorm = 0.5849, lr_0 = 3.7404e-04
Loss = 3.0801e-02, PNorm = 37.8425, GNorm = 0.4588, lr_0 = 3.6517e-04
Validation auc = 0.423231
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229743
Epoch 22
Loss = 3.4429e-02, PNorm = 37.8567, GNorm = 0.7848, lr_0 = 3.5567e-04
Loss = 4.1091e-02, PNorm = 37.8642, GNorm = 0.8805, lr_0 = 3.4724e-04
Validation auc = 0.424566
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.239266
Epoch 23
Loss = 2.2115e-02, PNorm = 37.8627, GNorm = 0.2427, lr_0 = 3.3819e-04
Loss = 3.2611e-02, PNorm = 37.8720, GNorm = 0.4017, lr_0 = 3.3018e-04
Validation auc = 0.428571
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.236223
Epoch 24
Loss = 2.3642e-02, PNorm = 37.8891, GNorm = 0.6482, lr_0 = 3.2158e-04
Loss = 3.5310e-02, PNorm = 37.8930, GNorm = 0.2653, lr_0 = 3.1396e-04
Validation auc = 0.437917
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.242608
Epoch 25
Loss = 4.1224e-02, PNorm = 37.8959, GNorm = 1.0889, lr_0 = 3.0579e-04
Loss = 3.1654e-02, PNorm = 37.8946, GNorm = 1.0759, lr_0 = 2.9854e-04
Validation auc = 0.445260
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229182
Epoch 26
Loss = 3.0660e-02, PNorm = 37.9047, GNorm = 0.4353, lr_0 = 2.9076e-04
Loss = 2.9193e-02, PNorm = 37.9155, GNorm = 0.4627, lr_0 = 2.8387e-04
Validation auc = 0.443925
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.237699
Epoch 27
Loss = 2.9785e-02, PNorm = 37.9138, GNorm = 0.7116, lr_0 = 2.7648e-04
Loss = 2.6183e-02, PNorm = 37.9172, GNorm = 0.4567, lr_0 = 2.6993e-04
Validation auc = 0.450601
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.227015
Epoch 28
Loss = 2.2459e-02, PNorm = 37.9286, GNorm = 0.9441, lr_0 = 2.6290e-04
Loss = 3.1914e-02, PNorm = 37.9431, GNorm = 0.0065, lr_0 = 2.5667e-04
Validation auc = 0.460614
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.235856
Epoch 29
Loss = 2.5869e-02, PNorm = 37.9371, GNorm = 0.6558, lr_0 = 2.4999e-04
Loss = 2.2841e-02, PNorm = 37.9475, GNorm = 0.0223, lr_0 = 2.4406e-04
Validation auc = 0.461282
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.223145
Epoch 30
Loss = 1.9145e-02, PNorm = 37.9635, GNorm = 0.0218, lr_0 = 2.3828e-04
Loss = 3.9845e-02, PNorm = 37.9749, GNorm = 0.5361, lr_0 = 2.3263e-04
Validation auc = 0.489319
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.228502
Epoch 31
Loss = 1.9315e-02, PNorm = 37.9872, GNorm = 0.4039, lr_0 = 2.2657e-04
Loss = 4.1038e-02, PNorm = 37.9925, GNorm = 1.0052, lr_0 = 2.2120e-04
Validation auc = 0.490654
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.230292
Epoch 32
Loss = 2.6015e-02, PNorm = 37.9947, GNorm = 0.7047, lr_0 = 2.1544e-04
Loss = 2.3718e-02, PNorm = 38.0012, GNorm = 0.2453, lr_0 = 2.1034e-04
Validation auc = 0.495327
Validation accuracy = 0.963801
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.228610
Epoch 33
Loss = 3.4519e-02, PNorm = 38.0060, GNorm = 0.4280, lr_0 = 2.0486e-04
Loss = 2.0868e-02, PNorm = 38.0112, GNorm = 0.0115, lr_0 = 2.0001e-04
Validation auc = 0.506676
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.230410
Epoch 34
Loss = 5.1823e-02, PNorm = 38.0138, GNorm = 0.9960, lr_0 = 1.9480e-04
Loss = 1.9264e-02, PNorm = 38.0181, GNorm = 0.0180, lr_0 = 1.9018e-04
Validation auc = 0.510681
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.223832
Epoch 35
Loss = 2.3621e-02, PNorm = 38.0195, GNorm = 0.3981, lr_0 = 1.8523e-04
Loss = 4.4787e-02, PNorm = 38.0288, GNorm = 0.4458, lr_0 = 1.8084e-04
Validation auc = 0.534713
Validation accuracy = 0.959276
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.218102
Epoch 36
Loss = 1.4466e-02, PNorm = 38.0411, GNorm = 0.5642, lr_0 = 1.7613e-04
Loss = 3.9364e-02, PNorm = 38.0494, GNorm = 0.4309, lr_0 = 1.7196e-04
Validation auc = 0.564753
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.223725
Epoch 37
Loss = 2.2872e-02, PNorm = 38.0567, GNorm = 0.0128, lr_0 = 1.6748e-04
Loss = 3.6286e-02, PNorm = 38.0598, GNorm = 0.0190, lr_0 = 1.6351e-04
Validation auc = 0.572764
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.230145
Epoch 38
Loss = 2.6587e-02, PNorm = 38.0624, GNorm = 0.3654, lr_0 = 1.5925e-04
Loss = 2.3340e-02, PNorm = 38.0636, GNorm = 0.0082, lr_0 = 1.5548e-04
Validation auc = 0.576769
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229217
Epoch 39
Loss = 2.2637e-02, PNorm = 38.0738, GNorm = 0.7216, lr_0 = 1.5143e-04
Loss = 2.8817e-02, PNorm = 38.0761, GNorm = 0.0218, lr_0 = 1.4784e-04
Validation auc = 0.578104
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.242850
Epoch 40
Loss = 7.7254e-03, PNorm = 38.0762, GNorm = 0.0144, lr_0 = 1.4434e-04
Loss = 4.7689e-02, PNorm = 38.0753, GNorm = 0.5395, lr_0 = 1.4092e-04
Validation auc = 0.568091
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.236892
Epoch 41
Loss = 3.9817e-02, PNorm = 38.0760, GNorm = 0.6255, lr_0 = 1.3725e-04
Loss = 2.0768e-02, PNorm = 38.0752, GNorm = 0.0600, lr_0 = 1.3399e-04
Validation auc = 0.564085
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.232866
Epoch 42
Loss = 1.2062e-02, PNorm = 38.0774, GNorm = 0.3526, lr_0 = 1.3050e-04
Loss = 2.4869e-02, PNorm = 38.0798, GNorm = 0.7326, lr_0 = 1.2741e-04
Validation auc = 0.570761
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.234860
Epoch 43
Loss = 1.4214e-02, PNorm = 38.0859, GNorm = 0.3257, lr_0 = 1.2409e-04
Loss = 3.0838e-02, PNorm = 38.0896, GNorm = 0.2922, lr_0 = 1.2115e-04
Validation auc = 0.584112
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.241423
Epoch 44
Loss = 2.7643e-02, PNorm = 38.0848, GNorm = 0.0109, lr_0 = 1.1800e-04
Loss = 2.5961e-02, PNorm = 38.0815, GNorm = 0.8345, lr_0 = 1.1520e-04
Validation auc = 0.561415
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.222533
Epoch 45
Loss = 2.8952e-02, PNorm = 38.0854, GNorm = 0.0066, lr_0 = 1.1220e-04
Loss = 3.0640e-02, PNorm = 38.0891, GNorm = 0.5365, lr_0 = 1.0954e-04
Validation auc = 0.561415
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.226045
Epoch 46
Loss = 1.9008e-02, PNorm = 38.0919, GNorm = 0.0097, lr_0 = 1.0669e-04
Loss = 2.2885e-02, PNorm = 38.0937, GNorm = 0.7557, lr_0 = 1.0416e-04
Validation auc = 0.561415
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.226891
Epoch 47
Loss = 2.1223e-02, PNorm = 38.0975, GNorm = 0.1496, lr_0 = 1.0145e-04
Loss = 2.9659e-02, PNorm = 38.0986, GNorm = 0.4602, lr_0 = 1.0000e-04
Validation auc = 0.564085
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.228781
Epoch 48
Loss = 2.2506e-02, PNorm = 38.1008, GNorm = 0.3190, lr_0 = 1.0000e-04
Loss = 2.8937e-02, PNorm = 38.1024, GNorm = 0.9161, lr_0 = 1.0000e-04
Validation auc = 0.570093
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.229640
Epoch 49
Loss = 1.8563e-02, PNorm = 38.1048, GNorm = 0.3417, lr_0 = 1.0000e-04
Loss = 2.0575e-02, PNorm = 38.1074, GNorm = 0.0058, lr_0 = 1.0000e-04
Validation auc = 0.571429
Validation accuracy = 0.968326
Validation f1 = 0.000000
Validation binary_cross_entropy = 0.232192
Model 0 best validation auc = 0.584112 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.767909
Model 0 test accuracy = 0.904762
Model 0 test f1 = 0.250000
Model 0 test binary_cross_entropy = 0.507317
Ensemble test auc = 0.767909
Ensemble test accuracy = 0.904762
Ensemble test f1 = 0.250000
Ensemble test binary_cross_entropy = 0.507317
5-fold cross validation
	Seed 0 ==> test auc = 0.808405
	Seed 0 ==> test accuracy = 0.900794
	Seed 0 ==> test f1 = 0.242424
	Seed 0 ==> test binary_cross_entropy = 0.449051
	Seed 1 ==> test auc = 0.742358
	Seed 1 ==> test accuracy = 0.876984
	Seed 1 ==> test f1 = 0.162162
	Seed 1 ==> test binary_cross_entropy = 0.618175
	Seed 2 ==> test auc = 0.814978
	Seed 2 ==> test accuracy = 0.896825
	Seed 2 ==> test f1 = 0.235294
	Seed 2 ==> test binary_cross_entropy = 0.509142
	Seed 3 ==> test auc = 0.799750
	Seed 3 ==> test accuracy = 0.920635
	Seed 3 ==> test f1 = 0.285714
	Seed 3 ==> test binary_cross_entropy = 0.434853
	Seed 4 ==> test auc = 0.767909
	Seed 4 ==> test accuracy = 0.904762
	Seed 4 ==> test f1 = 0.250000
	Seed 4 ==> test binary_cross_entropy = 0.507317
Overall test auc = 0.786680 +/- 0.027424
Overall test accuracy = 0.900000 +/- 0.014064
Overall test f1 = 0.235119 +/- 0.040392
Overall test binary_cross_entropy = 0.503708 +/- 0.064612
Elapsed time = 0:03:22
