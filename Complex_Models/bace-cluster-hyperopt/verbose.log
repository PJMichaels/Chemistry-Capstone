Command line
python /home/ddunstan/.conda/envs/chemprop/bin/chemprop_train --data_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-cluster-train.csv --dataset_type classification --save_dir /home/ddunstan/Chemistry-Capstone/Complex_Models/bace-cluster-hyperopt --epochs 50 --extra_metrics accuracy f1 binary_cross_entropy --metric auc --target_columns active --smiles_columns mol --num_folds 5 --split_sizes 0.8 0 0.2 --separate_val_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-cluster-validate.csv --features_generator morgan --num_workers 1 --config_path /home/ddunstan/Chemistry-Capstone/Complex_Models/bace-cluster-hyperopt/hyper_param.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/ddunstan/Chemistry-Capstone/Complex_Models/bace-cluster-hyperopt/hyper_param.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-cluster-train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 6,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy', 'f1', 'binary_cross_entropy'],
 'features_generator': ['morgan'],
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy', 'f1', 'binary_cross_entropy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 1,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/ddunstan/Chemistry-Capstone/Complex_Models/bace-cluster-hyperopt',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-cluster-validate.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['mol'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.0, 0.2],
 'split_type': 'random',
 'target_columns': ['active'],
 'target_weights': None,
 'task_names': ['active'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 7.0337e-01, PNorm = 66.2996, GNorm = 4.5169, lr_0 = 3.4750e-04
Loss = 5.0987e-01, PNorm = 66.3530, GNorm = 4.0176, lr_0 = 5.7250e-04
Loss = 5.2501e-01, PNorm = 66.3602, GNorm = 4.9267, lr_0 = 5.9500e-04
Validation auc = 0.663656
Validation accuracy = 0.597345
Validation f1 = 0.685121
Validation binary_cross_entropy = 0.649843
Epoch 1
Loss = 2.9765e-01, PNorm = 66.4563, GNorm = 3.0630, lr_0 = 8.2000e-04
Loss = 3.3455e-01, PNorm = 66.5758, GNorm = 3.5234, lr_0 = 9.9521e-04
Validation auc = 0.583274
Validation accuracy = 0.579646
Validation f1 = 0.690554
Validation binary_cross_entropy = 0.789180
Epoch 2
Loss = 1.8898e-01, PNorm = 66.6928, GNorm = 2.3239, lr_0 = 9.7163e-04
Loss = 2.0774e-01, PNorm = 66.7865, GNorm = 2.8495, lr_0 = 9.4860e-04
Validation auc = 0.551507
Validation accuracy = 0.707965
Validation f1 = 0.819672
Validation binary_cross_entropy = 0.931544
Epoch 3
Loss = 1.2812e-01, PNorm = 66.8755, GNorm = 1.7142, lr_0 = 9.2390e-04
Loss = 1.8982e-01, PNorm = 66.9349, GNorm = 3.2426, lr_0 = 9.0200e-04
Validation auc = 0.527860
Validation accuracy = 0.699115
Validation f1 = 0.813187
Validation binary_cross_entropy = 1.166271
Epoch 4
Loss = 1.2856e-01, PNorm = 66.9865, GNorm = 1.4198, lr_0 = 8.8063e-04
Loss = 1.7909e-01, PNorm = 67.0312, GNorm = 2.6667, lr_0 = 8.5976e-04
Validation auc = 0.543286
Validation accuracy = 0.694690
Validation f1 = 0.810959
Validation binary_cross_entropy = 1.111230
Epoch 5
Loss = 1.4158e-01, PNorm = 67.0821, GNorm = 2.4090, lr_0 = 8.3737e-04
Loss = 8.6241e-02, PNorm = 67.1198, GNorm = 1.1750, lr_0 = 8.1752e-04
Validation auc = 0.585405
Validation accuracy = 0.650442
Validation f1 = 0.761329
Validation binary_cross_entropy = 1.061485
Epoch 6
Loss = 1.2488e-01, PNorm = 67.1537, GNorm = 1.9663, lr_0 = 7.9815e-04
Loss = 8.7207e-02, PNorm = 67.1836, GNorm = 0.9080, lr_0 = 7.7923e-04
Validation auc = 0.575053
Validation accuracy = 0.676991
Validation f1 = 0.793201
Validation binary_cross_entropy = 1.138656
Epoch 7
Loss = 8.6092e-02, PNorm = 67.2104, GNorm = 1.5948, lr_0 = 7.6076e-04
Loss = 8.9943e-02, PNorm = 67.2377, GNorm = 1.6493, lr_0 = 7.4273e-04
Validation auc = 0.542474
Validation accuracy = 0.597345
Validation f1 = 0.720000
Validation binary_cross_entropy = 1.272079
Epoch 8
Loss = 4.8168e-02, PNorm = 67.2675, GNorm = 0.9095, lr_0 = 7.2339e-04
Loss = 9.8724e-02, PNorm = 67.2953, GNorm = 2.3399, lr_0 = 7.0625e-04
Validation auc = 0.578707
Validation accuracy = 0.654867
Validation f1 = 0.769231
Validation binary_cross_entropy = 1.245104
Epoch 9
Loss = 7.0730e-02, PNorm = 67.3158, GNorm = 2.1806, lr_0 = 6.8951e-04
Loss = 1.0087e-01, PNorm = 67.3349, GNorm = 1.0609, lr_0 = 6.7317e-04
Validation auc = 0.588755
Validation accuracy = 0.650442
Validation f1 = 0.758410
Validation binary_cross_entropy = 1.307841
Epoch 10
Loss = 7.7331e-02, PNorm = 67.3572, GNorm = 0.3154, lr_0 = 6.5564e-04
Loss = 8.4901e-02, PNorm = 67.3782, GNorm = 2.0004, lr_0 = 6.4010e-04
Validation auc = 0.586319
Validation accuracy = 0.668142
Validation f1 = 0.778761
Validation binary_cross_entropy = 1.343121
Epoch 11
Loss = 3.5913e-02, PNorm = 67.3960, GNorm = 1.0758, lr_0 = 6.2493e-04
Loss = 9.3721e-02, PNorm = 67.4125, GNorm = 1.1811, lr_0 = 6.1012e-04
Validation auc = 0.633817
Validation accuracy = 0.668142
Validation f1 = 0.774775
Validation binary_cross_entropy = 1.284688
Epoch 12
Loss = 3.8496e-02, PNorm = 67.4322, GNorm = 0.5536, lr_0 = 5.9424e-04
Loss = 9.0705e-02, PNorm = 67.4488, GNorm = 0.8525, lr_0 = 5.8015e-04
Validation auc = 0.633919
Validation accuracy = 0.681416
Validation f1 = 0.784431
Validation binary_cross_entropy = 1.242609
Epoch 13
Loss = 4.9474e-02, PNorm = 67.4631, GNorm = 0.9806, lr_0 = 5.6640e-04
Loss = 5.0502e-02, PNorm = 67.4775, GNorm = 0.3346, lr_0 = 5.5298e-04
Validation auc = 0.617274
Validation accuracy = 0.690265
Validation f1 = 0.792899
Validation binary_cross_entropy = 1.308336
Epoch 14
Loss = 9.3891e-02, PNorm = 67.4902, GNorm = 1.3319, lr_0 = 5.3987e-04
Loss = 8.0237e-02, PNorm = 67.5011, GNorm = 1.1970, lr_0 = 5.2708e-04
Validation auc = 0.638689
Validation accuracy = 0.654867
Validation f1 = 0.759259
Validation binary_cross_entropy = 1.295652
Epoch 15
Loss = 9.7090e-02, PNorm = 67.5131, GNorm = 1.8048, lr_0 = 5.1335e-04
Loss = 5.9081e-02, PNorm = 67.5274, GNorm = 0.2796, lr_0 = 5.0119e-04
Validation auc = 0.615295
Validation accuracy = 0.699115
Validation f1 = 0.801170
Validation binary_cross_entropy = 1.309377
Epoch 16
Loss = 2.4109e-02, PNorm = 67.5389, GNorm = 0.5712, lr_0 = 4.8931e-04
Loss = 3.5305e-02, PNorm = 67.5487, GNorm = 0.7404, lr_0 = 4.7771e-04
Validation auc = 0.587232
Validation accuracy = 0.659292
Validation f1 = 0.765957
Validation binary_cross_entropy = 1.474032
Epoch 17
Loss = 3.7511e-02, PNorm = 67.5580, GNorm = 0.8155, lr_0 = 4.6527e-04
Loss = 7.0362e-02, PNorm = 67.5655, GNorm = 0.4613, lr_0 = 4.5425e-04
Loss = 4.7729e-02, PNorm = 67.5746, GNorm = 1.2591, lr_0 = 4.4348e-04
Validation auc = 0.601441
Validation accuracy = 0.654867
Validation f1 = 0.762195
Validation binary_cross_entropy = 1.437764
Epoch 18
Loss = 5.8745e-02, PNorm = 67.5843, GNorm = 0.1024, lr_0 = 4.3297e-04
Loss = 4.7218e-02, PNorm = 67.5922, GNorm = 0.7844, lr_0 = 4.2271e-04
Validation auc = 0.606516
Validation accuracy = 0.663717
Validation f1 = 0.771084
Validation binary_cross_entropy = 1.401297
Epoch 19
Loss = 2.9338e-02, PNorm = 67.5991, GNorm = 0.9917, lr_0 = 4.1269e-04
Loss = 4.2212e-02, PNorm = 67.6061, GNorm = 0.9045, lr_0 = 4.0291e-04
Validation auc = 0.610119
Validation accuracy = 0.681416
Validation f1 = 0.784431
Validation binary_cross_entropy = 1.412950
Epoch 20
Loss = 6.8125e-02, PNorm = 67.6132, GNorm = 0.3031, lr_0 = 3.9242e-04
Loss = 3.5121e-02, PNorm = 67.6202, GNorm = 0.2423, lr_0 = 3.8312e-04
Validation auc = 0.589008
Validation accuracy = 0.668142
Validation f1 = 0.776119
Validation binary_cross_entropy = 1.473246
Epoch 21
Loss = 5.7387e-02, PNorm = 67.6264, GNorm = 0.0900, lr_0 = 3.7404e-04
Loss = 3.4450e-02, PNorm = 67.6327, GNorm = 0.9715, lr_0 = 3.6517e-04
Validation auc = 0.584898
Validation accuracy = 0.641593
Validation f1 = 0.752294
Validation binary_cross_entropy = 1.563253
Epoch 22
Loss = 4.5130e-02, PNorm = 67.6384, GNorm = 0.8951, lr_0 = 3.5567e-04
Loss = 6.3147e-02, PNorm = 67.6415, GNorm = 3.8585, lr_0 = 3.4724e-04
Validation auc = 0.590582
Validation accuracy = 0.628319
Validation f1 = 0.750000
Validation binary_cross_entropy = 1.583930
Epoch 23
Loss = 4.3915e-02, PNorm = 67.6486, GNorm = 0.2154, lr_0 = 3.3901e-04
Loss = 6.0453e-02, PNorm = 67.6530, GNorm = 0.6393, lr_0 = 3.3097e-04
Validation auc = 0.575865
Validation accuracy = 0.623894
Validation f1 = 0.746269
Validation binary_cross_entropy = 1.962513
Epoch 24
Loss = 2.6191e-02, PNorm = 67.6597, GNorm = 0.4561, lr_0 = 3.2235e-04
Loss = 7.0997e-02, PNorm = 67.6652, GNorm = 0.4260, lr_0 = 3.1471e-04
Validation auc = 0.596519
Validation accuracy = 0.646018
Validation f1 = 0.763314
Validation binary_cross_entropy = 1.459548
Epoch 25
Loss = 4.1974e-02, PNorm = 67.6705, GNorm = 2.0544, lr_0 = 3.0726e-04
Loss = 5.1561e-02, PNorm = 67.6762, GNorm = 0.7765, lr_0 = 2.9997e-04
Validation auc = 0.600223
Validation accuracy = 0.676991
Validation f1 = 0.788406
Validation binary_cross_entropy = 1.855594
Epoch 26
Loss = 4.7586e-02, PNorm = 67.6824, GNorm = 1.8445, lr_0 = 2.9286e-04
Loss = 3.6093e-02, PNorm = 67.6868, GNorm = 0.1715, lr_0 = 2.8592e-04
Validation auc = 0.600984
Validation accuracy = 0.690265
Validation f1 = 0.795322
Validation binary_cross_entropy = 1.902231
Epoch 27
Loss = 4.1373e-02, PNorm = 67.6901, GNorm = 1.0330, lr_0 = 2.7848e-04
Loss = 4.1228e-02, PNorm = 67.6931, GNorm = 1.4686, lr_0 = 2.7188e-04
Validation auc = 0.589516
Validation accuracy = 0.650442
Validation f1 = 0.766962
Validation binary_cross_entropy = 1.948672
Epoch 28
Loss = 5.5248e-02, PNorm = 67.6962, GNorm = 1.1881, lr_0 = 2.6544e-04
Loss = 4.8510e-02, PNorm = 67.6996, GNorm = 1.1273, lr_0 = 2.5914e-04
Validation auc = 0.587537
Validation accuracy = 0.663717
Validation f1 = 0.780347
Validation binary_cross_entropy = 1.919393
Epoch 29
Loss = 4.6509e-02, PNorm = 67.7042, GNorm = 1.2372, lr_0 = 2.5240e-04
Loss = 6.1508e-02, PNorm = 67.7077, GNorm = 1.5201, lr_0 = 2.4641e-04
Validation auc = 0.607328
Validation accuracy = 0.668142
Validation f1 = 0.777448
Validation binary_cross_entropy = 1.853431
Epoch 30
Loss = 2.1038e-02, PNorm = 67.7111, GNorm = 0.0802, lr_0 = 2.4057e-04
Loss = 3.1914e-02, PNorm = 67.7141, GNorm = 1.1378, lr_0 = 2.3487e-04
Validation auc = 0.607734
Validation accuracy = 0.654867
Validation f1 = 0.770588
Validation binary_cross_entropy = 1.509942
Epoch 31
Loss = 2.9493e-02, PNorm = 67.7162, GNorm = 0.6261, lr_0 = 2.2876e-04
Loss = 3.1860e-02, PNorm = 67.7195, GNorm = 1.1355, lr_0 = 2.2334e-04
Validation auc = 0.610829
Validation accuracy = 0.659292
Validation f1 = 0.775510
Validation binary_cross_entropy = 1.516409
Epoch 32
Loss = 1.4864e-02, PNorm = 67.7219, GNorm = 1.3614, lr_0 = 2.1804e-04
Loss = 3.3189e-02, PNorm = 67.7240, GNorm = 0.6245, lr_0 = 2.1288e-04
Validation auc = 0.607683
Validation accuracy = 0.650442
Validation f1 = 0.768328
Validation binary_cross_entropy = 1.546094
Epoch 33
Loss = 5.2462e-02, PNorm = 67.7261, GNorm = 1.2205, lr_0 = 2.0783e-04
Loss = 2.2078e-02, PNorm = 67.7287, GNorm = 0.5810, lr_0 = 2.0290e-04
Validation auc = 0.611590
Validation accuracy = 0.663717
Validation f1 = 0.775148
Validation binary_cross_entropy = 1.571129
Epoch 34
Loss = 1.2655e-02, PNorm = 67.7308, GNorm = 0.3159, lr_0 = 1.9762e-04
Loss = 3.3757e-02, PNorm = 67.7327, GNorm = 0.4757, lr_0 = 1.9294e-04
Loss = 2.3919e-02, PNorm = 67.7347, GNorm = 0.7067, lr_0 = 1.8836e-04
Validation auc = 0.611438
Validation accuracy = 0.659292
Validation f1 = 0.774194
Validation binary_cross_entropy = 2.007766
Epoch 35
Loss = 2.8521e-02, PNorm = 67.7367, GNorm = 0.0537, lr_0 = 1.8390e-04
Loss = 2.6142e-02, PNorm = 67.7387, GNorm = 1.1323, lr_0 = 1.7954e-04
Loss = 3.3223e-02, PNorm = 67.7389, GNorm = 0.9307, lr_0 = 1.7911e-04
Validation auc = 0.600071
Validation accuracy = 0.632743
Validation f1 = 0.752239
Validation binary_cross_entropy = 2.095995
Epoch 36
Loss = 3.2384e-02, PNorm = 67.7410, GNorm = 0.5247, lr_0 = 1.7487e-04
Loss = 3.9335e-02, PNorm = 67.7422, GNorm = 0.7863, lr_0 = 1.7072e-04
Validation auc = 0.598904
Validation accuracy = 0.672566
Validation f1 = 0.787356
Validation binary_cross_entropy = 2.109397
Epoch 37
Loss = 3.3609e-02, PNorm = 67.7435, GNorm = 1.0901, lr_0 = 1.6668e-04
Loss = 5.1182e-02, PNorm = 67.7451, GNorm = 1.2819, lr_0 = 1.6273e-04
Validation auc = 0.603319
Validation accuracy = 0.650442
Validation f1 = 0.769679
Validation binary_cross_entropy = 2.086321
Epoch 38
Loss = 3.5531e-02, PNorm = 67.7465, GNorm = 0.3017, lr_0 = 1.5887e-04
Loss = 3.0426e-02, PNorm = 67.7481, GNorm = 0.1621, lr_0 = 1.5510e-04
Validation auc = 0.603826
Validation accuracy = 0.650442
Validation f1 = 0.766962
Validation binary_cross_entropy = 2.066877
Epoch 39
Loss = 4.4661e-02, PNorm = 67.7499, GNorm = 0.0854, lr_0 = 1.5107e-04
Loss = 4.9316e-02, PNorm = 67.7511, GNorm = 1.3612, lr_0 = 1.4749e-04
Validation auc = 0.599767
Validation accuracy = 0.650442
Validation f1 = 0.766962
Validation binary_cross_entropy = 2.084371
Epoch 40
Loss = 3.4169e-02, PNorm = 67.7522, GNorm = 0.6544, lr_0 = 1.4399e-04
Loss = 4.1920e-02, PNorm = 67.7530, GNorm = 0.5730, lr_0 = 1.4058e-04
Validation auc = 0.598752
Validation accuracy = 0.654867
Validation f1 = 0.771930
Validation binary_cross_entropy = 2.067797
Epoch 41
Loss = 3.4574e-02, PNorm = 67.7539, GNorm = 0.9455, lr_0 = 1.3692e-04
Loss = 2.8151e-02, PNorm = 67.7550, GNorm = 1.3188, lr_0 = 1.3367e-04
Validation auc = 0.600173
Validation accuracy = 0.668142
Validation f1 = 0.783862
Validation binary_cross_entropy = 2.091751
Epoch 42
Loss = 1.9490e-02, PNorm = 67.7564, GNorm = 0.2440, lr_0 = 1.3050e-04
Loss = 3.4724e-02, PNorm = 67.7574, GNorm = 0.2926, lr_0 = 1.2741e-04
Validation auc = 0.602456
Validation accuracy = 0.654867
Validation f1 = 0.771930
Validation binary_cross_entropy = 2.090473
Epoch 43
Loss = 4.5686e-02, PNorm = 67.7586, GNorm = 0.7332, lr_0 = 1.2409e-04
Loss = 1.9338e-02, PNorm = 67.7596, GNorm = 0.5656, lr_0 = 1.2115e-04
Validation auc = 0.599208
Validation accuracy = 0.646018
Validation f1 = 0.763314
Validation binary_cross_entropy = 2.096590
Epoch 44
Loss = 3.0209e-02, PNorm = 67.7604, GNorm = 1.0504, lr_0 = 1.1828e-04
Loss = 3.2062e-02, PNorm = 67.7614, GNorm = 0.9171, lr_0 = 1.1548e-04
Validation auc = 0.603370
Validation accuracy = 0.659292
Validation f1 = 0.774194
Validation binary_cross_entropy = 2.076624
Epoch 45
Loss = 7.8446e-03, PNorm = 67.7623, GNorm = 0.0159, lr_0 = 1.1274e-04
Loss = 1.8252e-02, PNorm = 67.7633, GNorm = 0.2146, lr_0 = 1.1007e-04
Validation auc = 0.601695
Validation accuracy = 0.663717
Validation f1 = 0.777778
Validation binary_cross_entropy = 2.090703
Epoch 46
Loss = 2.4906e-02, PNorm = 67.7644, GNorm = 0.1283, lr_0 = 1.0720e-04
Loss = 3.4851e-02, PNorm = 67.7652, GNorm = 0.8501, lr_0 = 1.0466e-04
Validation auc = 0.600883
Validation accuracy = 0.654867
Validation f1 = 0.770588
Validation binary_cross_entropy = 2.111124
Epoch 47
Loss = 3.3402e-02, PNorm = 67.7660, GNorm = 0.1100, lr_0 = 1.0218e-04
Loss = 3.4039e-02, PNorm = 67.7663, GNorm = 0.0953, lr_0 = 1.0000e-04
Validation auc = 0.599208
Validation accuracy = 0.659292
Validation f1 = 0.774194
Validation binary_cross_entropy = 2.130467
Epoch 48
Loss = 4.4959e-02, PNorm = 67.7671, GNorm = 1.7780, lr_0 = 1.0000e-04
Loss = 3.2363e-02, PNorm = 67.7681, GNorm = 2.1883, lr_0 = 1.0000e-04
Validation auc = 0.602710
Validation accuracy = 0.654867
Validation f1 = 0.770588
Validation binary_cross_entropy = 2.130911
Epoch 49
Loss = 9.8713e-03, PNorm = 67.7692, GNorm = 0.1346, lr_0 = 1.0000e-04
Loss = 2.9729e-02, PNorm = 67.7701, GNorm = 0.2884, lr_0 = 1.0000e-04
Validation auc = 0.598346
Validation accuracy = 0.668142
Validation f1 = 0.783862
Validation binary_cross_entropy = 2.170670
Model 0 best validation auc = 0.663656 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.896018
Model 0 test accuracy = 0.829457
Model 0 test f1 = 0.865854
Model 0 test binary_cross_entropy = 0.401241
Ensemble test auc = 0.896018
Ensemble test accuracy = 0.829457
Ensemble test f1 = 0.865854
Ensemble test binary_cross_entropy = 0.401241
Fold 1
Splitting data with seed 1
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 7.1715e-01, PNorm = 66.3019, GNorm = 4.6399, lr_0 = 3.4750e-04
Loss = 5.3606e-01, PNorm = 66.3533, GNorm = 4.1057, lr_0 = 5.7250e-04
Loss = 5.2644e-01, PNorm = 66.3605, GNorm = 4.8216, lr_0 = 5.9500e-04
Validation auc = 0.632295
Validation accuracy = 0.654867
Validation f1 = 0.746753
Validation binary_cross_entropy = 0.648028
Epoch 1
Loss = 2.9473e-01, PNorm = 66.4583, GNorm = 2.5887, lr_0 = 8.2000e-04
Loss = 3.0913e-01, PNorm = 66.5769, GNorm = 3.8141, lr_0 = 9.9521e-04
Validation auc = 0.693190
Validation accuracy = 0.752212
Validation f1 = 0.841808
Validation binary_cross_entropy = 0.725718
Epoch 2
Loss = 1.9661e-01, PNorm = 66.7003, GNorm = 3.3618, lr_0 = 9.7163e-04
Loss = 2.4315e-01, PNorm = 66.7999, GNorm = 2.8646, lr_0 = 9.4860e-04
Validation auc = 0.703948
Validation accuracy = 0.765487
Validation f1 = 0.849858
Validation binary_cross_entropy = 0.851599
Epoch 3
Loss = 1.5188e-01, PNorm = 66.8974, GNorm = 1.9527, lr_0 = 9.2390e-04
Loss = 2.1548e-01, PNorm = 66.9627, GNorm = 1.1992, lr_0 = 9.0200e-04
Validation auc = 0.683447
Validation accuracy = 0.756637
Validation f1 = 0.845938
Validation binary_cross_entropy = 0.962312
Epoch 4
Loss = 1.5602e-01, PNorm = 67.0178, GNorm = 0.9278, lr_0 = 8.8063e-04
Loss = 1.3122e-01, PNorm = 67.0693, GNorm = 1.4420, lr_0 = 8.5976e-04
Validation auc = 0.745103
Validation accuracy = 0.721239
Validation f1 = 0.829268
Validation binary_cross_entropy = 1.113381
Epoch 5
Loss = 1.1156e-01, PNorm = 67.1111, GNorm = 1.7362, lr_0 = 8.3737e-04
Loss = 1.3921e-01, PNorm = 67.1480, GNorm = 1.5016, lr_0 = 8.1752e-04
Validation auc = 0.692885
Validation accuracy = 0.721239
Validation f1 = 0.817391
Validation binary_cross_entropy = 1.099696
Epoch 6
Loss = 8.9569e-02, PNorm = 67.1819, GNorm = 0.5214, lr_0 = 7.9815e-04
Loss = 1.0191e-01, PNorm = 67.2117, GNorm = 1.7713, lr_0 = 7.7923e-04
Validation auc = 0.713996
Validation accuracy = 0.730088
Validation f1 = 0.829132
Validation binary_cross_entropy = 1.230484
Epoch 7
Loss = 8.9567e-02, PNorm = 67.2380, GNorm = 1.3638, lr_0 = 7.6076e-04
Loss = 9.4938e-02, PNorm = 67.2614, GNorm = 0.4646, lr_0 = 7.4273e-04
Validation auc = 0.704658
Validation accuracy = 0.738938
Validation f1 = 0.833803
Validation binary_cross_entropy = 1.239586
Epoch 8
Loss = 1.1190e-01, PNorm = 67.2865, GNorm = 1.7282, lr_0 = 7.2339e-04
Loss = 9.3945e-02, PNorm = 67.3074, GNorm = 2.3227, lr_0 = 7.0625e-04
Validation auc = 0.692175
Validation accuracy = 0.738938
Validation f1 = 0.836565
Validation binary_cross_entropy = 1.373472
Epoch 9
Loss = 5.9271e-02, PNorm = 67.3298, GNorm = 1.4909, lr_0 = 6.8951e-04
Loss = 8.8278e-02, PNorm = 67.3500, GNorm = 1.3543, lr_0 = 6.7317e-04
Validation auc = 0.697453
Validation accuracy = 0.725664
Validation f1 = 0.825843
Validation binary_cross_entropy = 1.400420
Epoch 10
Loss = 7.2141e-02, PNorm = 67.3754, GNorm = 1.1559, lr_0 = 6.5564e-04
Loss = 8.5098e-02, PNorm = 67.3937, GNorm = 0.2244, lr_0 = 6.4010e-04
Validation auc = 0.705775
Validation accuracy = 0.743363
Validation f1 = 0.839779
Validation binary_cross_entropy = 1.419414
Epoch 11
Loss = 5.9750e-02, PNorm = 67.4092, GNorm = 0.2545, lr_0 = 6.2493e-04
Loss = 4.2344e-02, PNorm = 67.4265, GNorm = 1.2742, lr_0 = 6.1012e-04
Validation auc = 0.695829
Validation accuracy = 0.734513
Validation f1 = 0.834254
Validation binary_cross_entropy = 1.518954
Epoch 12
Loss = 9.5524e-02, PNorm = 67.4417, GNorm = 0.9526, lr_0 = 5.9424e-04
Loss = 5.6084e-02, PNorm = 67.4561, GNorm = 0.6931, lr_0 = 5.8015e-04
Validation auc = 0.700853
Validation accuracy = 0.716814
Validation f1 = 0.819209
Validation binary_cross_entropy = 1.410404
Epoch 13
Loss = 7.5129e-02, PNorm = 67.4723, GNorm = 1.1254, lr_0 = 5.6640e-04
Loss = 3.5109e-02, PNorm = 67.4891, GNorm = 0.1616, lr_0 = 5.5298e-04
Validation auc = 0.702933
Validation accuracy = 0.738938
Validation f1 = 0.837466
Validation binary_cross_entropy = 1.614971
Epoch 14
Loss = 4.9634e-02, PNorm = 67.5000, GNorm = 1.1029, lr_0 = 5.3987e-04
Loss = 6.3892e-02, PNorm = 67.5124, GNorm = 1.2010, lr_0 = 5.2708e-04
Validation auc = 0.719832
Validation accuracy = 0.734513
Validation f1 = 0.830508
Validation binary_cross_entropy = 1.512483
Epoch 15
Loss = 2.4430e-02, PNorm = 67.5285, GNorm = 0.5811, lr_0 = 5.1335e-04
Loss = 6.1259e-02, PNorm = 67.5423, GNorm = 0.9264, lr_0 = 5.0119e-04
Validation auc = 0.728103
Validation accuracy = 0.743363
Validation f1 = 0.837079
Validation binary_cross_entropy = 1.531863
Epoch 16
Loss = 6.9142e-03, PNorm = 67.5541, GNorm = 0.2645, lr_0 = 4.8931e-04
Loss = 5.6177e-02, PNorm = 67.5635, GNorm = 1.4472, lr_0 = 4.7771e-04
Validation auc = 0.708617
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 1.660557
Epoch 17
Loss = 4.2520e-02, PNorm = 67.5727, GNorm = 0.5674, lr_0 = 4.6527e-04
Loss = 9.0730e-02, PNorm = 67.5833, GNorm = 1.8016, lr_0 = 4.5425e-04
Loss = 5.4076e-02, PNorm = 67.5924, GNorm = 0.0792, lr_0 = 4.4348e-04
Validation auc = 0.710291
Validation accuracy = 0.716814
Validation f1 = 0.819209
Validation binary_cross_entropy = 2.010097
Epoch 18
Loss = 4.9295e-02, PNorm = 67.6027, GNorm = 0.8163, lr_0 = 4.3297e-04
Loss = 4.3626e-02, PNorm = 67.6100, GNorm = 0.3069, lr_0 = 4.2271e-04
Validation auc = 0.694509
Validation accuracy = 0.712389
Validation f1 = 0.818942
Validation binary_cross_entropy = 2.501229
Epoch 19
Loss = 4.9133e-02, PNorm = 67.6160, GNorm = 1.2103, lr_0 = 4.1269e-04
Loss = 3.9001e-02, PNorm = 67.6230, GNorm = 0.3524, lr_0 = 4.0291e-04
Validation auc = 0.702933
Validation accuracy = 0.712389
Validation f1 = 0.816901
Validation binary_cross_entropy = 2.128611
Epoch 20
Loss = 4.3076e-02, PNorm = 67.6322, GNorm = 0.8395, lr_0 = 3.9242e-04
Loss = 3.6342e-02, PNorm = 67.6406, GNorm = 0.3083, lr_0 = 3.8312e-04
Validation auc = 0.706688
Validation accuracy = 0.707965
Validation f1 = 0.818681
Validation binary_cross_entropy = 3.005119
Epoch 21
Loss = 2.7822e-02, PNorm = 67.6475, GNorm = 1.0408, lr_0 = 3.7404e-04
Loss = 6.5728e-02, PNorm = 67.6539, GNorm = 1.1118, lr_0 = 3.6517e-04
Validation auc = 0.704303
Validation accuracy = 0.716814
Validation f1 = 0.824176
Validation binary_cross_entropy = 3.075742
Epoch 22
Loss = 5.4334e-02, PNorm = 67.6582, GNorm = 0.1118, lr_0 = 3.5567e-04
Loss = 3.7685e-02, PNorm = 67.6627, GNorm = 1.6147, lr_0 = 3.4724e-04
Validation auc = 0.688318
Validation accuracy = 0.694690
Validation f1 = 0.807799
Validation binary_cross_entropy = 2.295126
Epoch 23
Loss = 5.4056e-02, PNorm = 67.6667, GNorm = 1.3651, lr_0 = 3.3901e-04
Loss = 6.1127e-02, PNorm = 67.6722, GNorm = 0.6539, lr_0 = 3.3097e-04
Validation auc = 0.701817
Validation accuracy = 0.699115
Validation f1 = 0.808989
Validation binary_cross_entropy = 2.192113
Epoch 24
Loss = 2.5067e-02, PNorm = 67.6804, GNorm = 0.2400, lr_0 = 3.2235e-04
Loss = 4.3616e-02, PNorm = 67.6868, GNorm = 0.4441, lr_0 = 3.1471e-04
Validation auc = 0.698214
Validation accuracy = 0.707965
Validation f1 = 0.813559
Validation binary_cross_entropy = 2.194144
Epoch 25
Loss = 4.3450e-02, PNorm = 67.6915, GNorm = 1.2754, lr_0 = 3.0726e-04
Loss = 5.4445e-02, PNorm = 67.6975, GNorm = 0.9256, lr_0 = 2.9997e-04
Validation auc = 0.691211
Validation accuracy = 0.707965
Validation f1 = 0.815642
Validation binary_cross_entropy = 2.685617
Epoch 26
Loss = 2.2561e-02, PNorm = 67.7046, GNorm = 1.0852, lr_0 = 2.9286e-04
Loss = 3.4949e-02, PNorm = 67.7096, GNorm = 0.5091, lr_0 = 2.8592e-04
Validation auc = 0.686542
Validation accuracy = 0.707965
Validation f1 = 0.815642
Validation binary_cross_entropy = 2.706292
Epoch 27
Loss = 2.2901e-02, PNorm = 67.7143, GNorm = 0.6773, lr_0 = 2.7848e-04
Loss = 3.3250e-02, PNorm = 67.7172, GNorm = 0.0925, lr_0 = 2.7188e-04
Validation auc = 0.692378
Validation accuracy = 0.707965
Validation f1 = 0.813559
Validation binary_cross_entropy = 2.719425
Epoch 28
Loss = 2.4471e-02, PNorm = 67.7184, GNorm = 0.2083, lr_0 = 2.6544e-04
Loss = 2.1081e-02, PNorm = 67.7214, GNorm = 1.0340, lr_0 = 2.5914e-04
Validation auc = 0.686847
Validation accuracy = 0.707965
Validation f1 = 0.813559
Validation binary_cross_entropy = 2.784274
Epoch 29
Loss = 8.2259e-02, PNorm = 67.7248, GNorm = 0.8874, lr_0 = 2.5240e-04
Loss = 3.1873e-02, PNorm = 67.7277, GNorm = 0.5209, lr_0 = 2.4641e-04
Validation auc = 0.685578
Validation accuracy = 0.707965
Validation f1 = 0.813559
Validation binary_cross_entropy = 3.162330
Epoch 30
Loss = 6.1287e-02, PNorm = 67.7302, GNorm = 1.5626, lr_0 = 2.4057e-04
Loss = 3.2650e-02, PNorm = 67.7339, GNorm = 0.9603, lr_0 = 2.3487e-04
Validation auc = 0.684665
Validation accuracy = 0.703540
Validation f1 = 0.811268
Validation binary_cross_entropy = 3.524671
Epoch 31
Loss = 5.8467e-02, PNorm = 67.7379, GNorm = 2.2287, lr_0 = 2.2876e-04
Loss = 3.9863e-02, PNorm = 67.7404, GNorm = 0.8170, lr_0 = 2.2334e-04
Validation auc = 0.692682
Validation accuracy = 0.716814
Validation f1 = 0.818182
Validation binary_cross_entropy = 3.088064
Epoch 32
Loss = 6.4443e-02, PNorm = 67.7418, GNorm = 0.5674, lr_0 = 2.1804e-04
Loss = 2.2135e-02, PNorm = 67.7443, GNorm = 0.3312, lr_0 = 2.1288e-04
Validation auc = 0.696590
Validation accuracy = 0.721239
Validation f1 = 0.820513
Validation binary_cross_entropy = 3.025970
Epoch 33
Loss = 3.2000e-02, PNorm = 67.7476, GNorm = 2.1325, lr_0 = 2.0783e-04
Loss = 2.1240e-02, PNorm = 67.7514, GNorm = 0.0853, lr_0 = 2.0290e-04
Validation auc = 0.699076
Validation accuracy = 0.721239
Validation f1 = 0.824513
Validation binary_cross_entropy = 3.458858
Epoch 34
Loss = 3.6323e-02, PNorm = 67.7541, GNorm = 0.6387, lr_0 = 1.9762e-04
Loss = 2.9213e-02, PNorm = 67.7548, GNorm = 0.2097, lr_0 = 1.9294e-04
Loss = 5.2214e-02, PNorm = 67.7569, GNorm = 1.3200, lr_0 = 1.8836e-04
Validation auc = 0.695473
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 3.480767
Epoch 35
Loss = 1.8198e-02, PNorm = 67.7588, GNorm = 0.7942, lr_0 = 1.8390e-04
Loss = 3.0994e-02, PNorm = 67.7604, GNorm = 0.2070, lr_0 = 1.7954e-04
Loss = 1.2056e-02, PNorm = 67.7605, GNorm = 0.2808, lr_0 = 1.7911e-04
Validation auc = 0.699685
Validation accuracy = 0.725664
Validation f1 = 0.827778
Validation binary_cross_entropy = 3.502372
Epoch 36
Loss = 2.2550e-02, PNorm = 67.7619, GNorm = 0.6523, lr_0 = 1.7487e-04
Loss = 4.3702e-02, PNorm = 67.7631, GNorm = 0.6032, lr_0 = 1.7072e-04
Validation auc = 0.693596
Validation accuracy = 0.707965
Validation f1 = 0.815642
Validation binary_cross_entropy = 3.505687
Epoch 37
Loss = 2.5876e-02, PNorm = 67.7645, GNorm = 0.4695, lr_0 = 1.6668e-04
Loss = 3.9887e-02, PNorm = 67.7660, GNorm = 1.2078, lr_0 = 1.6273e-04
Validation auc = 0.692581
Validation accuracy = 0.703540
Validation f1 = 0.812325
Validation binary_cross_entropy = 3.519247
Epoch 38
Loss = 2.4437e-02, PNorm = 67.7675, GNorm = 0.6165, lr_0 = 1.5887e-04
Loss = 1.6426e-02, PNorm = 67.7695, GNorm = 0.3866, lr_0 = 1.5510e-04
Validation auc = 0.699635
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 3.523091
Epoch 39
Loss = 3.8239e-02, PNorm = 67.7717, GNorm = 0.7325, lr_0 = 1.5107e-04
Loss = 3.1770e-02, PNorm = 67.7727, GNorm = 1.1720, lr_0 = 1.4749e-04
Validation auc = 0.702223
Validation accuracy = 0.721239
Validation f1 = 0.824513
Validation binary_cross_entropy = 3.545831
Epoch 40
Loss = 3.3759e-02, PNorm = 67.7737, GNorm = 0.4645, lr_0 = 1.4399e-04
Loss = 3.7345e-02, PNorm = 67.7748, GNorm = 0.1261, lr_0 = 1.4058e-04
Validation auc = 0.699736
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 3.550348
Epoch 41
Loss = 4.3489e-02, PNorm = 67.7768, GNorm = 0.7198, lr_0 = 1.3692e-04
Loss = 2.3569e-02, PNorm = 67.7783, GNorm = 0.4829, lr_0 = 1.3367e-04
Validation auc = 0.699482
Validation accuracy = 0.707965
Validation f1 = 0.814607
Validation binary_cross_entropy = 3.600660
Epoch 42
Loss = 3.2016e-02, PNorm = 67.7795, GNorm = 0.1808, lr_0 = 1.3050e-04
Loss = 2.0927e-02, PNorm = 67.7806, GNorm = 0.8970, lr_0 = 1.2741e-04
Validation auc = 0.701614
Validation accuracy = 0.703540
Validation f1 = 0.811268
Validation binary_cross_entropy = 3.576496
Epoch 43
Loss = 2.0970e-02, PNorm = 67.7818, GNorm = 0.1702, lr_0 = 1.2409e-04
Loss = 3.0742e-02, PNorm = 67.7839, GNorm = 0.2667, lr_0 = 1.2115e-04
Validation auc = 0.707703
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 3.616307
Epoch 44
Loss = 4.1830e-02, PNorm = 67.7853, GNorm = 1.4013, lr_0 = 1.1828e-04
Loss = 1.6335e-02, PNorm = 67.7862, GNorm = 0.6178, lr_0 = 1.1548e-04
Validation auc = 0.708261
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 3.613396
Epoch 45
Loss = 1.9177e-02, PNorm = 67.7866, GNorm = 0.0169, lr_0 = 1.1274e-04
Loss = 4.0677e-02, PNorm = 67.7870, GNorm = 1.0975, lr_0 = 1.1007e-04
Validation auc = 0.705826
Validation accuracy = 0.707965
Validation f1 = 0.814607
Validation binary_cross_entropy = 3.607363
Epoch 46
Loss = 1.9837e-02, PNorm = 67.7880, GNorm = 0.7413, lr_0 = 1.0720e-04
Loss = 2.8494e-02, PNorm = 67.7889, GNorm = 0.1099, lr_0 = 1.0466e-04
Validation auc = 0.708211
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 3.989327
Epoch 47
Loss = 1.8576e-02, PNorm = 67.7899, GNorm = 1.5414, lr_0 = 1.0218e-04
Loss = 2.8688e-02, PNorm = 67.7910, GNorm = 0.4144, lr_0 = 1.0000e-04
Validation auc = 0.705064
Validation accuracy = 0.707965
Validation f1 = 0.815642
Validation binary_cross_entropy = 4.405682
Epoch 48
Loss = 6.9466e-03, PNorm = 67.7920, GNorm = 0.1676, lr_0 = 1.0000e-04
Loss = 2.4804e-02, PNorm = 67.7932, GNorm = 0.5714, lr_0 = 1.0000e-04
Validation auc = 0.707652
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 4.427794
Epoch 49
Loss = 4.5893e-02, PNorm = 67.7942, GNorm = 0.0956, lr_0 = 1.0000e-04
Loss = 2.7497e-02, PNorm = 67.7949, GNorm = 0.6047, lr_0 = 1.0000e-04
Validation auc = 0.707500
Validation accuracy = 0.721239
Validation f1 = 0.824513
Validation binary_cross_entropy = 4.434366
Model 0 best validation auc = 0.745103 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.923850
Model 0 test accuracy = 0.868217
Model 0 test f1 = 0.909574
Model 0 test binary_cross_entropy = 0.484307
Ensemble test auc = 0.923850
Ensemble test accuracy = 0.868217
Ensemble test f1 = 0.909574
Ensemble test binary_cross_entropy = 0.484307
Fold 2
Splitting data with seed 2
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 6.7837e-01, PNorm = 66.3018, GNorm = 4.4363, lr_0 = 3.4750e-04
Loss = 5.0101e-01, PNorm = 66.3546, GNorm = 3.8828, lr_0 = 5.7250e-04
Loss = 5.1359e-01, PNorm = 66.3613, GNorm = 6.6029, lr_0 = 5.9500e-04
Validation auc = 0.620826
Validation accuracy = 0.637168
Validation f1 = 0.733766
Validation binary_cross_entropy = 0.640151
Epoch 1
Loss = 3.3446e-01, PNorm = 66.4547, GNorm = 2.2132, lr_0 = 8.2000e-04
Loss = 2.7311e-01, PNorm = 66.5714, GNorm = 3.8723, lr_0 = 9.9521e-04
Validation auc = 0.645286
Validation accuracy = 0.725664
Validation f1 = 0.819767
Validation binary_cross_entropy = 0.681371
Epoch 2
Loss = 1.8786e-01, PNorm = 66.6909, GNorm = 2.1139, lr_0 = 9.7163e-04
Loss = 2.1396e-01, PNorm = 66.7859, GNorm = 2.7517, lr_0 = 9.4860e-04
Validation auc = 0.616665
Validation accuracy = 0.730088
Validation f1 = 0.830084
Validation binary_cross_entropy = 0.874806
Epoch 3
Loss = 1.5330e-01, PNorm = 66.8754, GNorm = 2.3220, lr_0 = 9.2390e-04
Loss = 1.2860e-01, PNorm = 66.9396, GNorm = 1.6021, lr_0 = 9.0200e-04
Validation auc = 0.614737
Validation accuracy = 0.730088
Validation f1 = 0.831956
Validation binary_cross_entropy = 1.058036
Epoch 4
Loss = 9.9052e-02, PNorm = 66.9946, GNorm = 1.2025, lr_0 = 8.8063e-04
Loss = 1.1971e-01, PNorm = 67.0434, GNorm = 1.2227, lr_0 = 8.5976e-04
Validation auc = 0.639095
Validation accuracy = 0.730088
Validation f1 = 0.829132
Validation binary_cross_entropy = 1.063556
Epoch 5
Loss = 1.1269e-01, PNorm = 67.0858, GNorm = 1.6382, lr_0 = 8.3737e-04
Loss = 1.5531e-01, PNorm = 67.1240, GNorm = 1.8308, lr_0 = 8.1752e-04
Validation auc = 0.635847
Validation accuracy = 0.716814
Validation f1 = 0.816092
Validation binary_cross_entropy = 1.031232
Epoch 6
Loss = 9.0802e-02, PNorm = 67.1572, GNorm = 2.6242, lr_0 = 7.9815e-04
Loss = 9.2610e-02, PNorm = 67.1910, GNorm = 0.6281, lr_0 = 7.7923e-04
Validation auc = 0.651223
Validation accuracy = 0.747788
Validation f1 = 0.837607
Validation binary_cross_entropy = 1.035823
Epoch 7
Loss = 7.0830e-02, PNorm = 67.2223, GNorm = 0.4607, lr_0 = 7.6076e-04
Loss = 1.0874e-01, PNorm = 67.2532, GNorm = 2.5160, lr_0 = 7.4273e-04
Validation auc = 0.650360
Validation accuracy = 0.738938
Validation f1 = 0.830946
Validation binary_cross_entropy = 1.092664
Epoch 8
Loss = 5.8626e-02, PNorm = 67.2812, GNorm = 1.4355, lr_0 = 7.2339e-04
Loss = 8.1063e-02, PNorm = 67.3044, GNorm = 0.7138, lr_0 = 7.0625e-04
Validation auc = 0.654115
Validation accuracy = 0.743363
Validation f1 = 0.835227
Validation binary_cross_entropy = 1.160946
Epoch 9
Loss = 7.1673e-02, PNorm = 67.3225, GNorm = 1.1281, lr_0 = 6.8951e-04
Loss = 6.5595e-02, PNorm = 67.3432, GNorm = 1.6413, lr_0 = 6.7317e-04
Validation auc = 0.661930
Validation accuracy = 0.743363
Validation f1 = 0.835227
Validation binary_cross_entropy = 1.228824
Epoch 10
Loss = 7.8683e-02, PNorm = 67.3610, GNorm = 0.1023, lr_0 = 6.5564e-04
Loss = 6.6291e-02, PNorm = 67.3772, GNorm = 1.6424, lr_0 = 6.4010e-04
Validation auc = 0.691972
Validation accuracy = 0.761062
Validation f1 = 0.844828
Validation binary_cross_entropy = 1.132104
Epoch 11
Loss = 6.0781e-02, PNorm = 67.3942, GNorm = 1.0112, lr_0 = 6.2493e-04
Loss = 7.6836e-02, PNorm = 67.4102, GNorm = 1.4795, lr_0 = 6.1012e-04
Validation auc = 0.658175
Validation accuracy = 0.738938
Validation f1 = 0.828986
Validation binary_cross_entropy = 1.259414
Epoch 12
Loss = 3.8952e-02, PNorm = 67.4270, GNorm = 0.9900, lr_0 = 5.9424e-04
Loss = 5.7843e-02, PNorm = 67.4421, GNorm = 1.9221, lr_0 = 5.8015e-04
Validation auc = 0.663960
Validation accuracy = 0.712389
Validation f1 = 0.820937
Validation binary_cross_entropy = 1.383633
Epoch 13
Loss = 4.0256e-02, PNorm = 67.4572, GNorm = 0.4836, lr_0 = 5.6640e-04
Loss = 6.6974e-02, PNorm = 67.4680, GNorm = 1.5572, lr_0 = 5.5298e-04
Validation auc = 0.677306
Validation accuracy = 0.747788
Validation f1 = 0.838527
Validation binary_cross_entropy = 1.322197
Epoch 14
Loss = 5.2586e-02, PNorm = 67.4801, GNorm = 0.2673, lr_0 = 5.3987e-04
Loss = 7.8539e-02, PNorm = 67.4939, GNorm = 1.2069, lr_0 = 5.2708e-04
Validation auc = 0.657871
Validation accuracy = 0.734513
Validation f1 = 0.828571
Validation binary_cross_entropy = 1.780120
Epoch 15
Loss = 3.2081e-02, PNorm = 67.5077, GNorm = 0.8190, lr_0 = 5.1335e-04
Loss = 4.5691e-02, PNorm = 67.5179, GNorm = 0.3800, lr_0 = 5.0119e-04
Validation auc = 0.655841
Validation accuracy = 0.734513
Validation f1 = 0.824561
Validation binary_cross_entropy = 1.820793
Epoch 16
Loss = 1.3970e-02, PNorm = 67.5275, GNorm = 0.3074, lr_0 = 4.8931e-04
Loss = 3.6011e-02, PNorm = 67.5386, GNorm = 0.1925, lr_0 = 4.7771e-04
Validation auc = 0.669796
Validation accuracy = 0.730088
Validation f1 = 0.823188
Validation binary_cross_entropy = 1.745941
Epoch 17
Loss = 5.5544e-02, PNorm = 67.5472, GNorm = 0.8877, lr_0 = 4.6527e-04
Loss = 4.4273e-02, PNorm = 67.5587, GNorm = 1.2688, lr_0 = 4.5425e-04
Loss = 7.8709e-02, PNorm = 67.5716, GNorm = 1.5763, lr_0 = 4.4348e-04
Validation auc = 0.652644
Validation accuracy = 0.738938
Validation f1 = 0.832861
Validation binary_cross_entropy = 1.819304
Epoch 18
Loss = 6.1265e-02, PNorm = 67.5834, GNorm = 1.0070, lr_0 = 4.3297e-04
Loss = 4.5264e-02, PNorm = 67.5939, GNorm = 1.2499, lr_0 = 4.2271e-04
Validation auc = 0.649853
Validation accuracy = 0.721239
Validation f1 = 0.818444
Validation binary_cross_entropy = 1.827155
Epoch 19
Loss = 4.6643e-02, PNorm = 67.6031, GNorm = 0.9639, lr_0 = 4.1269e-04
Loss = 7.5558e-02, PNorm = 67.6122, GNorm = 1.6382, lr_0 = 4.0291e-04
Validation auc = 0.637623
Validation accuracy = 0.725664
Validation f1 = 0.824859
Validation binary_cross_entropy = 1.996975
Epoch 20
Loss = 5.6077e-02, PNorm = 67.6223, GNorm = 1.2487, lr_0 = 3.9242e-04
Loss = 5.0182e-02, PNorm = 67.6290, GNorm = 1.2100, lr_0 = 3.8312e-04
Validation auc = 0.645387
Validation accuracy = 0.734513
Validation f1 = 0.828571
Validation binary_cross_entropy = 2.008803
Epoch 21
Loss = 4.5565e-02, PNorm = 67.6348, GNorm = 0.2252, lr_0 = 3.7404e-04
Loss = 2.2847e-02, PNorm = 67.6414, GNorm = 0.3212, lr_0 = 3.6517e-04
Validation auc = 0.637268
Validation accuracy = 0.716814
Validation f1 = 0.817143
Validation binary_cross_entropy = 2.034207
Epoch 22
Loss = 3.2186e-02, PNorm = 67.6490, GNorm = 0.3877, lr_0 = 3.5567e-04
Loss = 5.0857e-02, PNorm = 67.6552, GNorm = 0.1853, lr_0 = 3.4724e-04
Validation auc = 0.637725
Validation accuracy = 0.712389
Validation f1 = 0.814815
Validation binary_cross_entropy = 2.123945
Epoch 23
Loss = 3.5426e-02, PNorm = 67.6611, GNorm = 0.4299, lr_0 = 3.3901e-04
Loss = 2.9538e-02, PNorm = 67.6666, GNorm = 0.6474, lr_0 = 3.3097e-04
Validation auc = 0.631432
Validation accuracy = 0.707965
Validation f1 = 0.811429
Validation binary_cross_entropy = 2.122438
Epoch 24
Loss = 5.2871e-02, PNorm = 67.6719, GNorm = 0.6570, lr_0 = 3.2235e-04
Loss = 5.3638e-02, PNorm = 67.6757, GNorm = 0.3406, lr_0 = 3.1471e-04
Validation auc = 0.642698
Validation accuracy = 0.725664
Validation f1 = 0.822857
Validation binary_cross_entropy = 2.032660
Epoch 25
Loss = 1.7245e-02, PNorm = 67.6803, GNorm = 0.1543, lr_0 = 3.0726e-04
Loss = 3.8760e-02, PNorm = 67.6837, GNorm = 1.1971, lr_0 = 2.9997e-04
Validation auc = 0.648127
Validation accuracy = 0.721239
Validation f1 = 0.818444
Validation binary_cross_entropy = 2.082485
Epoch 26
Loss = 1.7755e-02, PNorm = 67.6870, GNorm = 0.2364, lr_0 = 2.9286e-04
Loss = 2.3598e-02, PNorm = 67.6908, GNorm = 0.3163, lr_0 = 2.8592e-04
Validation auc = 0.646656
Validation accuracy = 0.712389
Validation f1 = 0.811594
Validation binary_cross_entropy = 2.145122
Epoch 27
Loss = 8.0176e-02, PNorm = 67.6944, GNorm = 0.6368, lr_0 = 2.7848e-04
Loss = 4.4152e-02, PNorm = 67.6977, GNorm = 0.6905, lr_0 = 2.7188e-04
Validation auc = 0.618289
Validation accuracy = 0.694690
Validation f1 = 0.801153
Validation binary_cross_entropy = 2.240019
Epoch 28
Loss = 2.6496e-02, PNorm = 67.6997, GNorm = 0.4964, lr_0 = 2.6544e-04
Loss = 5.4774e-02, PNorm = 67.7030, GNorm = 0.4430, lr_0 = 2.5914e-04
Validation auc = 0.634629
Validation accuracy = 0.721239
Validation f1 = 0.822535
Validation binary_cross_entropy = 2.169147
Epoch 29
Loss = 1.5986e-02, PNorm = 67.7073, GNorm = 0.1560, lr_0 = 2.5240e-04
Loss = 3.5367e-02, PNorm = 67.7097, GNorm = 1.5205, lr_0 = 2.4641e-04
Validation auc = 0.650919
Validation accuracy = 0.712389
Validation f1 = 0.816901
Validation binary_cross_entropy = 2.136944
Epoch 30
Loss = 4.7884e-02, PNorm = 67.7130, GNorm = 0.7326, lr_0 = 2.4057e-04
Loss = 5.6923e-02, PNorm = 67.7153, GNorm = 0.5554, lr_0 = 2.3487e-04
Validation auc = 0.650665
Validation accuracy = 0.712389
Validation f1 = 0.813754
Validation binary_cross_entropy = 1.742517
Epoch 31
Loss = 2.7268e-02, PNorm = 67.7183, GNorm = 0.0861, lr_0 = 2.2876e-04
Loss = 4.5498e-02, PNorm = 67.7211, GNorm = 0.3914, lr_0 = 2.2334e-04
Validation auc = 0.636811
Validation accuracy = 0.707965
Validation f1 = 0.814607
Validation binary_cross_entropy = 2.256028
Epoch 32
Loss = 4.5354e-02, PNorm = 67.7244, GNorm = 1.1734, lr_0 = 2.1804e-04
Loss = 4.1429e-02, PNorm = 67.7274, GNorm = 1.4294, lr_0 = 2.1288e-04
Validation auc = 0.626053
Validation accuracy = 0.707965
Validation f1 = 0.813559
Validation binary_cross_entropy = 2.319983
Epoch 33
Loss = 1.0282e-02, PNorm = 67.7302, GNorm = 0.3518, lr_0 = 2.0783e-04
Loss = 2.9120e-02, PNorm = 67.7330, GNorm = 0.5792, lr_0 = 2.0290e-04
Validation auc = 0.633005
Validation accuracy = 0.712389
Validation f1 = 0.816901
Validation binary_cross_entropy = 2.308451
Epoch 34
Loss = 1.4094e-01, PNorm = 67.7357, GNorm = 2.1075, lr_0 = 1.9762e-04
Loss = 3.0027e-02, PNorm = 67.7376, GNorm = 1.7689, lr_0 = 1.9294e-04
Loss = 3.8538e-02, PNorm = 67.7396, GNorm = 1.2428, lr_0 = 1.8836e-04
Validation auc = 0.647265
Validation accuracy = 0.712389
Validation f1 = 0.815864
Validation binary_cross_entropy = 2.235919
Epoch 35
Loss = 3.7666e-02, PNorm = 67.7421, GNorm = 0.1000, lr_0 = 1.8390e-04
Loss = 2.9369e-02, PNorm = 67.7440, GNorm = 1.2283, lr_0 = 1.7954e-04
Loss = 6.4306e-03, PNorm = 67.7442, GNorm = 0.1098, lr_0 = 1.7911e-04
Validation auc = 0.652745
Validation accuracy = 0.716814
Validation f1 = 0.819209
Validation binary_cross_entropy = 2.256658
Epoch 36
Loss = 3.3241e-02, PNorm = 67.7460, GNorm = 0.1945, lr_0 = 1.7487e-04
Loss = 3.1077e-02, PNorm = 67.7472, GNorm = 0.7009, lr_0 = 1.7072e-04
Validation auc = 0.646554
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 2.310782
Epoch 37
Loss = 2.2978e-02, PNorm = 67.7486, GNorm = 0.3468, lr_0 = 1.6668e-04
Loss = 3.6861e-02, PNorm = 67.7496, GNorm = 0.7404, lr_0 = 1.6273e-04
Validation auc = 0.640160
Validation accuracy = 0.712389
Validation f1 = 0.815864
Validation binary_cross_entropy = 2.306204
Epoch 38
Loss = 2.9216e-02, PNorm = 67.7509, GNorm = 1.7354, lr_0 = 1.5887e-04
Loss = 2.3269e-02, PNorm = 67.7527, GNorm = 0.2085, lr_0 = 1.5510e-04
Validation auc = 0.641886
Validation accuracy = 0.707965
Validation f1 = 0.813559
Validation binary_cross_entropy = 2.327804
Epoch 39
Loss = 2.6963e-02, PNorm = 67.7543, GNorm = 0.0678, lr_0 = 1.5107e-04
Loss = 2.6302e-02, PNorm = 67.7560, GNorm = 0.1808, lr_0 = 1.4749e-04
Validation auc = 0.652339
Validation accuracy = 0.712389
Validation f1 = 0.815864
Validation binary_cross_entropy = 2.285779
Epoch 40
Loss = 1.9862e-02, PNorm = 67.7573, GNorm = 0.6820, lr_0 = 1.4399e-04
Loss = 3.6783e-02, PNorm = 67.7583, GNorm = 0.2889, lr_0 = 1.4058e-04
Validation auc = 0.653202
Validation accuracy = 0.716814
Validation f1 = 0.818182
Validation binary_cross_entropy = 2.308653
Epoch 41
Loss = 2.8816e-02, PNorm = 67.7593, GNorm = 0.6332, lr_0 = 1.3692e-04
Loss = 2.1709e-02, PNorm = 67.7605, GNorm = 0.4834, lr_0 = 1.3367e-04
Validation auc = 0.652542
Validation accuracy = 0.716814
Validation f1 = 0.818182
Validation binary_cross_entropy = 2.316564
Epoch 42
Loss = 3.5360e-02, PNorm = 67.7626, GNorm = 0.8094, lr_0 = 1.3050e-04
Loss = 3.0994e-02, PNorm = 67.7644, GNorm = 0.2903, lr_0 = 1.2741e-04
Validation auc = 0.646910
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 2.772467
Epoch 43
Loss = 1.6189e-02, PNorm = 67.7658, GNorm = 0.0487, lr_0 = 1.2409e-04
Loss = 3.7217e-02, PNorm = 67.7664, GNorm = 2.2203, lr_0 = 1.2115e-04
Validation auc = 0.658530
Validation accuracy = 0.721239
Validation f1 = 0.821530
Validation binary_cross_entropy = 2.712635
Epoch 44
Loss = 1.8632e-02, PNorm = 67.7670, GNorm = 0.5170, lr_0 = 1.1828e-04
Loss = 7.1924e-03, PNorm = 67.7679, GNorm = 0.0814, lr_0 = 1.1548e-04
Validation auc = 0.663859
Validation accuracy = 0.725664
Validation f1 = 0.822857
Validation binary_cross_entropy = 2.682578
Epoch 45
Loss = 2.4230e-02, PNorm = 67.7688, GNorm = 0.9581, lr_0 = 1.1274e-04
Loss = 2.8254e-02, PNorm = 67.7696, GNorm = 0.6756, lr_0 = 1.1007e-04
Validation auc = 0.662945
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 2.717505
Epoch 46
Loss = 2.6414e-02, PNorm = 67.7704, GNorm = 0.5507, lr_0 = 1.0720e-04
Loss = 2.2472e-02, PNorm = 67.7713, GNorm = 0.8975, lr_0 = 1.0466e-04
Validation auc = 0.661575
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 2.745421
Epoch 47
Loss = 4.0329e-03, PNorm = 67.7726, GNorm = 0.0048, lr_0 = 1.0218e-04
Loss = 1.9932e-02, PNorm = 67.7733, GNorm = 0.2201, lr_0 = 1.0000e-04
Validation auc = 0.661524
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 2.722762
Epoch 48
Loss = 6.5048e-02, PNorm = 67.7731, GNorm = 1.3880, lr_0 = 1.0000e-04
Loss = 2.5362e-02, PNorm = 67.7730, GNorm = 0.0592, lr_0 = 1.0000e-04
Validation auc = 0.662184
Validation accuracy = 0.721239
Validation f1 = 0.820513
Validation binary_cross_entropy = 2.675336
Epoch 49
Loss = 1.7685e-02, PNorm = 67.7736, GNorm = 1.4844, lr_0 = 1.0000e-04
Loss = 3.5926e-02, PNorm = 67.7744, GNorm = 1.1871, lr_0 = 1.0000e-04
Validation auc = 0.665939
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 2.707006
Model 0 best validation auc = 0.691972 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.907152
Model 0 test accuracy = 0.852713
Model 0 test f1 = 0.880503
Model 0 test binary_cross_entropy = 0.614021
Ensemble test auc = 0.907152
Ensemble test accuracy = 0.852713
Ensemble test f1 = 0.880503
Ensemble test binary_cross_entropy = 0.614021
Fold 3
Splitting data with seed 3
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 6.7456e-01, PNorm = 66.3010, GNorm = 4.3416, lr_0 = 3.4750e-04
Loss = 5.6061e-01, PNorm = 66.3527, GNorm = 5.5135, lr_0 = 5.7250e-04
Loss = 5.0520e-01, PNorm = 66.3598, GNorm = 5.3020, lr_0 = 5.9500e-04
Validation auc = 0.679184
Validation accuracy = 0.668142
Validation f1 = 0.761905
Validation binary_cross_entropy = 0.633899
Epoch 1
Loss = 3.4635e-01, PNorm = 66.4499, GNorm = 2.8032, lr_0 = 8.2000e-04
Loss = 3.5871e-01, PNorm = 66.5659, GNorm = 3.0797, lr_0 = 9.9521e-04
Validation auc = 0.672689
Validation accuracy = 0.730088
Validation f1 = 0.829132
Validation binary_cross_entropy = 0.743004
Epoch 2
Loss = 2.0952e-01, PNorm = 66.6874, GNorm = 2.4370, lr_0 = 9.7163e-04
Loss = 2.1778e-01, PNorm = 66.7797, GNorm = 1.8765, lr_0 = 9.4860e-04
Validation auc = 0.625089
Validation accuracy = 0.712389
Validation f1 = 0.811594
Validation binary_cross_entropy = 0.894131
Epoch 3
Loss = 1.5368e-01, PNorm = 66.8692, GNorm = 1.0744, lr_0 = 9.2390e-04
Loss = 1.8494e-01, PNorm = 66.9326, GNorm = 2.1171, lr_0 = 9.0200e-04
Validation auc = 0.658074
Validation accuracy = 0.685841
Validation f1 = 0.785498
Validation binary_cross_entropy = 0.971721
Epoch 4
Loss = 1.3394e-01, PNorm = 66.9899, GNorm = 2.0844, lr_0 = 8.8063e-04
Loss = 1.2373e-01, PNorm = 67.0381, GNorm = 0.8701, lr_0 = 8.5976e-04
Validation auc = 0.658378
Validation accuracy = 0.707965
Validation f1 = 0.811429
Validation binary_cross_entropy = 1.038518
Epoch 5
Loss = 8.4788e-02, PNorm = 67.0845, GNorm = 1.2770, lr_0 = 8.3737e-04
Loss = 1.1711e-01, PNorm = 67.1179, GNorm = 1.7097, lr_0 = 8.1752e-04
Validation auc = 0.669593
Validation accuracy = 0.734513
Validation f1 = 0.828571
Validation binary_cross_entropy = 1.074863
Epoch 6
Loss = 7.6023e-02, PNorm = 67.1448, GNorm = 2.0656, lr_0 = 7.9815e-04
Loss = 1.2641e-01, PNorm = 67.1721, GNorm = 1.9445, lr_0 = 7.7923e-04
Validation auc = 0.663250
Validation accuracy = 0.716814
Validation f1 = 0.812865
Validation binary_cross_entropy = 1.054107
Epoch 7
Loss = 7.0486e-02, PNorm = 67.2039, GNorm = 0.7885, lr_0 = 7.6076e-04
Loss = 7.6179e-02, PNorm = 67.2315, GNorm = 1.4125, lr_0 = 7.4273e-04
Validation auc = 0.705470
Validation accuracy = 0.752212
Validation f1 = 0.838150
Validation binary_cross_entropy = 1.038715
Epoch 8
Loss = 8.0311e-02, PNorm = 67.2567, GNorm = 1.4372, lr_0 = 7.2339e-04
Loss = 8.9131e-02, PNorm = 67.2826, GNorm = 2.5715, lr_0 = 7.0625e-04
Validation auc = 0.674414
Validation accuracy = 0.747788
Validation f1 = 0.842105
Validation binary_cross_entropy = 1.050456
Epoch 9
Loss = 6.2664e-02, PNorm = 67.3055, GNorm = 0.5921, lr_0 = 6.8951e-04
Loss = 4.8921e-02, PNorm = 67.3252, GNorm = 1.0481, lr_0 = 6.7317e-04
Validation auc = 0.672587
Validation accuracy = 0.716814
Validation f1 = 0.811765
Validation binary_cross_entropy = 1.005690
Epoch 10
Loss = 4.3862e-02, PNorm = 67.3452, GNorm = 1.3118, lr_0 = 6.5564e-04
Loss = 6.6778e-02, PNorm = 67.3658, GNorm = 1.6975, lr_0 = 6.4010e-04
Validation auc = 0.696235
Validation accuracy = 0.743363
Validation f1 = 0.832370
Validation binary_cross_entropy = 1.006327
Epoch 11
Loss = 7.2023e-02, PNorm = 67.3806, GNorm = 1.0515, lr_0 = 6.2493e-04
Loss = 5.6994e-02, PNorm = 67.3971, GNorm = 0.7795, lr_0 = 6.1012e-04
Validation auc = 0.713184
Validation accuracy = 0.747788
Validation f1 = 0.834783
Validation binary_cross_entropy = 0.914545
Epoch 12
Loss = 4.3717e-02, PNorm = 67.4121, GNorm = 1.1352, lr_0 = 5.9424e-04
Loss = 7.8601e-02, PNorm = 67.4274, GNorm = 1.2872, lr_0 = 5.8015e-04
Validation auc = 0.701005
Validation accuracy = 0.738938
Validation f1 = 0.832861
Validation binary_cross_entropy = 0.890035
Epoch 13
Loss = 3.0905e-02, PNorm = 67.4437, GNorm = 1.1603, lr_0 = 5.6640e-04
Loss = 5.4761e-02, PNorm = 67.4600, GNorm = 0.5571, lr_0 = 5.5298e-04
Validation auc = 0.708008
Validation accuracy = 0.752212
Validation f1 = 0.843575
Validation binary_cross_entropy = 1.099788
Epoch 14
Loss = 6.6968e-02, PNorm = 67.4765, GNorm = 0.8850, lr_0 = 5.3987e-04
Loss = 5.3957e-02, PNorm = 67.4897, GNorm = 0.5557, lr_0 = 5.2708e-04
Validation auc = 0.709784
Validation accuracy = 0.752212
Validation f1 = 0.840000
Validation binary_cross_entropy = 1.020663
Epoch 15
Loss = 5.9403e-02, PNorm = 67.5026, GNorm = 1.4877, lr_0 = 5.1335e-04
Loss = 4.3319e-02, PNorm = 67.5134, GNorm = 1.1929, lr_0 = 5.0119e-04
Validation auc = 0.683244
Validation accuracy = 0.738938
Validation f1 = 0.835655
Validation binary_cross_entropy = 1.149618
Epoch 16
Loss = 3.8495e-02, PNorm = 67.5241, GNorm = 1.0617, lr_0 = 4.8931e-04
Loss = 5.3743e-02, PNorm = 67.5348, GNorm = 1.1059, lr_0 = 4.7771e-04
Validation auc = 0.706485
Validation accuracy = 0.756637
Validation f1 = 0.844193
Validation binary_cross_entropy = 1.120193
Epoch 17
Loss = 4.1139e-02, PNorm = 67.5455, GNorm = 0.9399, lr_0 = 4.6527e-04
Loss = 5.8765e-02, PNorm = 67.5567, GNorm = 0.3301, lr_0 = 4.5425e-04
Loss = 3.8981e-02, PNorm = 67.5666, GNorm = 0.5850, lr_0 = 4.4348e-04
Validation auc = 0.708160
Validation accuracy = 0.765487
Validation f1 = 0.848138
Validation binary_cross_entropy = 1.057446
Epoch 18
Loss = 5.4031e-02, PNorm = 67.5738, GNorm = 0.8190, lr_0 = 4.3297e-04
Loss = 5.5071e-02, PNorm = 67.5820, GNorm = 0.6400, lr_0 = 4.2271e-04
Validation auc = 0.705014
Validation accuracy = 0.769912
Validation f1 = 0.853933
Validation binary_cross_entropy = 1.120407
Epoch 19
Loss = 4.5814e-02, PNorm = 67.5904, GNorm = 0.7746, lr_0 = 4.1269e-04
Loss = 8.5944e-02, PNorm = 67.5960, GNorm = 2.2372, lr_0 = 4.0291e-04
Validation auc = 0.685172
Validation accuracy = 0.734513
Validation f1 = 0.828571
Validation binary_cross_entropy = 1.223447
Epoch 20
Loss = 2.1296e-02, PNorm = 67.6008, GNorm = 0.7381, lr_0 = 3.9242e-04
Loss = 7.9650e-02, PNorm = 67.6070, GNorm = 1.1490, lr_0 = 3.8312e-04
Validation auc = 0.635847
Validation accuracy = 0.707965
Validation f1 = 0.809249
Validation binary_cross_entropy = 1.347197
Epoch 21
Loss = 4.5622e-02, PNorm = 67.6125, GNorm = 0.2745, lr_0 = 3.7404e-04
Loss = 4.9215e-02, PNorm = 67.6173, GNorm = 1.3786, lr_0 = 3.6517e-04
Validation auc = 0.618847
Validation accuracy = 0.659292
Validation f1 = 0.768769
Validation binary_cross_entropy = 1.368707
Epoch 22
Loss = 4.0703e-02, PNorm = 67.6247, GNorm = 0.4244, lr_0 = 3.5567e-04
Loss = 4.8369e-02, PNorm = 67.6312, GNorm = 0.5032, lr_0 = 3.4724e-04
Validation auc = 0.634426
Validation accuracy = 0.734513
Validation f1 = 0.831461
Validation binary_cross_entropy = 1.320241
Epoch 23
Loss = 2.7216e-02, PNorm = 67.6369, GNorm = 0.1095, lr_0 = 3.3901e-04
Loss = 4.3126e-02, PNorm = 67.6414, GNorm = 1.0856, lr_0 = 3.3097e-04
Validation auc = 0.660662
Validation accuracy = 0.743363
Validation f1 = 0.831395
Validation binary_cross_entropy = 1.210350
Epoch 24
Loss = 5.5528e-02, PNorm = 67.6456, GNorm = 0.9942, lr_0 = 3.2235e-04
Loss = 4.9781e-02, PNorm = 67.6495, GNorm = 1.7880, lr_0 = 3.1471e-04
Validation auc = 0.669187
Validation accuracy = 0.756637
Validation f1 = 0.842407
Validation binary_cross_entropy = 1.169170
Epoch 25
Loss = 5.1337e-02, PNorm = 67.6543, GNorm = 0.2520, lr_0 = 3.0726e-04
Loss = 3.0524e-02, PNorm = 67.6590, GNorm = 0.5096, lr_0 = 2.9997e-04
Validation auc = 0.675327
Validation accuracy = 0.747788
Validation f1 = 0.832845
Validation binary_cross_entropy = 1.178479
Epoch 26
Loss = 3.3617e-02, PNorm = 67.6638, GNorm = 0.6684, lr_0 = 2.9286e-04
Loss = 3.7414e-02, PNorm = 67.6685, GNorm = 0.2440, lr_0 = 2.8592e-04
Validation auc = 0.679184
Validation accuracy = 0.743363
Validation f1 = 0.830409
Validation binary_cross_entropy = 1.171983
Epoch 27
Loss = 2.5884e-02, PNorm = 67.6732, GNorm = 0.8568, lr_0 = 2.7848e-04
Loss = 3.5893e-02, PNorm = 67.6771, GNorm = 0.7351, lr_0 = 2.7188e-04
Validation auc = 0.671724
Validation accuracy = 0.765487
Validation f1 = 0.848138
Validation binary_cross_entropy = 1.243986
Epoch 28
Loss = 4.9673e-02, PNorm = 67.6799, GNorm = 0.0861, lr_0 = 2.6544e-04
Loss = 2.7914e-02, PNorm = 67.6847, GNorm = 0.1986, lr_0 = 2.5914e-04
Validation auc = 0.704760
Validation accuracy = 0.761062
Validation f1 = 0.844828
Validation binary_cross_entropy = 1.218668
Epoch 29
Loss = 1.5551e-02, PNorm = 67.6891, GNorm = 0.5595, lr_0 = 2.5240e-04
Loss = 2.8960e-02, PNorm = 67.6927, GNorm = 0.2923, lr_0 = 2.4641e-04
Validation auc = 0.720440
Validation accuracy = 0.769912
Validation f1 = 0.850575
Validation binary_cross_entropy = 1.174353
Epoch 30
Loss = 2.9285e-02, PNorm = 67.6951, GNorm = 0.1983, lr_0 = 2.4057e-04
Loss = 4.3769e-02, PNorm = 67.6970, GNorm = 1.8255, lr_0 = 2.3487e-04
Validation auc = 0.718411
Validation accuracy = 0.765487
Validation f1 = 0.846377
Validation binary_cross_entropy = 1.171857
Epoch 31
Loss = 3.9526e-02, PNorm = 67.6990, GNorm = 0.0433, lr_0 = 2.2876e-04
Loss = 4.2390e-02, PNorm = 67.7007, GNorm = 1.1032, lr_0 = 2.2334e-04
Validation auc = 0.724652
Validation accuracy = 0.774336
Validation f1 = 0.853026
Validation binary_cross_entropy = 1.151677
Epoch 32
Loss = 1.7141e-02, PNorm = 67.7029, GNorm = 0.5850, lr_0 = 2.1804e-04
Loss = 2.5402e-02, PNorm = 67.7050, GNorm = 0.2153, lr_0 = 2.1288e-04
Validation auc = 0.733127
Validation accuracy = 0.778761
Validation f1 = 0.856322
Validation binary_cross_entropy = 1.147586
Epoch 33
Loss = 7.6383e-03, PNorm = 67.7074, GNorm = 0.1824, lr_0 = 2.0783e-04
Loss = 4.2554e-02, PNorm = 67.7100, GNorm = 0.2144, lr_0 = 2.0290e-04
Validation auc = 0.731503
Validation accuracy = 0.787611
Validation f1 = 0.865922
Validation binary_cross_entropy = 1.186307
Epoch 34
Loss = 1.7828e-01, PNorm = 67.7113, GNorm = 2.3822, lr_0 = 1.9762e-04
Loss = 3.8889e-02, PNorm = 67.7121, GNorm = 0.1933, lr_0 = 1.9294e-04
Loss = 2.9541e-02, PNorm = 67.7139, GNorm = 0.7334, lr_0 = 1.8836e-04
Validation auc = 0.727240
Validation accuracy = 0.761062
Validation f1 = 0.843023
Validation binary_cross_entropy = 1.169567
Epoch 35
Loss = 2.9730e-02, PNorm = 67.7171, GNorm = 0.4513, lr_0 = 1.8390e-04
Loss = 4.6936e-02, PNorm = 67.7192, GNorm = 1.9945, lr_0 = 1.7954e-04
Loss = 2.7231e-03, PNorm = 67.7193, GNorm = 0.0956, lr_0 = 1.7911e-04
Validation auc = 0.726682
Validation accuracy = 0.769912
Validation f1 = 0.849711
Validation binary_cross_entropy = 1.183139
Epoch 36
Loss = 3.0494e-02, PNorm = 67.7212, GNorm = 0.5439, lr_0 = 1.7487e-04
Loss = 3.1511e-02, PNorm = 67.7231, GNorm = 0.4444, lr_0 = 1.7072e-04
Validation auc = 0.732467
Validation accuracy = 0.774336
Validation f1 = 0.851312
Validation binary_cross_entropy = 1.176473
Epoch 37
Loss = 3.2776e-02, PNorm = 67.7250, GNorm = 2.1104, lr_0 = 1.6668e-04
Loss = 2.6790e-02, PNorm = 67.7271, GNorm = 0.3404, lr_0 = 1.6273e-04
Validation auc = 0.732163
Validation accuracy = 0.774336
Validation f1 = 0.852174
Validation binary_cross_entropy = 1.225007
Epoch 38
Loss = 2.0566e-02, PNorm = 67.7290, GNorm = 0.3554, lr_0 = 1.5887e-04
Loss = 3.1939e-02, PNorm = 67.7307, GNorm = 1.7210, lr_0 = 1.5510e-04
Validation auc = 0.722420
Validation accuracy = 0.765487
Validation f1 = 0.848138
Validation binary_cross_entropy = 1.298124
Epoch 39
Loss = 2.3624e-02, PNorm = 67.7320, GNorm = 1.6012, lr_0 = 1.5107e-04
Loss = 3.3629e-02, PNorm = 67.7327, GNorm = 0.8132, lr_0 = 1.4749e-04
Validation auc = 0.724297
Validation accuracy = 0.761062
Validation f1 = 0.843931
Validation binary_cross_entropy = 1.292577
Epoch 40
Loss = 2.7454e-02, PNorm = 67.7335, GNorm = 0.8212, lr_0 = 1.4399e-04
Loss = 2.2527e-02, PNorm = 67.7348, GNorm = 0.2657, lr_0 = 1.4058e-04
Validation auc = 0.720745
Validation accuracy = 0.765487
Validation f1 = 0.847262
Validation binary_cross_entropy = 1.303377
Epoch 41
Loss = 2.7904e-02, PNorm = 67.7363, GNorm = 0.2967, lr_0 = 1.3692e-04
Loss = 4.2616e-02, PNorm = 67.7372, GNorm = 0.6870, lr_0 = 1.3367e-04
Validation auc = 0.716838
Validation accuracy = 0.765487
Validation f1 = 0.848138
Validation binary_cross_entropy = 1.310315
Epoch 42
Loss = 3.0886e-02, PNorm = 67.7383, GNorm = 0.7273, lr_0 = 1.3050e-04
Loss = 3.5211e-02, PNorm = 67.7394, GNorm = 0.2726, lr_0 = 1.2741e-04
Validation auc = 0.718258
Validation accuracy = 0.765487
Validation f1 = 0.848138
Validation binary_cross_entropy = 1.310830
Epoch 43
Loss = 2.0292e-02, PNorm = 67.7403, GNorm = 0.8582, lr_0 = 1.2409e-04
Loss = 3.9441e-02, PNorm = 67.7416, GNorm = 1.8044, lr_0 = 1.2115e-04
Validation auc = 0.708870
Validation accuracy = 0.761062
Validation f1 = 0.843931
Validation binary_cross_entropy = 1.329478
Epoch 44
Loss = 4.7400e-02, PNorm = 67.7426, GNorm = 0.8574, lr_0 = 1.1828e-04
Loss = 3.7376e-02, PNorm = 67.7437, GNorm = 1.2441, lr_0 = 1.1548e-04
Validation auc = 0.706435
Validation accuracy = 0.756637
Validation f1 = 0.841499
Validation binary_cross_entropy = 1.352158
Epoch 45
Loss = 5.9590e-02, PNorm = 67.7446, GNorm = 0.8211, lr_0 = 1.1274e-04
Loss = 4.5861e-02, PNorm = 67.7457, GNorm = 0.6164, lr_0 = 1.1007e-04
Validation auc = 0.696894
Validation accuracy = 0.743363
Validation f1 = 0.834286
Validation binary_cross_entropy = 1.376967
Epoch 46
Loss = 2.4887e-02, PNorm = 67.7469, GNorm = 0.2251, lr_0 = 1.0720e-04
Loss = 3.8285e-02, PNorm = 67.7476, GNorm = 0.0747, lr_0 = 1.0466e-04
Validation auc = 0.695626
Validation accuracy = 0.738938
Validation f1 = 0.830946
Validation binary_cross_entropy = 1.380893
Epoch 47
Loss = 2.4080e-02, PNorm = 67.7480, GNorm = 0.0996, lr_0 = 1.0218e-04
Loss = 2.4971e-02, PNorm = 67.7481, GNorm = 0.1824, lr_0 = 1.0000e-04
Validation auc = 0.702629
Validation accuracy = 0.747788
Validation f1 = 0.834783
Validation binary_cross_entropy = 1.350987
Epoch 48
Loss = 3.7920e-02, PNorm = 67.7487, GNorm = 2.2339, lr_0 = 1.0000e-04
Loss = 2.9583e-02, PNorm = 67.7496, GNorm = 1.0436, lr_0 = 1.0000e-04
Validation auc = 0.707450
Validation accuracy = 0.761062
Validation f1 = 0.845714
Validation binary_cross_entropy = 1.323451
Epoch 49
Loss = 5.6236e-02, PNorm = 67.7503, GNorm = 0.4474, lr_0 = 1.0000e-04
Loss = 2.8904e-02, PNorm = 67.7506, GNorm = 0.7990, lr_0 = 1.0000e-04
Validation auc = 0.707399
Validation accuracy = 0.738938
Validation f1 = 0.827988
Validation binary_cross_entropy = 1.290467
Model 0 best validation auc = 0.733127 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.935100
Model 0 test accuracy = 0.887597
Model 0 test f1 = 0.913433
Model 0 test binary_cross_entropy = 0.572131
Ensemble test auc = 0.935100
Ensemble test accuracy = 0.887597
Ensemble test f1 = 0.913433
Ensemble test binary_cross_entropy = 0.572131
Fold 4
Splitting data with seed 4
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 7.4881e-01, PNorm = 66.2988, GNorm = 4.0787, lr_0 = 3.4750e-04
Loss = 5.0249e-01, PNorm = 66.3544, GNorm = 5.3683, lr_0 = 5.7250e-04
Loss = 4.4458e-01, PNorm = 66.3621, GNorm = 4.8610, lr_0 = 5.9500e-04
Validation auc = 0.673703
Validation accuracy = 0.650442
Validation f1 = 0.737542
Validation binary_cross_entropy = 0.630056
Epoch 1
Loss = 2.5234e-01, PNorm = 66.4604, GNorm = 3.7338, lr_0 = 8.2000e-04
Loss = 3.7996e-01, PNorm = 66.5765, GNorm = 3.4896, lr_0 = 9.9521e-04
Validation auc = 0.704658
Validation accuracy = 0.685841
Validation f1 = 0.780186
Validation binary_cross_entropy = 0.595473
Epoch 2
Loss = 2.4587e-01, PNorm = 66.7025, GNorm = 2.1543, lr_0 = 9.7163e-04
Loss = 2.0696e-01, PNorm = 66.8069, GNorm = 3.7228, lr_0 = 9.4860e-04
Validation auc = 0.603877
Validation accuracy = 0.707965
Validation f1 = 0.811429
Validation binary_cross_entropy = 0.832324
Epoch 3
Loss = 1.4256e-01, PNorm = 66.8963, GNorm = 1.9422, lr_0 = 9.2390e-04
Loss = 1.7077e-01, PNorm = 66.9621, GNorm = 0.6977, lr_0 = 9.0200e-04
Validation auc = 0.605399
Validation accuracy = 0.668142
Validation f1 = 0.769231
Validation binary_cross_entropy = 0.875964
Epoch 4
Loss = 9.8821e-02, PNorm = 67.0174, GNorm = 2.0223, lr_0 = 8.8063e-04
Loss = 1.4684e-01, PNorm = 67.0603, GNorm = 0.7120, lr_0 = 8.5976e-04
Validation auc = 0.572110
Validation accuracy = 0.597345
Validation f1 = 0.705502
Validation binary_cross_entropy = 1.025780
Epoch 5
Loss = 1.1937e-01, PNorm = 67.1042, GNorm = 2.0792, lr_0 = 8.3737e-04
Loss = 1.0300e-01, PNorm = 67.1384, GNorm = 0.6157, lr_0 = 8.1752e-04
Validation auc = 0.598092
Validation accuracy = 0.632743
Validation f1 = 0.747720
Validation binary_cross_entropy = 1.049521
Epoch 6
Loss = 5.3785e-02, PNorm = 67.1739, GNorm = 0.7409, lr_0 = 7.9815e-04
Loss = 1.0132e-01, PNorm = 67.2038, GNorm = 2.5437, lr_0 = 7.7923e-04
Validation auc = 0.633716
Validation accuracy = 0.654867
Validation f1 = 0.757764
Validation binary_cross_entropy = 1.128075
Epoch 7
Loss = 7.6607e-02, PNorm = 67.2326, GNorm = 1.1130, lr_0 = 7.6076e-04
Loss = 9.5088e-02, PNorm = 67.2587, GNorm = 0.8969, lr_0 = 7.4273e-04
Validation auc = 0.617883
Validation accuracy = 0.690265
Validation f1 = 0.794118
Validation binary_cross_entropy = 1.160528
Epoch 8
Loss = 7.8009e-02, PNorm = 67.2838, GNorm = 1.2936, lr_0 = 7.2339e-04
Loss = 6.5771e-02, PNorm = 67.3112, GNorm = 1.0239, lr_0 = 7.0625e-04
Validation auc = 0.602253
Validation accuracy = 0.668142
Validation f1 = 0.769231
Validation binary_cross_entropy = 1.304803
Epoch 9
Loss = 6.1426e-02, PNorm = 67.3366, GNorm = 1.3025, lr_0 = 6.8951e-04
Loss = 4.9768e-02, PNorm = 67.3597, GNorm = 1.3196, lr_0 = 6.7317e-04
Validation auc = 0.643357
Validation accuracy = 0.721239
Validation f1 = 0.820513
Validation binary_cross_entropy = 1.280006
Epoch 10
Loss = 2.9219e-02, PNorm = 67.3809, GNorm = 0.3738, lr_0 = 6.5564e-04
Loss = 9.3534e-02, PNorm = 67.3970, GNorm = 2.3336, lr_0 = 6.4010e-04
Validation auc = 0.654623
Validation accuracy = 0.743363
Validation f1 = 0.837989
Validation binary_cross_entropy = 1.665012
Epoch 11
Loss = 7.5258e-02, PNorm = 67.4202, GNorm = 0.7971, lr_0 = 6.2493e-04
Loss = 9.2093e-02, PNorm = 67.4396, GNorm = 1.0746, lr_0 = 6.1012e-04
Validation auc = 0.655333
Validation accuracy = 0.672566
Validation f1 = 0.779762
Validation binary_cross_entropy = 1.508829
Epoch 12
Loss = 3.4472e-02, PNorm = 67.4578, GNorm = 0.4876, lr_0 = 5.9424e-04
Loss = 4.7241e-02, PNorm = 67.4731, GNorm = 1.5874, lr_0 = 5.8015e-04
Validation auc = 0.668527
Validation accuracy = 0.685841
Validation f1 = 0.793003
Validation binary_cross_entropy = 1.511270
Epoch 13
Loss = 7.2753e-02, PNorm = 67.4867, GNorm = 1.5171, lr_0 = 5.6640e-04
Loss = 4.2730e-02, PNorm = 67.5028, GNorm = 1.1997, lr_0 = 5.5298e-04
Validation auc = 0.689232
Validation accuracy = 0.716814
Validation f1 = 0.813953
Validation binary_cross_entropy = 1.547947
Epoch 14
Loss = 9.0635e-02, PNorm = 67.5160, GNorm = 1.5529, lr_0 = 5.3987e-04
Loss = 7.2894e-02, PNorm = 67.5270, GNorm = 1.9478, lr_0 = 5.2708e-04
Validation auc = 0.679641
Validation accuracy = 0.707965
Validation f1 = 0.805882
Validation binary_cross_entropy = 1.584806
Epoch 15
Loss = 5.5175e-02, PNorm = 67.5412, GNorm = 0.9741, lr_0 = 5.1335e-04
Loss = 5.7629e-02, PNorm = 67.5543, GNorm = 1.2996, lr_0 = 5.0119e-04
Validation auc = 0.684411
Validation accuracy = 0.721239
Validation f1 = 0.817391
Validation binary_cross_entropy = 1.658663
Epoch 16
Loss = 3.0450e-02, PNorm = 67.5675, GNorm = 0.9750, lr_0 = 4.8931e-04
Loss = 4.6547e-02, PNorm = 67.5773, GNorm = 1.0877, lr_0 = 4.7771e-04
Validation auc = 0.669035
Validation accuracy = 0.703540
Validation f1 = 0.804665
Validation binary_cross_entropy = 1.662897
Epoch 17
Loss = 2.3929e-02, PNorm = 67.5873, GNorm = 0.4785, lr_0 = 4.6527e-04
Loss = 3.6573e-02, PNorm = 67.5976, GNorm = 0.3843, lr_0 = 4.5425e-04
Loss = 3.9287e-02, PNorm = 67.6059, GNorm = 1.8734, lr_0 = 4.4348e-04
Validation auc = 0.691870
Validation accuracy = 0.725664
Validation f1 = 0.820809
Validation binary_cross_entropy = 1.653754
Epoch 18
Loss = 5.4086e-02, PNorm = 67.6129, GNorm = 0.9744, lr_0 = 4.3297e-04
Loss = 3.7810e-02, PNorm = 67.6212, GNorm = 1.0430, lr_0 = 4.2271e-04
Validation auc = 0.692327
Validation accuracy = 0.716814
Validation f1 = 0.812865
Validation binary_cross_entropy = 1.645691
Epoch 19
Loss = 4.9273e-02, PNorm = 67.6294, GNorm = 1.5133, lr_0 = 4.1269e-04
Loss = 4.4754e-02, PNorm = 67.6361, GNorm = 1.4045, lr_0 = 4.0291e-04
Validation auc = 0.708617
Validation accuracy = 0.699115
Validation f1 = 0.798817
Validation binary_cross_entropy = 1.611605
Epoch 20
Loss = 7.3541e-02, PNorm = 67.6442, GNorm = 1.2023, lr_0 = 3.9242e-04
Loss = 4.5512e-02, PNorm = 67.6509, GNorm = 0.8894, lr_0 = 3.8312e-04
Validation auc = 0.643560
Validation accuracy = 0.681416
Validation f1 = 0.789474
Validation binary_cross_entropy = 1.669222
Epoch 21
Loss = 4.9140e-02, PNorm = 67.6576, GNorm = 0.9051, lr_0 = 3.7404e-04
Loss = 4.9618e-02, PNorm = 67.6665, GNorm = 0.6383, lr_0 = 3.6517e-04
Validation auc = 0.681011
Validation accuracy = 0.743363
Validation f1 = 0.834286
Validation binary_cross_entropy = 1.580767
Epoch 22
Loss = 2.7642e-02, PNorm = 67.6723, GNorm = 1.6161, lr_0 = 3.5567e-04
Loss = 5.9822e-02, PNorm = 67.6771, GNorm = 0.9218, lr_0 = 3.4724e-04
Validation auc = 0.677459
Validation accuracy = 0.663717
Validation f1 = 0.762500
Validation binary_cross_entropy = 1.584471
Epoch 23
Loss = 4.9990e-02, PNorm = 67.6833, GNorm = 0.8505, lr_0 = 3.3901e-04
Loss = 3.2342e-02, PNorm = 67.6898, GNorm = 0.0552, lr_0 = 3.3097e-04
Validation auc = 0.667411
Validation accuracy = 0.703540
Validation f1 = 0.805797
Validation binary_cross_entropy = 1.596870
Epoch 24
Loss = 2.7009e-02, PNorm = 67.6961, GNorm = 0.2109, lr_0 = 3.2235e-04
Loss = 2.4342e-02, PNorm = 67.7008, GNorm = 0.6880, lr_0 = 3.1471e-04
Validation auc = 0.674312
Validation accuracy = 0.690265
Validation f1 = 0.790419
Validation binary_cross_entropy = 1.577933
Epoch 25
Loss = 2.5968e-02, PNorm = 67.7046, GNorm = 0.8664, lr_0 = 3.0726e-04
Loss = 4.4967e-02, PNorm = 67.7081, GNorm = 0.7099, lr_0 = 2.9997e-04
Validation auc = 0.693850
Validation accuracy = 0.716814
Validation f1 = 0.816092
Validation binary_cross_entropy = 1.576804
Epoch 26
Loss = 1.2824e-02, PNorm = 67.7115, GNorm = 0.5808, lr_0 = 2.9286e-04
Loss = 2.6484e-02, PNorm = 67.7153, GNorm = 0.7056, lr_0 = 2.8592e-04
Validation auc = 0.690703
Validation accuracy = 0.716814
Validation f1 = 0.813953
Validation binary_cross_entropy = 1.608685
Epoch 27
Loss = 1.5101e-02, PNorm = 67.7187, GNorm = 1.0865, lr_0 = 2.7848e-04
Loss = 1.7453e-02, PNorm = 67.7224, GNorm = 0.9254, lr_0 = 2.7188e-04
Validation auc = 0.692378
Validation accuracy = 0.716814
Validation f1 = 0.813953
Validation binary_cross_entropy = 1.630607
Epoch 28
Loss = 4.9490e-02, PNorm = 67.7264, GNorm = 1.7712, lr_0 = 2.6544e-04
Loss = 1.7932e-02, PNorm = 67.7302, GNorm = 0.8481, lr_0 = 2.5914e-04
Validation auc = 0.699939
Validation accuracy = 0.716814
Validation f1 = 0.815029
Validation binary_cross_entropy = 1.620346
Epoch 29
Loss = 6.6100e-03, PNorm = 67.7338, GNorm = 0.0510, lr_0 = 2.5240e-04
Loss = 2.7626e-02, PNorm = 67.7368, GNorm = 1.3094, lr_0 = 2.4641e-04
Validation auc = 0.693139
Validation accuracy = 0.707965
Validation f1 = 0.810345
Validation binary_cross_entropy = 1.635469
Epoch 30
Loss = 5.8859e-02, PNorm = 67.7390, GNorm = 0.8106, lr_0 = 2.4057e-04
Loss = 5.9351e-02, PNorm = 67.7406, GNorm = 1.2736, lr_0 = 2.3487e-04
Validation auc = 0.683802
Validation accuracy = 0.703540
Validation f1 = 0.808023
Validation binary_cross_entropy = 1.673928
Epoch 31
Loss = 1.5583e-02, PNorm = 67.7428, GNorm = 0.1299, lr_0 = 2.2876e-04
Loss = 1.4777e-02, PNorm = 67.7455, GNorm = 1.2516, lr_0 = 2.2334e-04
Validation auc = 0.690348
Validation accuracy = 0.703540
Validation f1 = 0.809117
Validation binary_cross_entropy = 1.690758
Epoch 32
Loss = 4.6175e-02, PNorm = 67.7475, GNorm = 0.6471, lr_0 = 2.1804e-04
Loss = 3.3643e-02, PNorm = 67.7492, GNorm = 0.6799, lr_0 = 2.1288e-04
Validation auc = 0.699279
Validation accuracy = 0.703540
Validation f1 = 0.809117
Validation binary_cross_entropy = 1.703333
Epoch 33
Loss = 6.1112e-02, PNorm = 67.7512, GNorm = 1.0437, lr_0 = 2.0783e-04
Loss = 2.4820e-02, PNorm = 67.7537, GNorm = 0.4882, lr_0 = 2.0290e-04
Validation auc = 0.718411
Validation accuracy = 0.721239
Validation f1 = 0.818444
Validation binary_cross_entropy = 1.636175
Epoch 34
Loss = 1.8073e-02, PNorm = 67.7556, GNorm = 0.5349, lr_0 = 1.9762e-04
Loss = 2.8301e-02, PNorm = 67.7576, GNorm = 1.8690, lr_0 = 1.9294e-04
Loss = 3.4905e-02, PNorm = 67.7597, GNorm = 0.0225, lr_0 = 1.8836e-04
Validation auc = 0.716939
Validation accuracy = 0.730088
Validation f1 = 0.823188
Validation binary_cross_entropy = 1.621830
Epoch 35
Loss = 2.2826e-02, PNorm = 67.7618, GNorm = 0.3441, lr_0 = 1.8390e-04
Loss = 2.8081e-02, PNorm = 67.7637, GNorm = 1.7340, lr_0 = 1.7954e-04
Loss = 1.8824e-03, PNorm = 67.7639, GNorm = 0.0879, lr_0 = 1.7911e-04
Validation auc = 0.699482
Validation accuracy = 0.725664
Validation f1 = 0.825843
Validation binary_cross_entropy = 1.715440
Epoch 36
Loss = 1.5097e-02, PNorm = 67.7654, GNorm = 0.7299, lr_0 = 1.7487e-04
Loss = 1.4854e-02, PNorm = 67.7666, GNorm = 0.0692, lr_0 = 1.7072e-04
Validation auc = 0.700802
Validation accuracy = 0.712389
Validation f1 = 0.811594
Validation binary_cross_entropy = 1.706029
Epoch 37
Loss = 2.8929e-02, PNorm = 67.7675, GNorm = 0.3003, lr_0 = 1.6668e-04
Loss = 1.6540e-02, PNorm = 67.7690, GNorm = 0.1910, lr_0 = 1.6273e-04
Validation auc = 0.700497
Validation accuracy = 0.725664
Validation f1 = 0.821839
Validation binary_cross_entropy = 1.691500
Epoch 38
Loss = 2.2320e-02, PNorm = 67.7713, GNorm = 0.7154, lr_0 = 1.5887e-04
Loss = 1.7047e-02, PNorm = 67.7731, GNorm = 0.8063, lr_0 = 1.5510e-04
Validation auc = 0.703491
Validation accuracy = 0.712389
Validation f1 = 0.808260
Validation binary_cross_entropy = 1.710239
Epoch 39
Loss = 1.7733e-02, PNorm = 67.7742, GNorm = 0.0582, lr_0 = 1.5107e-04
Loss = 2.1718e-02, PNorm = 67.7756, GNorm = 2.1711, lr_0 = 1.4749e-04
Validation auc = 0.699838
Validation accuracy = 0.725664
Validation f1 = 0.818713
Validation binary_cross_entropy = 1.720240
Epoch 40
Loss = 3.0219e-02, PNorm = 67.7765, GNorm = 0.7458, lr_0 = 1.4399e-04
Loss = 2.3834e-02, PNorm = 67.7778, GNorm = 0.0786, lr_0 = 1.4058e-04
Validation auc = 0.700497
Validation accuracy = 0.712389
Validation f1 = 0.813754
Validation binary_cross_entropy = 1.700198
Epoch 41
Loss = 3.4831e-02, PNorm = 67.7788, GNorm = 4.5955, lr_0 = 1.3692e-04
Loss = 2.3723e-02, PNorm = 67.7807, GNorm = 0.0534, lr_0 = 1.3367e-04
Validation auc = 0.700447
Validation accuracy = 0.721239
Validation f1 = 0.822535
Validation binary_cross_entropy = 1.728871
Epoch 42
Loss = 3.7555e-02, PNorm = 67.7823, GNorm = 1.4824, lr_0 = 1.3050e-04
Loss = 2.3853e-02, PNorm = 67.7839, GNorm = 0.2142, lr_0 = 1.2741e-04
Validation auc = 0.697148
Validation accuracy = 0.716814
Validation f1 = 0.819209
Validation binary_cross_entropy = 1.746562
Epoch 43
Loss = 1.1387e-02, PNorm = 67.7855, GNorm = 0.0709, lr_0 = 1.2409e-04
Loss = 1.9568e-02, PNorm = 67.7867, GNorm = 0.8825, lr_0 = 1.2115e-04
Validation auc = 0.699888
Validation accuracy = 0.712389
Validation f1 = 0.814815
Validation binary_cross_entropy = 1.716158
Epoch 44
Loss = 2.2420e-02, PNorm = 67.7877, GNorm = 0.2090, lr_0 = 1.1828e-04
Loss = 2.0262e-02, PNorm = 67.7888, GNorm = 1.6611, lr_0 = 1.1548e-04
Validation auc = 0.699787
Validation accuracy = 0.721239
Validation f1 = 0.817391
Validation binary_cross_entropy = 1.707878
Epoch 45
Loss = 1.2886e-02, PNorm = 67.7898, GNorm = 0.2488, lr_0 = 1.1274e-04
Loss = 2.1856e-02, PNorm = 67.7910, GNorm = 0.9944, lr_0 = 1.1007e-04
Validation auc = 0.695626
Validation accuracy = 0.725664
Validation f1 = 0.824859
Validation binary_cross_entropy = 1.739973
Epoch 46
Loss = 8.8318e-03, PNorm = 67.7922, GNorm = 0.2367, lr_0 = 1.0720e-04
Loss = 1.4781e-02, PNorm = 67.7932, GNorm = 0.5572, lr_0 = 1.0466e-04
Validation auc = 0.692276
Validation accuracy = 0.730088
Validation f1 = 0.829132
Validation binary_cross_entropy = 2.151991
Epoch 47
Loss = 6.6227e-03, PNorm = 67.7939, GNorm = 0.4999, lr_0 = 1.0218e-04
Loss = 1.5903e-02, PNorm = 67.7945, GNorm = 0.0891, lr_0 = 1.0000e-04
Validation auc = 0.690196
Validation accuracy = 0.725664
Validation f1 = 0.825843
Validation binary_cross_entropy = 2.175900
Epoch 48
Loss = 1.3584e-02, PNorm = 67.7951, GNorm = 0.0469, lr_0 = 1.0000e-04
Loss = 1.9279e-02, PNorm = 67.7960, GNorm = 0.3581, lr_0 = 1.0000e-04
Validation auc = 0.688572
Validation accuracy = 0.716814
Validation f1 = 0.819209
Validation binary_cross_entropy = 2.203226
Epoch 49
Loss = 1.5748e-02, PNorm = 67.7968, GNorm = 0.9630, lr_0 = 1.0000e-04
Loss = 1.5940e-02, PNorm = 67.7973, GNorm = 0.0290, lr_0 = 1.0000e-04
Validation auc = 0.690450
Validation accuracy = 0.725664
Validation f1 = 0.822857
Validation binary_cross_entropy = 2.200219
Model 0 best validation auc = 0.718411 on epoch 33
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.907878
Model 0 test accuracy = 0.825581
Model 0 test f1 = 0.869565
Model 0 test binary_cross_entropy = 0.846143
Ensemble test auc = 0.907878
Ensemble test accuracy = 0.825581
Ensemble test f1 = 0.869565
Ensemble test binary_cross_entropy = 0.846143
5-fold cross validation
	Seed 0 ==> test auc = 0.896018
	Seed 0 ==> test accuracy = 0.829457
	Seed 0 ==> test f1 = 0.865854
	Seed 0 ==> test binary_cross_entropy = 0.401241
	Seed 1 ==> test auc = 0.923850
	Seed 1 ==> test accuracy = 0.868217
	Seed 1 ==> test f1 = 0.909574
	Seed 1 ==> test binary_cross_entropy = 0.484307
	Seed 2 ==> test auc = 0.907152
	Seed 2 ==> test accuracy = 0.852713
	Seed 2 ==> test f1 = 0.880503
	Seed 2 ==> test binary_cross_entropy = 0.614021
	Seed 3 ==> test auc = 0.935100
	Seed 3 ==> test accuracy = 0.887597
	Seed 3 ==> test f1 = 0.913433
	Seed 3 ==> test binary_cross_entropy = 0.572131
	Seed 4 ==> test auc = 0.907878
	Seed 4 ==> test accuracy = 0.825581
	Seed 4 ==> test f1 = 0.869565
	Seed 4 ==> test binary_cross_entropy = 0.846143
Overall test auc = 0.914000 +/- 0.013784
Overall test accuracy = 0.852713 +/- 0.023385
Overall test f1 = 0.887786 +/- 0.019993
Overall test binary_cross_entropy = 0.583569 +/- 0.150399
Elapsed time = 0:05:20
Command line
python /home/ddunstan/.conda/envs/chemprop/bin/chemprop_train --data_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-cluster-train.csv --dataset_type classification --save_dir /home/ddunstan/Chemistry-Capstone/Complex_Models/bace-cluster-hyperopt --epochs 50 --extra_metrics accuracy f1 binary_cross_entropy --metric auc --target_columns active --smiles_columns mol --num_folds 5 --split_sizes 0.8 0 0.2 --separate_val_path /home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-cluster-validate.csv --features_generator morgan --num_workers 1 --config_path /home/ddunstan/Chemistry-Capstone/Complex_Models/bace-cluster-hyperopt/hyper_param.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/ddunstan/Chemistry-Capstone/Complex_Models/bace-cluster-hyperopt/hyper_param.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-cluster-train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 6,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy', 'f1', 'binary_cross_entropy'],
 'features_generator': ['morgan'],
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy', 'f1', 'binary_cross_entropy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 1,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/ddunstan/Chemistry-Capstone/Complex_Models/bace-cluster-hyperopt',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': '/home/ddunstan/Chemistry-Capstone/data_split_cleaned/bace-cluster-validate.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['mol'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.0, 0.2],
 'split_type': 'random',
 'target_columns': ['active'],
 'target_weights': None,
 'task_names': ['active'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35000000000000003, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35000000000000003, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 7.5559e-01, PNorm = 66.3003, GNorm = 5.3865, lr_0 = 3.4750e-04
Loss = 5.8193e-01, PNorm = 66.3537, GNorm = 5.6831, lr_0 = 5.7250e-04
Loss = 5.5190e-01, PNorm = 66.3611, GNorm = 5.9431, lr_0 = 5.9500e-04
Validation auc = 0.620928
Validation accuracy = 0.566372
Validation f1 = 0.664384
Validation binary_cross_entropy = 0.667234
Epoch 1
Loss = 3.3916e-01, PNorm = 66.4606, GNorm = 3.6170, lr_0 = 8.2000e-04
Loss = 3.6477e-01, PNorm = 66.5873, GNorm = 4.4331, lr_0 = 9.9521e-04
Validation auc = 0.605095
Validation accuracy = 0.597345
Validation f1 = 0.697674
Validation binary_cross_entropy = 0.733611
Epoch 2
Loss = 2.0855e-01, PNorm = 66.7104, GNorm = 2.5707, lr_0 = 9.7163e-04
Loss = 2.2648e-01, PNorm = 66.8051, GNorm = 3.1528, lr_0 = 9.4860e-04
Validation auc = 0.585913
Validation accuracy = 0.721239
Validation f1 = 0.830189
Validation binary_cross_entropy = 0.883528
Epoch 3
Loss = 1.4933e-01, PNorm = 66.8967, GNorm = 1.7323, lr_0 = 9.2390e-04
Loss = 2.1757e-01, PNorm = 66.9599, GNorm = 3.5514, lr_0 = 9.0200e-04
Validation auc = 0.546534
Validation accuracy = 0.668142
Validation f1 = 0.787535
Validation binary_cross_entropy = 1.075026
Epoch 4
Loss = 1.6894e-01, PNorm = 67.0115, GNorm = 1.2982, lr_0 = 8.8063e-04
Loss = 2.0078e-01, PNorm = 67.0593, GNorm = 2.7678, lr_0 = 8.5976e-04
Validation auc = 0.543794
Validation accuracy = 0.676991
Validation f1 = 0.797784
Validation binary_cross_entropy = 1.122705
Epoch 5
Loss = 1.2708e-01, PNorm = 67.1141, GNorm = 2.4030, lr_0 = 8.3737e-04
Loss = 1.0638e-01, PNorm = 67.1558, GNorm = 1.0922, lr_0 = 8.1752e-04
Validation auc = 0.611692
Validation accuracy = 0.676991
Validation f1 = 0.779456
Validation binary_cross_entropy = 1.014250
Epoch 6
Loss = 1.2439e-01, PNorm = 67.1922, GNorm = 1.3234, lr_0 = 7.9815e-04
Loss = 1.2840e-01, PNorm = 67.2251, GNorm = 2.7282, lr_0 = 7.7923e-04
Validation auc = 0.618289
Validation accuracy = 0.725664
Validation f1 = 0.820809
Validation binary_cross_entropy = 1.080322
Epoch 7
Loss = 9.2803e-02, PNorm = 67.2581, GNorm = 1.9899, lr_0 = 7.6076e-04
Loss = 1.0384e-01, PNorm = 67.2891, GNorm = 1.5612, lr_0 = 7.4273e-04
Validation auc = 0.574140
Validation accuracy = 0.668142
Validation f1 = 0.782609
Validation binary_cross_entropy = 1.171785
Epoch 8
Loss = 7.4358e-02, PNorm = 67.3198, GNorm = 1.4822, lr_0 = 7.2339e-04
Loss = 1.4026e-01, PNorm = 67.3478, GNorm = 2.6213, lr_0 = 7.0625e-04
Validation auc = 0.609561
Validation accuracy = 0.685841
Validation f1 = 0.790560
Validation binary_cross_entropy = 1.063455
Epoch 9
Loss = 7.1180e-02, PNorm = 67.3726, GNorm = 2.3832, lr_0 = 6.8951e-04
Loss = 9.7814e-02, PNorm = 67.3956, GNorm = 1.3278, lr_0 = 6.7317e-04
Validation auc = 0.656145
Validation accuracy = 0.703540
Validation f1 = 0.801187
Validation binary_cross_entropy = 1.001732
Epoch 10
Loss = 1.1767e-01, PNorm = 67.4200, GNorm = 0.6230, lr_0 = 6.5564e-04
Loss = 1.0602e-01, PNorm = 67.4432, GNorm = 2.3322, lr_0 = 6.4010e-04
Validation auc = 0.655333
Validation accuracy = 0.747788
Validation f1 = 0.840336
Validation binary_cross_entropy = 1.118985
Epoch 11
Loss = 7.4327e-02, PNorm = 67.4643, GNorm = 1.4777, lr_0 = 6.2493e-04
Loss = 1.1697e-01, PNorm = 67.4839, GNorm = 1.3013, lr_0 = 6.1012e-04
Validation auc = 0.676748
Validation accuracy = 0.699115
Validation f1 = 0.798817
Validation binary_cross_entropy = 1.038530
Epoch 12
Loss = 6.9027e-02, PNorm = 67.5050, GNorm = 0.8274, lr_0 = 5.9424e-04
Loss = 9.7456e-02, PNorm = 67.5241, GNorm = 1.6822, lr_0 = 5.8015e-04
Validation auc = 0.652492
Validation accuracy = 0.685841
Validation f1 = 0.789318
Validation binary_cross_entropy = 1.068515
Epoch 13
Loss = 4.6070e-02, PNorm = 67.5417, GNorm = 1.4115, lr_0 = 5.6640e-04
Loss = 6.0254e-02, PNorm = 67.5598, GNorm = 0.6258, lr_0 = 5.5298e-04
Validation auc = 0.649447
Validation accuracy = 0.699115
Validation f1 = 0.800000
Validation binary_cross_entropy = 1.100830
Epoch 14
Loss = 1.0909e-01, PNorm = 67.5745, GNorm = 1.4629, lr_0 = 5.3987e-04
Loss = 8.3015e-02, PNorm = 67.5872, GNorm = 0.9529, lr_0 = 5.2708e-04
Validation auc = 0.649142
Validation accuracy = 0.663717
Validation f1 = 0.765432
Validation binary_cross_entropy = 1.150735
Epoch 15
Loss = 1.1555e-01, PNorm = 67.5992, GNorm = 1.5956, lr_0 = 5.1335e-04
Loss = 6.0168e-02, PNorm = 67.6142, GNorm = 1.2537, lr_0 = 5.0119e-04
Validation auc = 0.618695
Validation accuracy = 0.685841
Validation f1 = 0.786787
Validation binary_cross_entropy = 1.199932
Epoch 16
Loss = 7.1627e-02, PNorm = 67.6257, GNorm = 1.5182, lr_0 = 4.8931e-04
Loss = 5.5469e-02, PNorm = 67.6369, GNorm = 1.0737, lr_0 = 4.7771e-04
Validation auc = 0.611083
Validation accuracy = 0.659292
Validation f1 = 0.764526
Validation binary_cross_entropy = 1.278410
Epoch 17
Loss = 4.4640e-02, PNorm = 67.6497, GNorm = 0.9204, lr_0 = 4.6527e-04
Loss = 7.1755e-02, PNorm = 67.6595, GNorm = 1.0928, lr_0 = 4.5425e-04
Loss = 5.3837e-02, PNorm = 67.6703, GNorm = 1.4288, lr_0 = 4.4348e-04
Validation auc = 0.623972
Validation accuracy = 0.659292
Validation f1 = 0.764526
Validation binary_cross_entropy = 1.238005
Epoch 18
Loss = 5.9495e-02, PNorm = 67.6801, GNorm = 0.3592, lr_0 = 4.3297e-04
Loss = 7.6331e-02, PNorm = 67.6865, GNorm = 1.3954, lr_0 = 4.2271e-04
Validation auc = 0.629960
Validation accuracy = 0.650442
Validation f1 = 0.752351
Validation binary_cross_entropy = 1.267724
Epoch 19
Loss = 5.3325e-02, PNorm = 67.6943, GNorm = 0.9985, lr_0 = 4.1269e-04
Loss = 5.8083e-02, PNorm = 67.7028, GNorm = 2.2706, lr_0 = 4.0291e-04
Validation auc = 0.625292
Validation accuracy = 0.681416
Validation f1 = 0.788235
Validation binary_cross_entropy = 1.315986
Epoch 20
Loss = 7.1974e-02, PNorm = 67.7099, GNorm = 1.1662, lr_0 = 3.9242e-04
Loss = 4.6281e-02, PNorm = 67.7170, GNorm = 0.7247, lr_0 = 3.8312e-04
Validation auc = 0.606668
Validation accuracy = 0.663717
Validation f1 = 0.772455
Validation binary_cross_entropy = 1.423644
Epoch 21
Loss = 4.5426e-02, PNorm = 67.7252, GNorm = 0.1029, lr_0 = 3.7404e-04
Loss = 3.1776e-02, PNorm = 67.7316, GNorm = 0.2637, lr_0 = 3.6517e-04
Validation auc = 0.607175
Validation accuracy = 0.650442
Validation f1 = 0.761329
Validation binary_cross_entropy = 1.461495
Epoch 22
Loss = 6.3952e-02, PNorm = 67.7370, GNorm = 0.9401, lr_0 = 3.5567e-04
Loss = 7.0315e-02, PNorm = 67.7426, GNorm = 0.8054, lr_0 = 3.4724e-04
Validation auc = 0.593931
Validation accuracy = 0.646018
Validation f1 = 0.761905
Validation binary_cross_entropy = 1.544556
Epoch 23
Loss = 4.9697e-02, PNorm = 67.7506, GNorm = 0.3767, lr_0 = 3.3901e-04
Loss = 4.8524e-02, PNorm = 67.7563, GNorm = 0.9437, lr_0 = 3.3097e-04
Validation auc = 0.576779
Validation accuracy = 0.623894
Validation f1 = 0.746269
Validation binary_cross_entropy = 1.633955
Epoch 24
Loss = 5.5945e-02, PNorm = 67.7636, GNorm = 1.2911, lr_0 = 3.2235e-04
Loss = 9.2841e-02, PNorm = 67.7696, GNorm = 0.8485, lr_0 = 3.1471e-04
Validation auc = 0.581092
Validation accuracy = 0.632743
Validation f1 = 0.756598
Validation binary_cross_entropy = 1.661286
Epoch 25
Loss = 5.4842e-02, PNorm = 67.7748, GNorm = 2.0829, lr_0 = 3.0726e-04
Loss = 6.9676e-02, PNorm = 67.7813, GNorm = 1.9851, lr_0 = 2.9997e-04
Validation auc = 0.597737
Validation accuracy = 0.672566
Validation f1 = 0.781065
Validation binary_cross_entropy = 1.527453
Epoch 26
Loss = 6.3956e-02, PNorm = 67.7877, GNorm = 2.4398, lr_0 = 2.9286e-04
Loss = 5.3448e-02, PNorm = 67.7931, GNorm = 1.7084, lr_0 = 2.8592e-04
Validation auc = 0.614229
Validation accuracy = 0.676991
Validation f1 = 0.780781
Validation binary_cross_entropy = 1.535132
Epoch 27
Loss = 7.5435e-02, PNorm = 67.7986, GNorm = 1.3294, lr_0 = 2.7848e-04
Loss = 6.2724e-02, PNorm = 67.8034, GNorm = 1.1195, lr_0 = 2.7188e-04
Validation auc = 0.582107
Validation accuracy = 0.646018
Validation f1 = 0.763314
Validation binary_cross_entropy = 1.615145
Epoch 28
Loss = 6.0291e-02, PNorm = 67.8077, GNorm = 2.3545, lr_0 = 2.6544e-04
Loss = 6.3858e-02, PNorm = 67.8124, GNorm = 1.9428, lr_0 = 2.5914e-04
Validation auc = 0.583680
Validation accuracy = 0.646018
Validation f1 = 0.764706
Validation binary_cross_entropy = 1.594122
Epoch 29
Loss = 5.6957e-02, PNorm = 67.8182, GNorm = 0.4023, lr_0 = 2.5240e-04
Loss = 6.3009e-02, PNorm = 67.8220, GNorm = 0.9733, lr_0 = 2.4641e-04
Validation auc = 0.585710
Validation accuracy = 0.637168
Validation f1 = 0.750000
Validation binary_cross_entropy = 1.572214
Epoch 30
Loss = 4.9517e-02, PNorm = 67.8255, GNorm = 0.9799, lr_0 = 2.4057e-04
Loss = 3.9325e-02, PNorm = 67.8287, GNorm = 1.1761, lr_0 = 2.3487e-04
Validation auc = 0.588247
Validation accuracy = 0.654867
Validation f1 = 0.766467
Validation binary_cross_entropy = 1.575908
Epoch 31
Loss = 4.1285e-02, PNorm = 67.8316, GNorm = 0.9177, lr_0 = 2.2876e-04
Loss = 5.1887e-02, PNorm = 67.8348, GNorm = 1.5450, lr_0 = 2.2334e-04
Validation auc = 0.576982
Validation accuracy = 0.628319
Validation f1 = 0.743902
Validation binary_cross_entropy = 1.638120
Epoch 32
Loss = 2.8491e-02, PNorm = 67.8368, GNorm = 0.9248, lr_0 = 2.1804e-04
Loss = 3.4692e-02, PNorm = 67.8389, GNorm = 1.3248, lr_0 = 2.1288e-04
Validation auc = 0.556683
Validation accuracy = 0.615044
Validation f1 = 0.737160
Validation binary_cross_entropy = 1.733557
Epoch 33
Loss = 2.6403e-02, PNorm = 67.8417, GNorm = 0.6975, lr_0 = 2.0783e-04
Loss = 3.4015e-02, PNorm = 67.8442, GNorm = 0.7852, lr_0 = 2.0290e-04
Validation auc = 0.551253
Validation accuracy = 0.588496
Validation f1 = 0.713846
Validation binary_cross_entropy = 1.790317
Epoch 34
Loss = 2.0661e-02, PNorm = 67.8460, GNorm = 0.5839, lr_0 = 1.9762e-04
Loss = 5.9096e-02, PNorm = 67.8477, GNorm = 1.1950, lr_0 = 1.9294e-04
Loss = 2.9234e-02, PNorm = 67.8496, GNorm = 0.6574, lr_0 = 1.8836e-04
Validation auc = 0.554653
Validation accuracy = 0.606195
Validation f1 = 0.732733
Validation binary_cross_entropy = 1.787909
Epoch 35
Loss = 5.4871e-02, PNorm = 67.8509, GNorm = 0.5587, lr_0 = 1.8390e-04
Loss = 4.5968e-02, PNorm = 67.8537, GNorm = 1.0856, lr_0 = 1.7954e-04
Loss = 5.2111e-02, PNorm = 67.8540, GNorm = 1.2806, lr_0 = 1.7911e-04
Validation auc = 0.552268
Validation accuracy = 0.606195
Validation f1 = 0.729483
Validation binary_cross_entropy = 1.823475
Epoch 36
Loss = 4.6380e-02, PNorm = 67.8573, GNorm = 0.2688, lr_0 = 1.7487e-04
Loss = 4.3074e-02, PNorm = 67.8599, GNorm = 1.6529, lr_0 = 1.7072e-04
Validation auc = 0.553233
Validation accuracy = 0.628319
Validation f1 = 0.751479
Validation binary_cross_entropy = 2.196597
Epoch 37
Loss = 3.4688e-02, PNorm = 67.8611, GNorm = 1.5455, lr_0 = 1.6668e-04
Loss = 5.4219e-02, PNorm = 67.8627, GNorm = 1.6831, lr_0 = 1.6273e-04
Validation auc = 0.562621
Validation accuracy = 0.619469
Validation f1 = 0.740964
Validation binary_cross_entropy = 1.818650
Epoch 38
Loss = 4.9581e-02, PNorm = 67.8642, GNorm = 0.8663, lr_0 = 1.5887e-04
Loss = 4.1436e-02, PNorm = 67.8655, GNorm = 0.4566, lr_0 = 1.5510e-04
Validation auc = 0.562570
Validation accuracy = 0.623894
Validation f1 = 0.744745
Validation binary_cross_entropy = 1.822438
Epoch 39
Loss = 5.5387e-02, PNorm = 67.8681, GNorm = 1.4681, lr_0 = 1.5107e-04
Loss = 4.9512e-02, PNorm = 67.8694, GNorm = 1.2838, lr_0 = 1.4749e-04
Validation auc = 0.557241
Validation accuracy = 0.628319
Validation f1 = 0.748503
Validation binary_cross_entropy = 1.849231
Epoch 40
Loss = 5.7434e-02, PNorm = 67.8699, GNorm = 0.6667, lr_0 = 1.4399e-04
Loss = 5.3863e-02, PNorm = 67.8711, GNorm = 1.1914, lr_0 = 1.4058e-04
Validation auc = 0.559271
Validation accuracy = 0.628319
Validation f1 = 0.748503
Validation binary_cross_entropy = 1.812527
Epoch 41
Loss = 5.3169e-02, PNorm = 67.8723, GNorm = 0.5885, lr_0 = 1.3692e-04
Loss = 4.0877e-02, PNorm = 67.8743, GNorm = 1.2005, lr_0 = 1.3367e-04
Validation auc = 0.558459
Validation accuracy = 0.641593
Validation f1 = 0.763848
Validation binary_cross_entropy = 1.826338
Epoch 42
Loss = 5.9512e-02, PNorm = 67.8755, GNorm = 0.3676, lr_0 = 1.3050e-04
Loss = 4.9950e-02, PNorm = 67.8765, GNorm = 0.8922, lr_0 = 1.2741e-04
Validation auc = 0.565615
Validation accuracy = 0.637168
Validation f1 = 0.753012
Validation binary_cross_entropy = 1.806010
Epoch 43
Loss = 4.0775e-02, PNorm = 67.8786, GNorm = 0.7112, lr_0 = 1.2409e-04
Loss = 2.3073e-02, PNorm = 67.8802, GNorm = 1.1530, lr_0 = 1.2115e-04
Validation auc = 0.569826
Validation accuracy = 0.650442
Validation f1 = 0.762763
Validation binary_cross_entropy = 1.808613
Epoch 44
Loss = 3.8588e-02, PNorm = 67.8817, GNorm = 0.9181, lr_0 = 1.1828e-04
Loss = 2.8848e-02, PNorm = 67.8828, GNorm = 0.5853, lr_0 = 1.1548e-04
Validation auc = 0.567441
Validation accuracy = 0.646018
Validation f1 = 0.759036
Validation binary_cross_entropy = 1.835843
Epoch 45
Loss = 1.1606e-02, PNorm = 67.8837, GNorm = 0.1473, lr_0 = 1.1274e-04
Loss = 2.4538e-02, PNorm = 67.8846, GNorm = 0.2254, lr_0 = 1.1007e-04
Validation auc = 0.565158
Validation accuracy = 0.637168
Validation f1 = 0.751515
Validation binary_cross_entropy = 1.863934
Epoch 46
Loss = 2.5250e-02, PNorm = 67.8857, GNorm = 0.1882, lr_0 = 1.0720e-04
Loss = 3.2539e-02, PNorm = 67.8866, GNorm = 0.7630, lr_0 = 1.0466e-04
Validation auc = 0.562621
Validation accuracy = 0.628319
Validation f1 = 0.743902
Validation binary_cross_entropy = 1.919810
Epoch 47
Loss = 3.8169e-02, PNorm = 67.8876, GNorm = 0.4502, lr_0 = 1.0218e-04
Loss = 3.9422e-02, PNorm = 67.8884, GNorm = 0.3861, lr_0 = 1.0000e-04
Validation auc = 0.561961
Validation accuracy = 0.637168
Validation f1 = 0.753012
Validation binary_cross_entropy = 1.926148
Epoch 48
Loss = 6.5363e-02, PNorm = 67.8896, GNorm = 3.8498, lr_0 = 1.0000e-04
Loss = 3.6795e-02, PNorm = 67.8908, GNorm = 1.8183, lr_0 = 1.0000e-04
Validation auc = 0.560185
Validation accuracy = 0.637168
Validation f1 = 0.757396
Validation binary_cross_entropy = 1.918620
Epoch 49
Loss = 3.4906e-02, PNorm = 67.8920, GNorm = 0.9575, lr_0 = 1.0000e-04
Loss = 3.0586e-02, PNorm = 67.8930, GNorm = 0.2234, lr_0 = 1.0000e-04
Validation auc = 0.553892
Validation accuracy = 0.637168
Validation f1 = 0.760234
Validation binary_cross_entropy = 2.314513
Model 0 best validation auc = 0.676748 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.947012
Model 0 test accuracy = 0.910853
Model 0 test f1 = 0.933333
Model 0 test binary_cross_entropy = 0.345140
Ensemble test auc = 0.947012
Ensemble test accuracy = 0.910853
Ensemble test f1 = 0.933333
Ensemble test binary_cross_entropy = 0.345140
Fold 1
Splitting data with seed 1
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35000000000000003, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35000000000000003, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 7.5690e-01, PNorm = 66.3011, GNorm = 5.3088, lr_0 = 3.4750e-04
Loss = 5.6815e-01, PNorm = 66.3525, GNorm = 5.1021, lr_0 = 5.7250e-04
Loss = 6.3264e-01, PNorm = 66.3595, GNorm = 6.1762, lr_0 = 5.9500e-04
Validation auc = 0.620623
Validation accuracy = 0.597345
Validation f1 = 0.687285
Validation binary_cross_entropy = 0.701575
Epoch 1
Loss = 3.4376e-01, PNorm = 66.4565, GNorm = 3.0398, lr_0 = 8.2000e-04
Loss = 3.6398e-01, PNorm = 66.5800, GNorm = 3.7230, lr_0 = 9.9521e-04
Validation auc = 0.718563
Validation accuracy = 0.747788
Validation f1 = 0.838527
Validation binary_cross_entropy = 0.634578
Epoch 2
Loss = 2.3446e-01, PNorm = 66.7116, GNorm = 4.1562, lr_0 = 9.7163e-04
Loss = 2.5026e-01, PNorm = 66.8190, GNorm = 4.3278, lr_0 = 9.4860e-04
Validation auc = 0.712778
Validation accuracy = 0.738938
Validation f1 = 0.830946
Validation binary_cross_entropy = 0.799672
Epoch 3
Loss = 1.7781e-01, PNorm = 66.9232, GNorm = 2.0157, lr_0 = 9.2390e-04
Loss = 2.6793e-01, PNorm = 66.9958, GNorm = 2.4219, lr_0 = 9.0200e-04
Validation auc = 0.685071
Validation accuracy = 0.752212
Validation f1 = 0.843575
Validation binary_cross_entropy = 0.908417
Epoch 4
Loss = 2.0110e-01, PNorm = 67.0594, GNorm = 1.6024, lr_0 = 8.8063e-04
Loss = 1.6410e-01, PNorm = 67.1159, GNorm = 1.1294, lr_0 = 8.5976e-04
Validation auc = 0.745763
Validation accuracy = 0.730088
Validation f1 = 0.832877
Validation binary_cross_entropy = 1.001991
Epoch 5
Loss = 1.1956e-01, PNorm = 67.1677, GNorm = 1.5469, lr_0 = 8.3737e-04
Loss = 1.5826e-01, PNorm = 67.2092, GNorm = 2.4476, lr_0 = 8.1752e-04
Validation auc = 0.706282
Validation accuracy = 0.730088
Validation f1 = 0.828169
Validation binary_cross_entropy = 0.990597
Epoch 6
Loss = 1.0005e-01, PNorm = 67.2458, GNorm = 0.6348, lr_0 = 7.9815e-04
Loss = 1.2022e-01, PNorm = 67.2784, GNorm = 2.2710, lr_0 = 7.7923e-04
Validation auc = 0.745052
Validation accuracy = 0.738938
Validation f1 = 0.837466
Validation binary_cross_entropy = 1.056494
Epoch 7
Loss = 1.3089e-01, PNorm = 67.3090, GNorm = 1.4250, lr_0 = 7.6076e-04
Loss = 1.1293e-01, PNorm = 67.3386, GNorm = 2.2045, lr_0 = 7.4273e-04
Validation auc = 0.736121
Validation accuracy = 0.747788
Validation f1 = 0.841226
Validation binary_cross_entropy = 1.004493
Epoch 8
Loss = 1.1154e-01, PNorm = 67.3668, GNorm = 1.8523, lr_0 = 7.2339e-04
Loss = 9.8436e-02, PNorm = 67.3905, GNorm = 2.2034, lr_0 = 7.0625e-04
Validation auc = 0.686390
Validation accuracy = 0.725664
Validation f1 = 0.829670
Validation binary_cross_entropy = 1.176618
Epoch 9
Loss = 6.0974e-02, PNorm = 67.4173, GNorm = 0.8429, lr_0 = 6.8951e-04
Loss = 1.3233e-01, PNorm = 67.4391, GNorm = 2.0720, lr_0 = 6.7317e-04
Validation auc = 0.730742
Validation accuracy = 0.756637
Validation f1 = 0.845070
Validation binary_cross_entropy = 1.076249
Epoch 10
Loss = 6.8602e-02, PNorm = 67.4670, GNorm = 1.1199, lr_0 = 6.5564e-04
Loss = 9.5042e-02, PNorm = 67.4881, GNorm = 0.3502, lr_0 = 6.4010e-04
Validation auc = 0.740181
Validation accuracy = 0.747788
Validation f1 = 0.842975
Validation binary_cross_entropy = 1.089912
Epoch 11
Loss = 6.6329e-02, PNorm = 67.5069, GNorm = 0.4521, lr_0 = 6.2493e-04
Loss = 6.0603e-02, PNorm = 67.5268, GNorm = 1.4882, lr_0 = 6.1012e-04
Validation auc = 0.723384
Validation accuracy = 0.743363
Validation f1 = 0.843243
Validation binary_cross_entropy = 1.316992
Epoch 12
Loss = 1.2959e-01, PNorm = 67.5442, GNorm = 1.7782, lr_0 = 5.9424e-04
Loss = 7.1977e-02, PNorm = 67.5607, GNorm = 1.2948, lr_0 = 5.8015e-04
Validation auc = 0.699482
Validation accuracy = 0.738938
Validation f1 = 0.836565
Validation binary_cross_entropy = 1.313875
Epoch 13
Loss = 8.3446e-02, PNorm = 67.5787, GNorm = 1.2870, lr_0 = 5.6640e-04
Loss = 5.3576e-02, PNorm = 67.5966, GNorm = 0.5068, lr_0 = 5.5298e-04
Validation auc = 0.699888
Validation accuracy = 0.738938
Validation f1 = 0.839237
Validation binary_cross_entropy = 1.515391
Epoch 14
Loss = 7.2642e-02, PNorm = 67.6087, GNorm = 1.3905, lr_0 = 5.3987e-04
Loss = 9.3978e-02, PNorm = 67.6213, GNorm = 1.3174, lr_0 = 5.2708e-04
Validation auc = 0.730843
Validation accuracy = 0.743363
Validation f1 = 0.836158
Validation binary_cross_entropy = 1.372656
Epoch 15
Loss = 2.7264e-02, PNorm = 67.6394, GNorm = 0.5150, lr_0 = 5.1335e-04
Loss = 7.4703e-02, PNorm = 67.6549, GNorm = 1.1892, lr_0 = 5.0119e-04
Validation auc = 0.743834
Validation accuracy = 0.756637
Validation f1 = 0.847645
Validation binary_cross_entropy = 1.298452
Epoch 16
Loss = 2.0615e-02, PNorm = 67.6661, GNorm = 0.6716, lr_0 = 4.8931e-04
Loss = 6.3257e-02, PNorm = 67.6765, GNorm = 1.2217, lr_0 = 4.7771e-04
Validation auc = 0.742413
Validation accuracy = 0.738938
Validation f1 = 0.839237
Validation binary_cross_entropy = 1.361536
Epoch 17
Loss = 2.3235e-02, PNorm = 67.6873, GNorm = 0.3506, lr_0 = 4.6527e-04
Loss = 9.0126e-02, PNorm = 67.6979, GNorm = 1.7028, lr_0 = 4.5425e-04
Loss = 6.6259e-02, PNorm = 67.7067, GNorm = 0.1048, lr_0 = 4.4348e-04
Validation auc = 0.738861
Validation accuracy = 0.752212
Validation f1 = 0.845304
Validation binary_cross_entropy = 1.342204
Epoch 18
Loss = 6.8475e-02, PNorm = 67.7161, GNorm = 0.8454, lr_0 = 4.3297e-04
Loss = 5.6806e-02, PNorm = 67.7232, GNorm = 1.6441, lr_0 = 4.2271e-04
Validation auc = 0.729169
Validation accuracy = 0.738938
Validation f1 = 0.837466
Validation binary_cross_entropy = 1.431608
Epoch 19
Loss = 7.0057e-02, PNorm = 67.7316, GNorm = 0.8826, lr_0 = 4.1269e-04
Loss = 7.0121e-02, PNorm = 67.7389, GNorm = 0.1926, lr_0 = 4.0291e-04
Validation auc = 0.729727
Validation accuracy = 0.725664
Validation f1 = 0.827778
Validation binary_cross_entropy = 1.437660
Epoch 20
Loss = 6.2152e-02, PNorm = 67.7485, GNorm = 1.1821, lr_0 = 3.9242e-04
Loss = 5.3250e-02, PNorm = 67.7582, GNorm = 0.6120, lr_0 = 3.8312e-04
Validation auc = 0.719730
Validation accuracy = 0.743363
Validation f1 = 0.843243
Validation binary_cross_entropy = 2.017650
Epoch 21
Loss = 4.6552e-02, PNorm = 67.7645, GNorm = 1.4700, lr_0 = 3.7404e-04
Loss = 6.4773e-02, PNorm = 67.7710, GNorm = 1.2988, lr_0 = 3.6517e-04
Validation auc = 0.713641
Validation accuracy = 0.721239
Validation f1 = 0.829268
Validation binary_cross_entropy = 1.983903
Epoch 22
Loss = 5.9506e-02, PNorm = 67.7762, GNorm = 0.6319, lr_0 = 3.5567e-04
Loss = 5.5959e-02, PNorm = 67.7817, GNorm = 1.8124, lr_0 = 3.4724e-04
Validation auc = 0.689384
Validation accuracy = 0.721239
Validation f1 = 0.828338
Validation binary_cross_entropy = 2.033719
Epoch 23
Loss = 6.1688e-02, PNorm = 67.7863, GNorm = 1.3970, lr_0 = 3.3901e-04
Loss = 6.0803e-02, PNorm = 67.7921, GNorm = 0.4757, lr_0 = 3.3097e-04
Validation auc = 0.689739
Validation accuracy = 0.707965
Validation f1 = 0.817680
Validation binary_cross_entropy = 1.652194
Epoch 24
Loss = 4.6254e-02, PNorm = 67.7997, GNorm = 0.4305, lr_0 = 3.2235e-04
Loss = 5.3365e-02, PNorm = 67.8061, GNorm = 0.6945, lr_0 = 3.1471e-04
Validation auc = 0.699888
Validation accuracy = 0.738938
Validation f1 = 0.837466
Validation binary_cross_entropy = 1.655590
Epoch 25
Loss = 8.3393e-02, PNorm = 67.8102, GNorm = 1.0856, lr_0 = 3.0726e-04
Loss = 7.3051e-02, PNorm = 67.8166, GNorm = 1.8526, lr_0 = 2.9997e-04
Validation auc = 0.700802
Validation accuracy = 0.725664
Validation f1 = 0.830601
Validation binary_cross_entropy = 1.713152
Epoch 26
Loss = 4.9157e-02, PNorm = 67.8247, GNorm = 1.0662, lr_0 = 2.9286e-04
Loss = 4.2531e-02, PNorm = 67.8315, GNorm = 0.5347, lr_0 = 2.8592e-04
Validation auc = 0.703745
Validation accuracy = 0.730088
Validation f1 = 0.833787
Validation binary_cross_entropy = 1.730735
Epoch 27
Loss = 4.5115e-02, PNorm = 67.8364, GNorm = 1.0199, lr_0 = 2.7848e-04
Loss = 4.3862e-02, PNorm = 67.8408, GNorm = 0.1754, lr_0 = 2.7188e-04
Validation auc = 0.720491
Validation accuracy = 0.738938
Validation f1 = 0.837466
Validation binary_cross_entropy = 1.690362
Epoch 28
Loss = 3.5191e-02, PNorm = 67.8433, GNorm = 1.1985, lr_0 = 2.6544e-04
Loss = 3.1742e-02, PNorm = 67.8465, GNorm = 1.4214, lr_0 = 2.5914e-04
Validation auc = 0.713793
Validation accuracy = 0.725664
Validation f1 = 0.830601
Validation binary_cross_entropy = 2.156717
Epoch 29
Loss = 6.3508e-02, PNorm = 67.8499, GNorm = 1.0652, lr_0 = 2.5240e-04
Loss = 3.7594e-02, PNorm = 67.8529, GNorm = 0.4820, lr_0 = 2.4641e-04
Validation auc = 0.710545
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 1.767220
Epoch 30
Loss = 6.0751e-02, PNorm = 67.8554, GNorm = 1.2695, lr_0 = 2.4057e-04
Loss = 3.8220e-02, PNorm = 67.8591, GNorm = 0.4138, lr_0 = 2.3487e-04
Validation auc = 0.719375
Validation accuracy = 0.734513
Validation f1 = 0.836066
Validation binary_cross_entropy = 1.773502
Epoch 31
Loss = 6.5143e-02, PNorm = 67.8629, GNorm = 1.6819, lr_0 = 2.2876e-04
Loss = 5.4264e-02, PNorm = 67.8651, GNorm = 0.9682, lr_0 = 2.2334e-04
Validation auc = 0.722166
Validation accuracy = 0.743363
Validation f1 = 0.840659
Validation binary_cross_entropy = 1.714047
Epoch 32
Loss = 5.0234e-02, PNorm = 67.8669, GNorm = 1.0615, lr_0 = 2.1804e-04
Loss = 2.9164e-02, PNorm = 67.8701, GNorm = 0.4067, lr_0 = 2.1288e-04
Validation auc = 0.719832
Validation accuracy = 0.743363
Validation f1 = 0.840659
Validation binary_cross_entropy = 1.719282
Epoch 33
Loss = 1.4926e-02, PNorm = 67.8731, GNorm = 0.8263, lr_0 = 2.0783e-04
Loss = 2.8765e-02, PNorm = 67.8761, GNorm = 0.2248, lr_0 = 2.0290e-04
Validation auc = 0.719882
Validation accuracy = 0.743363
Validation f1 = 0.841530
Validation binary_cross_entropy = 2.184601
Epoch 34
Loss = 5.2088e-02, PNorm = 67.8787, GNorm = 0.9746, lr_0 = 1.9762e-04
Loss = 3.1118e-02, PNorm = 67.8802, GNorm = 0.2126, lr_0 = 1.9294e-04
Loss = 5.2591e-02, PNorm = 67.8823, GNorm = 1.5967, lr_0 = 1.8836e-04
Validation auc = 0.709987
Validation accuracy = 0.747788
Validation f1 = 0.843836
Validation binary_cross_entropy = 2.213390
Epoch 35
Loss = 1.9654e-02, PNorm = 67.8841, GNorm = 0.1748, lr_0 = 1.8390e-04
Loss = 4.5402e-02, PNorm = 67.8855, GNorm = 0.3454, lr_0 = 1.7954e-04
Loss = 2.3200e-02, PNorm = 67.8856, GNorm = 0.7375, lr_0 = 1.7911e-04
Validation auc = 0.716178
Validation accuracy = 0.734513
Validation f1 = 0.835165
Validation binary_cross_entropy = 2.213831
Epoch 36
Loss = 2.9914e-02, PNorm = 67.8872, GNorm = 0.4393, lr_0 = 1.7487e-04
Loss = 5.9141e-02, PNorm = 67.8888, GNorm = 0.6815, lr_0 = 1.7072e-04
Validation auc = 0.710494
Validation accuracy = 0.734513
Validation f1 = 0.836066
Validation binary_cross_entropy = 2.632122
Epoch 37
Loss = 3.6794e-02, PNorm = 67.8902, GNorm = 2.3577, lr_0 = 1.6668e-04
Loss = 6.3398e-02, PNorm = 67.8911, GNorm = 1.4197, lr_0 = 1.6273e-04
Validation auc = 0.710748
Validation accuracy = 0.730088
Validation f1 = 0.831025
Validation binary_cross_entropy = 2.208565
Epoch 38
Loss = 4.4191e-02, PNorm = 67.8929, GNorm = 0.9447, lr_0 = 1.5887e-04
Loss = 3.4727e-02, PNorm = 67.8955, GNorm = 0.5372, lr_0 = 1.5510e-04
Validation auc = 0.718157
Validation accuracy = 0.734513
Validation f1 = 0.835165
Validation binary_cross_entropy = 2.221652
Epoch 39
Loss = 3.5601e-02, PNorm = 67.8978, GNorm = 1.1199, lr_0 = 1.5107e-04
Loss = 2.5247e-02, PNorm = 67.8993, GNorm = 1.1657, lr_0 = 1.4749e-04
Validation auc = 0.719781
Validation accuracy = 0.747788
Validation f1 = 0.843836
Validation binary_cross_entropy = 2.260288
Epoch 40
Loss = 4.1456e-02, PNorm = 67.9006, GNorm = 0.6283, lr_0 = 1.4399e-04
Loss = 5.2833e-02, PNorm = 67.9017, GNorm = 0.5372, lr_0 = 1.4058e-04
Validation auc = 0.716888
Validation accuracy = 0.743363
Validation f1 = 0.840659
Validation binary_cross_entropy = 2.283185
Epoch 41
Loss = 5.4772e-02, PNorm = 67.9030, GNorm = 1.2074, lr_0 = 1.3692e-04
Loss = 3.6568e-02, PNorm = 67.9035, GNorm = 0.2386, lr_0 = 1.3367e-04
Validation auc = 0.709733
Validation accuracy = 0.734513
Validation f1 = 0.834254
Validation binary_cross_entropy = 2.663714
Epoch 42
Loss = 3.0995e-02, PNorm = 67.9039, GNorm = 0.6811, lr_0 = 1.3050e-04
Loss = 2.7538e-02, PNorm = 67.9051, GNorm = 0.8100, lr_0 = 1.2741e-04
Validation auc = 0.707247
Validation accuracy = 0.730088
Validation f1 = 0.831025
Validation binary_cross_entropy = 2.643181
Epoch 43
Loss = 2.4486e-02, PNorm = 67.9066, GNorm = 0.5537, lr_0 = 1.2409e-04
Loss = 3.5499e-02, PNorm = 67.9080, GNorm = 0.4292, lr_0 = 1.2115e-04
Validation auc = 0.712423
Validation accuracy = 0.730088
Validation f1 = 0.831956
Validation binary_cross_entropy = 2.705607
Epoch 44
Loss = 3.9728e-02, PNorm = 67.9091, GNorm = 0.8853, lr_0 = 1.1828e-04
Loss = 3.2079e-02, PNorm = 67.9100, GNorm = 0.8366, lr_0 = 1.1548e-04
Validation auc = 0.709581
Validation accuracy = 0.734513
Validation f1 = 0.836066
Validation binary_cross_entropy = 3.479443
Epoch 45
Loss = 3.5341e-02, PNorm = 67.9108, GNorm = 0.2220, lr_0 = 1.1274e-04
Loss = 5.0443e-02, PNorm = 67.9119, GNorm = 1.0908, lr_0 = 1.1007e-04
Validation auc = 0.711255
Validation accuracy = 0.734513
Validation f1 = 0.834254
Validation binary_cross_entropy = 3.077748
Epoch 46
Loss = 2.8091e-02, PNorm = 67.9132, GNorm = 0.8517, lr_0 = 1.0720e-04
Loss = 2.9774e-02, PNorm = 67.9146, GNorm = 0.1597, lr_0 = 1.0466e-04
Validation auc = 0.712879
Validation accuracy = 0.730088
Validation f1 = 0.831025
Validation binary_cross_entropy = 3.445565
Epoch 47
Loss = 3.8269e-02, PNorm = 67.9158, GNorm = 2.7001, lr_0 = 1.0218e-04
Loss = 3.4015e-02, PNorm = 67.9166, GNorm = 0.7198, lr_0 = 1.0000e-04
Validation auc = 0.710900
Validation accuracy = 0.725664
Validation f1 = 0.828729
Validation binary_cross_entropy = 3.478840
Epoch 48
Loss = 2.3804e-02, PNorm = 67.9173, GNorm = 0.3306, lr_0 = 1.0000e-04
Loss = 3.5780e-02, PNorm = 67.9182, GNorm = 0.8942, lr_0 = 1.0000e-04
Validation auc = 0.712524
Validation accuracy = 0.725664
Validation f1 = 0.828729
Validation binary_cross_entropy = 3.520304
Epoch 49
Loss = 3.8154e-02, PNorm = 67.9193, GNorm = 0.2871, lr_0 = 1.0000e-04
Loss = 3.3607e-02, PNorm = 67.9206, GNorm = 0.3283, lr_0 = 1.0000e-04
Validation auc = 0.715569
Validation accuracy = 0.725664
Validation f1 = 0.828729
Validation binary_cross_entropy = 3.523635
Model 0 best validation auc = 0.745763 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.920455
Model 0 test accuracy = 0.856589
Model 0 test f1 = 0.901333
Model 0 test binary_cross_entropy = 0.409452
Ensemble test auc = 0.920455
Ensemble test accuracy = 0.856589
Ensemble test f1 = 0.901333
Ensemble test binary_cross_entropy = 0.409452
Fold 2
Splitting data with seed 2
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35000000000000003, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35000000000000003, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 7.0675e-01, PNorm = 66.3008, GNorm = 4.5751, lr_0 = 3.4750e-04
Loss = 5.4675e-01, PNorm = 66.3531, GNorm = 4.2710, lr_0 = 5.7250e-04
Loss = 4.0913e-01, PNorm = 66.3606, GNorm = 6.0781, lr_0 = 5.9500e-04
Validation auc = 0.656856
Validation accuracy = 0.743363
Validation f1 = 0.841530
Validation binary_cross_entropy = 0.534007
Epoch 1
Loss = 3.8335e-01, PNorm = 66.4561, GNorm = 2.7824, lr_0 = 8.2000e-04
Loss = 2.9205e-01, PNorm = 66.5835, GNorm = 4.5571, lr_0 = 9.9521e-04
Validation auc = 0.670253
Validation accuracy = 0.743363
Validation f1 = 0.835227
Validation binary_cross_entropy = 0.634730
Epoch 2
Loss = 2.0777e-01, PNorm = 66.7118, GNorm = 3.7708, lr_0 = 9.7163e-04
Loss = 2.4162e-01, PNorm = 66.8109, GNorm = 2.6009, lr_0 = 9.4860e-04
Validation auc = 0.612402
Validation accuracy = 0.707965
Validation f1 = 0.809249
Validation binary_cross_entropy = 0.852912
Epoch 3
Loss = 1.8766e-01, PNorm = 66.9013, GNorm = 2.5772, lr_0 = 9.2390e-04
Loss = 1.5512e-01, PNorm = 66.9684, GNorm = 2.3957, lr_0 = 9.0200e-04
Validation auc = 0.598092
Validation accuracy = 0.716814
Validation f1 = 0.819209
Validation binary_cross_entropy = 0.963385
Epoch 4
Loss = 1.5673e-01, PNorm = 67.0255, GNorm = 2.6064, lr_0 = 8.8063e-04
Loss = 1.5784e-01, PNorm = 67.0758, GNorm = 1.7759, lr_0 = 8.5976e-04
Validation auc = 0.631584
Validation accuracy = 0.716814
Validation f1 = 0.823204
Validation binary_cross_entropy = 1.026482
Epoch 5
Loss = 1.7724e-01, PNorm = 67.1243, GNorm = 1.8945, lr_0 = 8.3737e-04
Loss = 1.7969e-01, PNorm = 67.1667, GNorm = 2.1483, lr_0 = 8.1752e-04
Validation auc = 0.626205
Validation accuracy = 0.690265
Validation f1 = 0.798851
Validation binary_cross_entropy = 0.998557
Epoch 6
Loss = 1.1460e-01, PNorm = 67.2084, GNorm = 3.0879, lr_0 = 7.9815e-04
Loss = 1.4058e-01, PNorm = 67.2461, GNorm = 1.4746, lr_0 = 7.7923e-04
Validation auc = 0.663605
Validation accuracy = 0.734513
Validation f1 = 0.826590
Validation binary_cross_entropy = 0.949308
Epoch 7
Loss = 1.1177e-01, PNorm = 67.2823, GNorm = 1.8238, lr_0 = 7.6076e-04
Loss = 1.1249e-01, PNorm = 67.3152, GNorm = 1.7576, lr_0 = 7.4273e-04
Validation auc = 0.676647
Validation accuracy = 0.752212
Validation f1 = 0.838150
Validation binary_cross_entropy = 0.944314
Epoch 8
Loss = 7.5580e-02, PNorm = 67.3442, GNorm = 2.0256, lr_0 = 7.2339e-04
Loss = 8.8512e-02, PNorm = 67.3659, GNorm = 0.4840, lr_0 = 7.0625e-04
Validation auc = 0.647417
Validation accuracy = 0.703540
Validation f1 = 0.798799
Validation binary_cross_entropy = 1.078144
Epoch 9
Loss = 8.4208e-02, PNorm = 67.3850, GNorm = 1.1616, lr_0 = 6.8951e-04
Loss = 9.4358e-02, PNorm = 67.4055, GNorm = 2.2267, lr_0 = 6.7317e-04
Validation auc = 0.637166
Validation accuracy = 0.721239
Validation f1 = 0.815249
Validation binary_cross_entropy = 1.160069
Epoch 10
Loss = 7.7599e-02, PNorm = 67.4256, GNorm = 0.9603, lr_0 = 6.5564e-04
Loss = 8.7990e-02, PNorm = 67.4442, GNorm = 0.7841, lr_0 = 6.4010e-04
Validation auc = 0.633005
Validation accuracy = 0.703540
Validation f1 = 0.805797
Validation binary_cross_entropy = 1.139585
Epoch 11
Loss = 1.0094e-01, PNorm = 67.4655, GNorm = 2.0443, lr_0 = 6.2493e-04
Loss = 9.1028e-02, PNorm = 67.4884, GNorm = 1.8008, lr_0 = 6.1012e-04
Validation auc = 0.626205
Validation accuracy = 0.703540
Validation f1 = 0.809117
Validation binary_cross_entropy = 1.256680
Epoch 12
Loss = 6.3681e-02, PNorm = 67.5104, GNorm = 2.1228, lr_0 = 5.9424e-04
Loss = 6.3802e-02, PNorm = 67.5246, GNorm = 1.6650, lr_0 = 5.8015e-04
Validation auc = 0.642545
Validation accuracy = 0.730088
Validation f1 = 0.827195
Validation binary_cross_entropy = 1.251249
Epoch 13
Loss = 5.6597e-02, PNorm = 67.5387, GNorm = 1.1603, lr_0 = 5.6640e-04
Loss = 7.7809e-02, PNorm = 67.5521, GNorm = 2.6746, lr_0 = 5.5298e-04
Validation auc = 0.659698
Validation accuracy = 0.738938
Validation f1 = 0.833803
Validation binary_cross_entropy = 1.234764
Epoch 14
Loss = 4.3225e-02, PNorm = 67.5677, GNorm = 0.6151, lr_0 = 5.3987e-04
Loss = 8.4329e-02, PNorm = 67.5855, GNorm = 0.9614, lr_0 = 5.2708e-04
Validation auc = 0.652035
Validation accuracy = 0.730088
Validation f1 = 0.828169
Validation binary_cross_entropy = 1.346270
Epoch 15
Loss = 7.2637e-02, PNorm = 67.6032, GNorm = 1.4563, lr_0 = 5.1335e-04
Loss = 6.1022e-02, PNorm = 67.6176, GNorm = 0.5972, lr_0 = 5.0119e-04
Validation auc = 0.646098
Validation accuracy = 0.730088
Validation f1 = 0.827195
Validation binary_cross_entropy = 1.419107
Epoch 16
Loss = 1.4828e-02, PNorm = 67.6313, GNorm = 0.5121, lr_0 = 4.8931e-04
Loss = 4.8159e-02, PNorm = 67.6441, GNorm = 0.3696, lr_0 = 4.7771e-04
Validation auc = 0.646250
Validation accuracy = 0.716814
Validation f1 = 0.819209
Validation binary_cross_entropy = 1.393507
Epoch 17
Loss = 8.9075e-02, PNorm = 67.6529, GNorm = 1.1796, lr_0 = 4.6527e-04
Loss = 5.8234e-02, PNorm = 67.6634, GNorm = 1.4920, lr_0 = 4.5425e-04
Loss = 8.3519e-02, PNorm = 67.6745, GNorm = 2.6555, lr_0 = 4.4348e-04
Validation auc = 0.637522
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 1.509574
Epoch 18
Loss = 6.7725e-02, PNorm = 67.6852, GNorm = 0.9988, lr_0 = 4.3297e-04
Loss = 7.2241e-02, PNorm = 67.6964, GNorm = 2.6180, lr_0 = 4.2271e-04
Validation auc = 0.625749
Validation accuracy = 0.712389
Validation f1 = 0.816901
Validation binary_cross_entropy = 1.524145
Epoch 19
Loss = 4.7926e-02, PNorm = 67.7069, GNorm = 0.6762, lr_0 = 4.1269e-04
Loss = 5.8196e-02, PNorm = 67.7174, GNorm = 1.7938, lr_0 = 4.0291e-04
Validation auc = 0.648635
Validation accuracy = 0.712389
Validation f1 = 0.813754
Validation binary_cross_entropy = 1.504195
Epoch 20
Loss = 6.0116e-02, PNorm = 67.7278, GNorm = 1.0813, lr_0 = 3.9242e-04
Loss = 4.9497e-02, PNorm = 67.7352, GNorm = 1.2537, lr_0 = 3.8312e-04
Validation auc = 0.645945
Validation accuracy = 0.703540
Validation f1 = 0.810198
Validation binary_cross_entropy = 1.584704
Epoch 21
Loss = 8.6480e-02, PNorm = 67.7410, GNorm = 1.4548, lr_0 = 3.7404e-04
Loss = 2.3636e-02, PNorm = 67.7489, GNorm = 0.4660, lr_0 = 3.6517e-04
Validation auc = 0.617984
Validation accuracy = 0.716814
Validation f1 = 0.819209
Validation binary_cross_entropy = 1.664302
Epoch 22
Loss = 5.5131e-02, PNorm = 67.7562, GNorm = 0.2917, lr_0 = 3.5567e-04
Loss = 6.4252e-02, PNorm = 67.7624, GNorm = 0.2696, lr_0 = 3.4724e-04
Validation auc = 0.647366
Validation accuracy = 0.721239
Validation f1 = 0.823529
Validation binary_cross_entropy = 1.573535
Epoch 23
Loss = 3.9061e-02, PNorm = 67.7682, GNorm = 0.8656, lr_0 = 3.3901e-04
Loss = 4.9016e-02, PNorm = 67.7734, GNorm = 0.5970, lr_0 = 3.3097e-04
Validation auc = 0.667715
Validation accuracy = 0.707965
Validation f1 = 0.811429
Validation binary_cross_entropy = 1.476887
Epoch 24
Loss = 6.2181e-02, PNorm = 67.7795, GNorm = 0.8998, lr_0 = 3.2235e-04
Loss = 5.8205e-02, PNorm = 67.7843, GNorm = 0.6461, lr_0 = 3.1471e-04
Validation auc = 0.654927
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 1.489440
Epoch 25
Loss = 2.6650e-02, PNorm = 67.7884, GNorm = 0.1501, lr_0 = 3.0726e-04
Loss = 5.3393e-02, PNorm = 67.7927, GNorm = 0.7932, lr_0 = 2.9997e-04
Validation auc = 0.653456
Validation accuracy = 0.725664
Validation f1 = 0.827778
Validation binary_cross_entropy = 1.559597
Epoch 26
Loss = 3.3028e-02, PNorm = 67.7974, GNorm = 1.0857, lr_0 = 2.9286e-04
Loss = 3.5924e-02, PNorm = 67.8016, GNorm = 0.5765, lr_0 = 2.8592e-04
Validation auc = 0.651324
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 1.637361
Epoch 27
Loss = 6.1042e-02, PNorm = 67.8056, GNorm = 0.1398, lr_0 = 2.7848e-04
Loss = 5.0881e-02, PNorm = 67.8077, GNorm = 0.3361, lr_0 = 2.7188e-04
Validation auc = 0.639704
Validation accuracy = 0.712389
Validation f1 = 0.815864
Validation binary_cross_entropy = 1.668157
Epoch 28
Loss = 3.1666e-02, PNorm = 67.8110, GNorm = 0.1229, lr_0 = 2.6544e-04
Loss = 5.3010e-02, PNorm = 67.8152, GNorm = 0.3628, lr_0 = 2.5914e-04
Validation auc = 0.654166
Validation accuracy = 0.716814
Validation f1 = 0.821229
Validation binary_cross_entropy = 1.619939
Epoch 29
Loss = 3.0820e-02, PNorm = 67.8189, GNorm = 0.3910, lr_0 = 2.5240e-04
Loss = 5.1775e-02, PNorm = 67.8221, GNorm = 2.0720, lr_0 = 2.4641e-04
Validation auc = 0.669847
Validation accuracy = 0.721239
Validation f1 = 0.824513
Validation binary_cross_entropy = 1.557405
Epoch 30
Loss = 5.4581e-02, PNorm = 67.8254, GNorm = 1.3908, lr_0 = 2.4057e-04
Loss = 6.3457e-02, PNorm = 67.8280, GNorm = 1.1896, lr_0 = 2.3487e-04
Validation auc = 0.654217
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.609444
Epoch 31
Loss = 3.8891e-02, PNorm = 67.8302, GNorm = 0.7434, lr_0 = 2.2876e-04
Loss = 5.9811e-02, PNorm = 67.8336, GNorm = 0.5273, lr_0 = 2.2334e-04
Validation auc = 0.638536
Validation accuracy = 0.725664
Validation f1 = 0.828729
Validation binary_cross_entropy = 1.710386
Epoch 32
Loss = 7.7057e-02, PNorm = 67.8369, GNorm = 1.7338, lr_0 = 2.1804e-04
Loss = 4.9998e-02, PNorm = 67.8398, GNorm = 1.5256, lr_0 = 2.1288e-04
Validation auc = 0.633360
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.742774
Epoch 33
Loss = 5.8854e-02, PNorm = 67.8422, GNorm = 1.3438, lr_0 = 2.0783e-04
Loss = 3.8513e-02, PNorm = 67.8449, GNorm = 0.7475, lr_0 = 2.0290e-04
Validation auc = 0.645387
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.696191
Epoch 34
Loss = 5.6951e-02, PNorm = 67.8471, GNorm = 1.2212, lr_0 = 1.9762e-04
Loss = 2.0983e-02, PNorm = 67.8492, GNorm = 0.5974, lr_0 = 1.9294e-04
Loss = 3.7467e-02, PNorm = 67.8511, GNorm = 1.3355, lr_0 = 1.8836e-04
Validation auc = 0.650563
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 1.702344
Epoch 35
Loss = 3.9153e-02, PNorm = 67.8530, GNorm = 0.6502, lr_0 = 1.8390e-04
Loss = 4.7740e-02, PNorm = 67.8540, GNorm = 0.5655, lr_0 = 1.7954e-04
Loss = 1.4428e-02, PNorm = 67.8541, GNorm = 0.3246, lr_0 = 1.7911e-04
Validation auc = 0.651477
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 1.727842
Epoch 36
Loss = 4.4384e-02, PNorm = 67.8551, GNorm = 0.2959, lr_0 = 1.7487e-04
Loss = 5.0111e-02, PNorm = 67.8561, GNorm = 0.4725, lr_0 = 1.7072e-04
Validation auc = 0.651375
Validation accuracy = 0.721239
Validation f1 = 0.824513
Validation binary_cross_entropy = 1.684054
Epoch 37
Loss = 2.5818e-02, PNorm = 67.8577, GNorm = 0.7762, lr_0 = 1.6668e-04
Loss = 5.0682e-02, PNorm = 67.8591, GNorm = 0.6294, lr_0 = 1.6273e-04
Validation auc = 0.649193
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 1.662829
Epoch 38
Loss = 3.3443e-02, PNorm = 67.8604, GNorm = 0.6423, lr_0 = 1.5887e-04
Loss = 3.8128e-02, PNorm = 67.8620, GNorm = 0.1910, lr_0 = 1.5510e-04
Validation auc = 0.648026
Validation accuracy = 0.712389
Validation f1 = 0.818942
Validation binary_cross_entropy = 1.701451
Epoch 39
Loss = 2.8812e-02, PNorm = 67.8637, GNorm = 0.6880, lr_0 = 1.5107e-04
Loss = 3.0870e-02, PNorm = 67.8652, GNorm = 0.2220, lr_0 = 1.4749e-04
Validation auc = 0.646554
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.748726
Epoch 40
Loss = 2.7957e-02, PNorm = 67.8662, GNorm = 0.9911, lr_0 = 1.4399e-04
Loss = 4.5850e-02, PNorm = 67.8671, GNorm = 0.5655, lr_0 = 1.4058e-04
Validation auc = 0.643814
Validation accuracy = 0.712389
Validation f1 = 0.816901
Validation binary_cross_entropy = 1.749603
Epoch 41
Loss = 4.1423e-02, PNorm = 67.8684, GNorm = 0.6545, lr_0 = 1.3692e-04
Loss = 3.7633e-02, PNorm = 67.8698, GNorm = 0.8153, lr_0 = 1.3367e-04
Validation auc = 0.641328
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 1.785591
Epoch 42
Loss = 2.9479e-02, PNorm = 67.8715, GNorm = 1.0968, lr_0 = 1.3050e-04
Loss = 3.7045e-02, PNorm = 67.8732, GNorm = 0.4759, lr_0 = 1.2741e-04
Validation auc = 0.645083
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.816725
Epoch 43
Loss = 2.3734e-02, PNorm = 67.8748, GNorm = 0.0452, lr_0 = 1.2409e-04
Loss = 4.1425e-02, PNorm = 67.8757, GNorm = 0.8973, lr_0 = 1.2115e-04
Validation auc = 0.655181
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.788068
Epoch 44
Loss = 2.2040e-02, PNorm = 67.8765, GNorm = 0.7034, lr_0 = 1.1828e-04
Loss = 3.3868e-02, PNorm = 67.8773, GNorm = 1.4184, lr_0 = 1.1548e-04
Validation auc = 0.656805
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.785281
Epoch 45
Loss = 4.4676e-02, PNorm = 67.8782, GNorm = 1.3792, lr_0 = 1.1274e-04
Loss = 4.1041e-02, PNorm = 67.8791, GNorm = 0.1413, lr_0 = 1.1007e-04
Validation auc = 0.649751
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.835041
Epoch 46
Loss = 5.0082e-02, PNorm = 67.8799, GNorm = 0.6639, lr_0 = 1.0720e-04
Loss = 3.5567e-02, PNorm = 67.8806, GNorm = 0.9734, lr_0 = 1.0466e-04
Validation auc = 0.650056
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.876971
Epoch 47
Loss = 9.2843e-03, PNorm = 67.8818, GNorm = 0.2475, lr_0 = 1.0218e-04
Loss = 2.8175e-02, PNorm = 67.8827, GNorm = 0.1361, lr_0 = 1.0000e-04
Validation auc = 0.641987
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 2.276958
Epoch 48
Loss = 5.5559e-02, PNorm = 67.8832, GNorm = 0.2850, lr_0 = 1.0000e-04
Loss = 3.3991e-02, PNorm = 67.8836, GNorm = 0.0611, lr_0 = 1.0000e-04
Validation auc = 0.634071
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.919865
Epoch 49
Loss = 1.8219e-02, PNorm = 67.8843, GNorm = 1.4196, lr_0 = 1.0000e-04
Loss = 5.0790e-02, PNorm = 67.8850, GNorm = 0.8823, lr_0 = 1.0000e-04
Validation auc = 0.637572
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 2.682499
Model 0 best validation auc = 0.676647 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.913364
Model 0 test accuracy = 0.856589
Model 0 test f1 = 0.885449
Model 0 test binary_cross_entropy = 0.476073
Ensemble test auc = 0.913364
Ensemble test accuracy = 0.856589
Ensemble test f1 = 0.885449
Ensemble test binary_cross_entropy = 0.476073
Fold 3
Splitting data with seed 3
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35000000000000003, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35000000000000003, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 7.1841e-01, PNorm = 66.3021, GNorm = 5.2820, lr_0 = 3.4750e-04
Loss = 6.1347e-01, PNorm = 66.3539, GNorm = 6.9525, lr_0 = 5.7250e-04
Loss = 5.3909e-01, PNorm = 66.3613, GNorm = 6.3305, lr_0 = 5.9500e-04
Validation auc = 0.695423
Validation accuracy = 0.703540
Validation f1 = 0.802360
Validation binary_cross_entropy = 0.558012
Epoch 1
Loss = 3.8432e-01, PNorm = 66.4527, GNorm = 2.9701, lr_0 = 8.2000e-04
Loss = 3.7577e-01, PNorm = 66.5752, GNorm = 3.0565, lr_0 = 9.9521e-04
Validation auc = 0.709936
Validation accuracy = 0.725664
Validation f1 = 0.823864
Validation binary_cross_entropy = 0.666929
Epoch 2
Loss = 2.3913e-01, PNorm = 66.7014, GNorm = 2.9176, lr_0 = 9.7163e-04
Loss = 2.6588e-01, PNorm = 66.7997, GNorm = 3.6765, lr_0 = 9.4860e-04
Validation auc = 0.700294
Validation accuracy = 0.716814
Validation f1 = 0.812865
Validation binary_cross_entropy = 0.804479
Epoch 3
Loss = 2.0060e-01, PNorm = 66.8980, GNorm = 1.6020, lr_0 = 9.2390e-04
Loss = 2.6774e-01, PNorm = 66.9661, GNorm = 2.7448, lr_0 = 9.0200e-04
Validation auc = 0.668832
Validation accuracy = 0.707965
Validation f1 = 0.804734
Validation binary_cross_entropy = 0.921067
Epoch 4
Loss = 1.5650e-01, PNorm = 67.0313, GNorm = 2.3100, lr_0 = 8.8063e-04
Loss = 1.6381e-01, PNorm = 67.0881, GNorm = 1.4647, lr_0 = 8.5976e-04
Validation auc = 0.665483
Validation accuracy = 0.703540
Validation f1 = 0.810198
Validation binary_cross_entropy = 1.013427
Epoch 5
Loss = 1.0955e-01, PNorm = 67.1436, GNorm = 2.2362, lr_0 = 8.3737e-04
Loss = 1.3466e-01, PNorm = 67.1815, GNorm = 1.1818, lr_0 = 8.1752e-04
Validation auc = 0.671065
Validation accuracy = 0.712389
Validation f1 = 0.814815
Validation binary_cross_entropy = 1.053046
Epoch 6
Loss = 8.9214e-02, PNorm = 67.2174, GNorm = 0.7402, lr_0 = 7.9815e-04
Loss = 1.3881e-01, PNorm = 67.2461, GNorm = 2.1964, lr_0 = 7.7923e-04
Validation auc = 0.671775
Validation accuracy = 0.707965
Validation f1 = 0.809249
Validation binary_cross_entropy = 1.078035
Epoch 7
Loss = 9.8795e-02, PNorm = 67.2788, GNorm = 1.1464, lr_0 = 7.6076e-04
Loss = 1.0253e-01, PNorm = 67.3098, GNorm = 2.1495, lr_0 = 7.4273e-04
Validation auc = 0.718157
Validation accuracy = 0.738938
Validation f1 = 0.828986
Validation binary_cross_entropy = 1.023394
Epoch 8
Loss = 1.2510e-01, PNorm = 67.3395, GNorm = 1.3216, lr_0 = 7.2339e-04
Loss = 1.2449e-01, PNorm = 67.3694, GNorm = 2.5248, lr_0 = 7.0625e-04
Validation auc = 0.698620
Validation accuracy = 0.721239
Validation f1 = 0.826446
Validation binary_cross_entropy = 1.053560
Epoch 9
Loss = 8.1099e-02, PNorm = 67.3971, GNorm = 1.8612, lr_0 = 6.8951e-04
Loss = 7.0411e-02, PNorm = 67.4226, GNorm = 0.9619, lr_0 = 6.7317e-04
Validation auc = 0.714655
Validation accuracy = 0.747788
Validation f1 = 0.839437
Validation binary_cross_entropy = 0.984935
Epoch 10
Loss = 8.1892e-02, PNorm = 67.4461, GNorm = 0.9600, lr_0 = 6.5564e-04
Loss = 9.9751e-02, PNorm = 67.4674, GNorm = 2.2299, lr_0 = 6.4010e-04
Validation auc = 0.698569
Validation accuracy = 0.743363
Validation f1 = 0.838889
Validation binary_cross_entropy = 1.066059
Epoch 11
Loss = 8.8079e-02, PNorm = 67.4841, GNorm = 1.4140, lr_0 = 6.2493e-04
Loss = 8.1724e-02, PNorm = 67.5017, GNorm = 0.9420, lr_0 = 6.1012e-04
Validation auc = 0.702679
Validation accuracy = 0.738938
Validation f1 = 0.831909
Validation binary_cross_entropy = 0.985484
Epoch 12
Loss = 9.7424e-02, PNorm = 67.5176, GNorm = 1.2680, lr_0 = 5.9424e-04
Loss = 8.8349e-02, PNorm = 67.5344, GNorm = 1.0909, lr_0 = 5.8015e-04
Validation auc = 0.671674
Validation accuracy = 0.712389
Validation f1 = 0.818942
Validation binary_cross_entropy = 1.061468
Epoch 13
Loss = 6.1172e-02, PNorm = 67.5516, GNorm = 1.4314, lr_0 = 5.6640e-04
Loss = 7.0400e-02, PNorm = 67.5687, GNorm = 0.7730, lr_0 = 5.5298e-04
Validation auc = 0.730996
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 1.218900
Epoch 14
Loss = 9.8020e-02, PNorm = 67.5866, GNorm = 1.4600, lr_0 = 5.3987e-04
Loss = 7.7009e-02, PNorm = 67.6013, GNorm = 0.5944, lr_0 = 5.2708e-04
Validation auc = 0.731757
Validation accuracy = 0.721239
Validation f1 = 0.822535
Validation binary_cross_entropy = 1.183802
Epoch 15
Loss = 9.9470e-02, PNorm = 67.6171, GNorm = 2.8912, lr_0 = 5.1335e-04
Loss = 7.1948e-02, PNorm = 67.6296, GNorm = 2.0226, lr_0 = 5.0119e-04
Validation auc = 0.702324
Validation accuracy = 0.721239
Validation f1 = 0.822535
Validation binary_cross_entropy = 1.268924
Epoch 16
Loss = 2.6953e-02, PNorm = 67.6413, GNorm = 0.7137, lr_0 = 4.8931e-04
Loss = 7.6692e-02, PNorm = 67.6547, GNorm = 1.3259, lr_0 = 4.7771e-04
Validation auc = 0.672790
Validation accuracy = 0.721239
Validation f1 = 0.824513
Validation binary_cross_entropy = 1.419395
Epoch 17
Loss = 1.0343e-01, PNorm = 67.6670, GNorm = 1.6986, lr_0 = 4.6527e-04
Loss = 7.9319e-02, PNorm = 67.6783, GNorm = 0.5789, lr_0 = 4.5425e-04
Loss = 6.3667e-02, PNorm = 67.6879, GNorm = 1.3419, lr_0 = 4.4348e-04
Validation auc = 0.679336
Validation accuracy = 0.712389
Validation f1 = 0.816901
Validation binary_cross_entropy = 1.271519
Epoch 18
Loss = 6.8410e-02, PNorm = 67.6967, GNorm = 0.6212, lr_0 = 4.3297e-04
Loss = 7.7581e-02, PNorm = 67.7052, GNorm = 1.3225, lr_0 = 4.2271e-04
Validation auc = 0.680503
Validation accuracy = 0.712389
Validation f1 = 0.816901
Validation binary_cross_entropy = 1.334636
Epoch 19
Loss = 6.5996e-02, PNorm = 67.7154, GNorm = 1.3104, lr_0 = 4.1269e-04
Loss = 8.7024e-02, PNorm = 67.7238, GNorm = 1.5643, lr_0 = 4.0291e-04
Validation auc = 0.671014
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.386824
Epoch 20
Loss = 4.0109e-02, PNorm = 67.7306, GNorm = 0.6651, lr_0 = 3.9242e-04
Loss = 1.0349e-01, PNorm = 67.7382, GNorm = 1.3516, lr_0 = 3.8312e-04
Validation auc = 0.631483
Validation accuracy = 0.716814
Validation f1 = 0.822222
Validation binary_cross_entropy = 1.475906
Epoch 21
Loss = 6.2155e-02, PNorm = 67.7453, GNorm = 0.5084, lr_0 = 3.7404e-04
Loss = 6.1030e-02, PNorm = 67.7504, GNorm = 1.2888, lr_0 = 3.6517e-04
Validation auc = 0.619202
Validation accuracy = 0.703540
Validation f1 = 0.812325
Validation binary_cross_entropy = 1.444157
Epoch 22
Loss = 6.6813e-02, PNorm = 67.7569, GNorm = 0.2398, lr_0 = 3.5567e-04
Loss = 5.7048e-02, PNorm = 67.7644, GNorm = 0.8513, lr_0 = 3.4724e-04
Validation auc = 0.622856
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 1.425556
Epoch 23
Loss = 4.5286e-02, PNorm = 67.7724, GNorm = 0.8163, lr_0 = 3.3901e-04
Loss = 4.9287e-02, PNorm = 67.7783, GNorm = 1.1544, lr_0 = 3.3097e-04
Validation auc = 0.628184
Validation accuracy = 0.707965
Validation f1 = 0.815642
Validation binary_cross_entropy = 1.374663
Epoch 24
Loss = 7.6522e-02, PNorm = 67.7842, GNorm = 0.4110, lr_0 = 3.2235e-04
Loss = 4.5158e-02, PNorm = 67.7898, GNorm = 0.9184, lr_0 = 3.1471e-04
Validation auc = 0.652136
Validation accuracy = 0.712389
Validation f1 = 0.818942
Validation binary_cross_entropy = 1.298159
Epoch 25
Loss = 6.0929e-02, PNorm = 67.7946, GNorm = 0.6351, lr_0 = 3.0726e-04
Loss = 3.4628e-02, PNorm = 67.7991, GNorm = 0.7235, lr_0 = 2.9997e-04
Validation auc = 0.663808
Validation accuracy = 0.712389
Validation f1 = 0.817927
Validation binary_cross_entropy = 1.306868
Epoch 26
Loss = 5.1831e-02, PNorm = 67.8041, GNorm = 1.0285, lr_0 = 2.9286e-04
Loss = 5.9186e-02, PNorm = 67.8077, GNorm = 0.2277, lr_0 = 2.8592e-04
Validation auc = 0.660154
Validation accuracy = 0.699115
Validation f1 = 0.806818
Validation binary_cross_entropy = 1.319578
Epoch 27
Loss = 3.5145e-02, PNorm = 67.8116, GNorm = 0.5720, lr_0 = 2.7848e-04
Loss = 2.9472e-02, PNorm = 67.8164, GNorm = 0.3805, lr_0 = 2.7188e-04
Validation auc = 0.662692
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 1.390482
Epoch 28
Loss = 5.8719e-02, PNorm = 67.8199, GNorm = 0.4745, lr_0 = 2.6544e-04
Loss = 3.6415e-02, PNorm = 67.8242, GNorm = 0.1827, lr_0 = 2.5914e-04
Validation auc = 0.672130
Validation accuracy = 0.716814
Validation f1 = 0.821229
Validation binary_cross_entropy = 1.420742
Epoch 29
Loss = 3.4416e-02, PNorm = 67.8286, GNorm = 0.2403, lr_0 = 2.5240e-04
Loss = 3.7627e-02, PNorm = 67.8334, GNorm = 0.8698, lr_0 = 2.4641e-04
Validation auc = 0.677002
Validation accuracy = 0.721239
Validation f1 = 0.825485
Validation binary_cross_entropy = 1.426922
Epoch 30
Loss = 5.1671e-02, PNorm = 67.8371, GNorm = 0.4426, lr_0 = 2.4057e-04
Loss = 5.9255e-02, PNorm = 67.8397, GNorm = 2.0550, lr_0 = 2.3487e-04
Validation auc = 0.682736
Validation accuracy = 0.721239
Validation f1 = 0.822535
Validation binary_cross_entropy = 1.399005
Epoch 31
Loss = 3.8237e-02, PNorm = 67.8417, GNorm = 0.4174, lr_0 = 2.2876e-04
Loss = 4.4498e-02, PNorm = 67.8441, GNorm = 0.9071, lr_0 = 2.2334e-04
Validation auc = 0.682178
Validation accuracy = 0.716814
Validation f1 = 0.821229
Validation binary_cross_entropy = 1.400680
Epoch 32
Loss = 3.4229e-02, PNorm = 67.8464, GNorm = 0.7920, lr_0 = 2.1804e-04
Loss = 4.3466e-02, PNorm = 67.8484, GNorm = 1.6415, lr_0 = 2.1288e-04
Validation auc = 0.689333
Validation accuracy = 0.721239
Validation f1 = 0.823529
Validation binary_cross_entropy = 1.362727
Epoch 33
Loss = 1.5177e-02, PNorm = 67.8517, GNorm = 0.3562, lr_0 = 2.0783e-04
Loss = 7.5814e-02, PNorm = 67.8540, GNorm = 0.4216, lr_0 = 2.0290e-04
Validation auc = 0.684106
Validation accuracy = 0.716814
Validation f1 = 0.821229
Validation binary_cross_entropy = 1.389571
Epoch 34
Loss = 2.0229e-01, PNorm = 67.8557, GNorm = 2.4457, lr_0 = 1.9762e-04
Loss = 5.8493e-02, PNorm = 67.8577, GNorm = 1.0073, lr_0 = 1.9294e-04
Loss = 3.2989e-02, PNorm = 67.8600, GNorm = 0.5589, lr_0 = 1.8836e-04
Validation auc = 0.691769
Validation accuracy = 0.721239
Validation f1 = 0.822535
Validation binary_cross_entropy = 1.319172
Epoch 35
Loss = 4.3921e-02, PNorm = 67.8633, GNorm = 1.9179, lr_0 = 1.8390e-04
Loss = 5.1145e-02, PNorm = 67.8655, GNorm = 1.7465, lr_0 = 1.7954e-04
Loss = 1.5688e-02, PNorm = 67.8656, GNorm = 0.5572, lr_0 = 1.7911e-04
Validation auc = 0.694408
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 1.347369
Epoch 36
Loss = 3.9484e-02, PNorm = 67.8672, GNorm = 0.6242, lr_0 = 1.7487e-04
Loss = 3.3815e-02, PNorm = 67.8690, GNorm = 0.4889, lr_0 = 1.7072e-04
Validation auc = 0.696336
Validation accuracy = 0.721239
Validation f1 = 0.822535
Validation binary_cross_entropy = 1.348422
Epoch 37
Loss = 3.5473e-02, PNorm = 67.8711, GNorm = 1.9215, lr_0 = 1.6668e-04
Loss = 3.0828e-02, PNorm = 67.8736, GNorm = 0.2141, lr_0 = 1.6273e-04
Validation auc = 0.697402
Validation accuracy = 0.721239
Validation f1 = 0.822535
Validation binary_cross_entropy = 1.389395
Epoch 38
Loss = 2.1913e-02, PNorm = 67.8763, GNorm = 0.3563, lr_0 = 1.5887e-04
Loss = 5.4550e-02, PNorm = 67.8784, GNorm = 2.1322, lr_0 = 1.5510e-04
Validation auc = 0.690094
Validation accuracy = 0.716814
Validation f1 = 0.821229
Validation binary_cross_entropy = 1.438338
Epoch 39
Loss = 3.3578e-02, PNorm = 67.8794, GNorm = 1.3183, lr_0 = 1.5107e-04
Loss = 3.6794e-02, PNorm = 67.8806, GNorm = 1.9638, lr_0 = 1.4749e-04
Validation auc = 0.696184
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 1.423891
Epoch 40
Loss = 2.7651e-02, PNorm = 67.8819, GNorm = 0.9060, lr_0 = 1.4399e-04
Loss = 3.4371e-02, PNorm = 67.8835, GNorm = 0.4791, lr_0 = 1.4058e-04
Validation auc = 0.692835
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 1.438877
Epoch 41
Loss = 3.9713e-02, PNorm = 67.8848, GNorm = 0.8932, lr_0 = 1.3692e-04
Loss = 4.4241e-02, PNorm = 67.8857, GNorm = 0.5352, lr_0 = 1.3367e-04
Validation auc = 0.690551
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 1.431259
Epoch 42
Loss = 5.1558e-02, PNorm = 67.8867, GNorm = 0.0833, lr_0 = 1.3050e-04
Loss = 3.2880e-02, PNorm = 67.8879, GNorm = 0.1805, lr_0 = 1.2741e-04
Validation auc = 0.685832
Validation accuracy = 0.716814
Validation f1 = 0.820225
Validation binary_cross_entropy = 1.438374
Epoch 43
Loss = 2.1767e-02, PNorm = 67.8892, GNorm = 1.0893, lr_0 = 1.2409e-04
Loss = 4.0522e-02, PNorm = 67.8906, GNorm = 1.0972, lr_0 = 1.2115e-04
Validation auc = 0.670862
Validation accuracy = 0.716814
Validation f1 = 0.821229
Validation binary_cross_entropy = 1.494069
Epoch 44
Loss = 6.2133e-02, PNorm = 67.8913, GNorm = 0.4753, lr_0 = 1.1828e-04
Loss = 3.8013e-02, PNorm = 67.8925, GNorm = 1.2961, lr_0 = 1.1548e-04
Validation auc = 0.667005
Validation accuracy = 0.712389
Validation f1 = 0.816901
Validation binary_cross_entropy = 1.483842
Epoch 45
Loss = 5.9531e-02, PNorm = 67.8935, GNorm = 1.0079, lr_0 = 1.1274e-04
Loss = 4.8460e-02, PNorm = 67.8949, GNorm = 0.9108, lr_0 = 1.1007e-04
Validation auc = 0.650614
Validation accuracy = 0.703540
Validation f1 = 0.811268
Validation binary_cross_entropy = 1.521042
Epoch 46
Loss = 3.8753e-02, PNorm = 67.8962, GNorm = 0.1690, lr_0 = 1.0720e-04
Loss = 4.2977e-02, PNorm = 67.8969, GNorm = 0.1652, lr_0 = 1.0466e-04
Validation auc = 0.650157
Validation accuracy = 0.703540
Validation f1 = 0.811268
Validation binary_cross_entropy = 1.524399
Epoch 47
Loss = 3.9041e-02, PNorm = 67.8974, GNorm = 0.0940, lr_0 = 1.0218e-04
Loss = 4.6301e-02, PNorm = 67.8980, GNorm = 1.7218, lr_0 = 1.0000e-04
Validation auc = 0.660104
Validation accuracy = 0.703540
Validation f1 = 0.810198
Validation binary_cross_entropy = 1.486538
Epoch 48
Loss = 9.8219e-03, PNorm = 67.8990, GNorm = 0.2850, lr_0 = 1.0000e-04
Loss = 2.9704e-02, PNorm = 67.9001, GNorm = 0.3878, lr_0 = 1.0000e-04
Validation auc = 0.664366
Validation accuracy = 0.707965
Validation f1 = 0.813559
Validation binary_cross_entropy = 1.483638
Epoch 49
Loss = 5.7341e-02, PNorm = 67.9013, GNorm = 0.6910, lr_0 = 1.0000e-04
Loss = 4.7862e-02, PNorm = 67.9018, GNorm = 2.2406, lr_0 = 1.0000e-04
Validation auc = 0.665026
Validation accuracy = 0.703540
Validation f1 = 0.809117
Validation binary_cross_entropy = 1.459833
Model 0 best validation auc = 0.731757 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.932732
Model 0 test accuracy = 0.887597
Model 0 test f1 = 0.912913
Model 0 test binary_cross_entropy = 0.485929
Ensemble test auc = 0.932732
Ensemble test accuracy = 0.887597
Ensemble test f1 = 0.912913
Ensemble test binary_cross_entropy = 0.485929
Fold 4
Splitting data with seed 4
Class sizes
active 0: 34.34%, 1: 65.66%
Total size = 1,287 | train size = 1,029 | val size = 226 | test size = 258
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=2948, out_features=900, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35000000000000003, inplace=False)
    (4): Linear(in_features=900, out_features=900, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35000000000000003, inplace=False)
    (7): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 5,339,701
Moving model to cuda
Epoch 0
Loss = 8.0038e-01, PNorm = 66.2997, GNorm = 4.3497, lr_0 = 3.4750e-04
Loss = 5.6642e-01, PNorm = 66.3524, GNorm = 5.8556, lr_0 = 5.7250e-04
Loss = 5.0470e-01, PNorm = 66.3596, GNorm = 5.5120, lr_0 = 5.9500e-04
Validation auc = 0.676241
Validation accuracy = 0.654867
Validation f1 = 0.738255
Validation binary_cross_entropy = 0.643855
Epoch 1
Loss = 3.1277e-01, PNorm = 66.4562, GNorm = 4.4583, lr_0 = 8.2000e-04
Loss = 4.0319e-01, PNorm = 66.5791, GNorm = 3.4580, lr_0 = 9.9521e-04
Validation auc = 0.710038
Validation accuracy = 0.681416
Validation f1 = 0.769231
Validation binary_cross_entropy = 0.599506
Epoch 2
Loss = 2.9057e-01, PNorm = 66.7095, GNorm = 3.2531, lr_0 = 9.7163e-04
Loss = 2.2824e-01, PNorm = 66.8198, GNorm = 3.8170, lr_0 = 9.4860e-04
Validation auc = 0.624277
Validation accuracy = 0.730088
Validation f1 = 0.827195
Validation binary_cross_entropy = 0.763905
Epoch 3
Loss = 1.4936e-01, PNorm = 66.9146, GNorm = 2.0436, lr_0 = 9.2390e-04
Loss = 2.0002e-01, PNorm = 66.9801, GNorm = 1.4973, lr_0 = 9.0200e-04
Validation auc = 0.621334
Validation accuracy = 0.738938
Validation f1 = 0.832861
Validation binary_cross_entropy = 0.775411
Epoch 4
Loss = 1.0542e-01, PNorm = 67.0358, GNorm = 1.7663, lr_0 = 8.8063e-04
Loss = 1.6482e-01, PNorm = 67.0784, GNorm = 0.9890, lr_0 = 8.5976e-04
Validation auc = 0.604283
Validation accuracy = 0.623894
Validation f1 = 0.730159
Validation binary_cross_entropy = 0.915224
Epoch 5
Loss = 1.6625e-01, PNorm = 67.1220, GNorm = 2.5332, lr_0 = 8.3737e-04
Loss = 1.2416e-01, PNorm = 67.1593, GNorm = 1.0641, lr_0 = 8.1752e-04
Validation auc = 0.622653
Validation accuracy = 0.672566
Validation f1 = 0.782353
Validation binary_cross_entropy = 0.830158
Epoch 6
Loss = 8.4482e-02, PNorm = 67.1962, GNorm = 0.7948, lr_0 = 7.9815e-04
Loss = 1.4480e-01, PNorm = 67.2278, GNorm = 2.2282, lr_0 = 7.7923e-04
Validation auc = 0.638080
Validation accuracy = 0.654867
Validation f1 = 0.757764
Validation binary_cross_entropy = 0.937097
Epoch 7
Loss = 1.0913e-01, PNorm = 67.2590, GNorm = 0.6339, lr_0 = 7.6076e-04
Loss = 1.1289e-01, PNorm = 67.2863, GNorm = 0.9427, lr_0 = 7.4273e-04
Validation auc = 0.667106
Validation accuracy = 0.721239
Validation f1 = 0.818444
Validation binary_cross_entropy = 0.858579
Epoch 8
Loss = 7.7998e-02, PNorm = 67.3120, GNorm = 1.5364, lr_0 = 7.2339e-04
Loss = 9.6092e-02, PNorm = 67.3372, GNorm = 1.4597, lr_0 = 7.0625e-04
Validation auc = 0.638181
Validation accuracy = 0.668142
Validation f1 = 0.774775
Validation binary_cross_entropy = 0.953111
Epoch 9
Loss = 5.5395e-02, PNorm = 67.3616, GNorm = 1.6574, lr_0 = 6.8951e-04
Loss = 8.3803e-02, PNorm = 67.3877, GNorm = 1.4222, lr_0 = 6.7317e-04
Validation auc = 0.688217
Validation accuracy = 0.725664
Validation f1 = 0.823864
Validation binary_cross_entropy = 1.005180
Epoch 10
Loss = 7.6434e-02, PNorm = 67.4087, GNorm = 1.6157, lr_0 = 6.5564e-04
Loss = 1.0724e-01, PNorm = 67.4275, GNorm = 2.4383, lr_0 = 6.4010e-04
Validation auc = 0.672486
Validation accuracy = 0.761062
Validation f1 = 0.854839
Validation binary_cross_entropy = 1.144973
Epoch 11
Loss = 7.8370e-02, PNorm = 67.4534, GNorm = 0.3333, lr_0 = 6.2493e-04
Loss = 1.0254e-01, PNorm = 67.4735, GNorm = 0.9766, lr_0 = 6.1012e-04
Validation auc = 0.683853
Validation accuracy = 0.712389
Validation f1 = 0.813754
Validation binary_cross_entropy = 0.947874
Epoch 12
Loss = 4.5188e-02, PNorm = 67.4958, GNorm = 0.3686, lr_0 = 5.9424e-04
Loss = 7.7068e-02, PNorm = 67.5156, GNorm = 1.8417, lr_0 = 5.8015e-04
Validation auc = 0.717040
Validation accuracy = 0.734513
Validation f1 = 0.833333
Validation binary_cross_entropy = 0.943081
Epoch 13
Loss = 1.0237e-01, PNorm = 67.5305, GNorm = 1.4237, lr_0 = 5.6640e-04
Loss = 6.9279e-02, PNorm = 67.5488, GNorm = 1.9930, lr_0 = 5.5298e-04
Validation auc = 0.715721
Validation accuracy = 0.752212
Validation f1 = 0.848649
Validation binary_cross_entropy = 0.989264
Epoch 14
Loss = 1.1714e-01, PNorm = 67.5643, GNorm = 2.0907, lr_0 = 5.3987e-04
Loss = 6.7254e-02, PNorm = 67.5775, GNorm = 1.6203, lr_0 = 5.2708e-04
Validation auc = 0.726276
Validation accuracy = 0.756637
Validation f1 = 0.845938
Validation binary_cross_entropy = 0.900742
Epoch 15
Loss = 7.5792e-02, PNorm = 67.5908, GNorm = 0.9529, lr_0 = 5.1335e-04
Loss = 7.4867e-02, PNorm = 67.6034, GNorm = 1.0123, lr_0 = 5.0119e-04
Validation auc = 0.724703
Validation accuracy = 0.743363
Validation f1 = 0.837079
Validation binary_cross_entropy = 0.935914
Epoch 16
Loss = 1.0530e-01, PNorm = 67.6178, GNorm = 1.6598, lr_0 = 4.8931e-04
Loss = 6.0028e-02, PNorm = 67.6303, GNorm = 1.2327, lr_0 = 4.7771e-04
Validation auc = 0.683193
Validation accuracy = 0.734513
Validation f1 = 0.829545
Validation binary_cross_entropy = 1.402285
Epoch 17
Loss = 3.4115e-02, PNorm = 67.6420, GNorm = 0.5201, lr_0 = 4.6527e-04
Loss = 4.4993e-02, PNorm = 67.6531, GNorm = 0.3724, lr_0 = 4.5425e-04
Loss = 5.8225e-02, PNorm = 67.6633, GNorm = 0.7711, lr_0 = 4.4348e-04
Validation auc = 0.704303
Validation accuracy = 0.761062
Validation f1 = 0.852459
Validation binary_cross_entropy = 1.455484
Epoch 18
Loss = 7.0033e-02, PNorm = 67.6706, GNorm = 1.9973, lr_0 = 4.3297e-04
Loss = 4.7238e-02, PNorm = 67.6789, GNorm = 1.7601, lr_0 = 4.2271e-04
Validation auc = 0.706029
Validation accuracy = 0.725664
Validation f1 = 0.825843
Validation binary_cross_entropy = 1.375734
Epoch 19
Loss = 5.8813e-02, PNorm = 67.6874, GNorm = 1.1824, lr_0 = 4.1269e-04
Loss = 6.9270e-02, PNorm = 67.6944, GNorm = 0.8111, lr_0 = 4.0291e-04
Validation auc = 0.737288
Validation accuracy = 0.738938
Validation f1 = 0.829971
Validation binary_cross_entropy = 1.321301
Epoch 20
Loss = 8.4573e-02, PNorm = 67.7051, GNorm = 1.4125, lr_0 = 3.9242e-04
Loss = 5.4622e-02, PNorm = 67.7140, GNorm = 1.7463, lr_0 = 3.8312e-04
Validation auc = 0.683548
Validation accuracy = 0.721239
Validation f1 = 0.822535
Validation binary_cross_entropy = 1.436482
Epoch 21
Loss = 5.4124e-02, PNorm = 67.7218, GNorm = 1.0505, lr_0 = 3.7404e-04
Loss = 6.8305e-02, PNorm = 67.7320, GNorm = 1.0350, lr_0 = 3.6517e-04
Validation auc = 0.690196
Validation accuracy = 0.738938
Validation f1 = 0.837466
Validation binary_cross_entropy = 1.474083
Epoch 22
Loss = 4.7344e-02, PNorm = 67.7383, GNorm = 1.9272, lr_0 = 3.5567e-04
Loss = 5.0470e-02, PNorm = 67.7424, GNorm = 1.5191, lr_0 = 3.4724e-04
Validation auc = 0.690044
Validation accuracy = 0.747788
Validation f1 = 0.838527
Validation binary_cross_entropy = 1.021963
Epoch 23
Loss = 4.1728e-02, PNorm = 67.7484, GNorm = 1.2510, lr_0 = 3.3901e-04
Loss = 5.1511e-02, PNorm = 67.7549, GNorm = 0.3733, lr_0 = 3.3097e-04
Validation auc = 0.682939
Validation accuracy = 0.721239
Validation f1 = 0.821530
Validation binary_cross_entropy = 1.413694
Epoch 24
Loss = 4.8026e-02, PNorm = 67.7620, GNorm = 0.4804, lr_0 = 3.2235e-04
Loss = 3.8945e-02, PNorm = 67.7692, GNorm = 0.2962, lr_0 = 3.1471e-04
Validation auc = 0.687253
Validation accuracy = 0.730088
Validation f1 = 0.829132
Validation binary_cross_entropy = 1.416843
Epoch 25
Loss = 2.3045e-02, PNorm = 67.7748, GNorm = 0.7916, lr_0 = 3.0726e-04
Loss = 5.8221e-02, PNorm = 67.7785, GNorm = 0.7310, lr_0 = 2.9997e-04
Validation auc = 0.696133
Validation accuracy = 0.730088
Validation f1 = 0.830084
Validation binary_cross_entropy = 1.445415
Epoch 26
Loss = 1.9153e-02, PNorm = 67.7818, GNorm = 1.2898, lr_0 = 2.9286e-04
Loss = 3.4112e-02, PNorm = 67.7860, GNorm = 0.2781, lr_0 = 2.8592e-04
Validation auc = 0.703390
Validation accuracy = 0.734513
Validation f1 = 0.833333
Validation binary_cross_entropy = 1.478594
Epoch 27
Loss = 3.2144e-02, PNorm = 67.7893, GNorm = 0.8576, lr_0 = 2.7848e-04
Loss = 3.1856e-02, PNorm = 67.7936, GNorm = 0.4103, lr_0 = 2.7188e-04
Validation auc = 0.709276
Validation accuracy = 0.730088
Validation f1 = 0.831025
Validation binary_cross_entropy = 1.471724
Epoch 28
Loss = 4.7136e-02, PNorm = 67.7987, GNorm = 1.5232, lr_0 = 2.6544e-04
Loss = 4.5637e-02, PNorm = 67.8032, GNorm = 1.4130, lr_0 = 2.5914e-04
Validation auc = 0.713336
Validation accuracy = 0.725664
Validation f1 = 0.824859
Validation binary_cross_entropy = 1.471384
Epoch 29
Loss = 1.1985e-02, PNorm = 67.8079, GNorm = 0.3133, lr_0 = 2.5240e-04
Loss = 3.1285e-02, PNorm = 67.8111, GNorm = 0.2918, lr_0 = 2.4641e-04
Validation auc = 0.712423
Validation accuracy = 0.734513
Validation f1 = 0.830508
Validation binary_cross_entropy = 1.525295
Epoch 30
Loss = 3.2963e-02, PNorm = 67.8119, GNorm = 0.8116, lr_0 = 2.4057e-04
Loss = 6.7537e-02, PNorm = 67.8131, GNorm = 1.3897, lr_0 = 2.3487e-04
Validation auc = 0.705826
Validation accuracy = 0.734513
Validation f1 = 0.829545
Validation binary_cross_entropy = 1.541624
Epoch 31
Loss = 9.4748e-03, PNorm = 67.8159, GNorm = 0.2533, lr_0 = 2.2876e-04
Loss = 1.9895e-02, PNorm = 67.8187, GNorm = 0.7955, lr_0 = 2.2334e-04
Validation auc = 0.710088
Validation accuracy = 0.738938
Validation f1 = 0.832861
Validation binary_cross_entropy = 1.543949
Epoch 32
Loss = 5.3086e-02, PNorm = 67.8209, GNorm = 0.7733, lr_0 = 2.1804e-04
Loss = 3.5507e-02, PNorm = 67.8237, GNorm = 0.7083, lr_0 = 2.1288e-04
Validation auc = 0.714148
Validation accuracy = 0.743363
Validation f1 = 0.836158
Validation binary_cross_entropy = 1.533863
Epoch 33
Loss = 4.5682e-02, PNorm = 67.8264, GNorm = 0.9911, lr_0 = 2.0783e-04
Loss = 2.3692e-02, PNorm = 67.8289, GNorm = 0.3908, lr_0 = 2.0290e-04
Validation auc = 0.718766
Validation accuracy = 0.734513
Validation f1 = 0.833333
Validation binary_cross_entropy = 1.547324
Epoch 34
Loss = 5.0355e-02, PNorm = 67.8309, GNorm = 0.9188, lr_0 = 1.9762e-04
Loss = 3.8637e-02, PNorm = 67.8325, GNorm = 0.8468, lr_0 = 1.9294e-04
Loss = 4.5767e-02, PNorm = 67.8355, GNorm = 0.0175, lr_0 = 1.8836e-04
Validation auc = 0.708566
Validation accuracy = 0.747788
Validation f1 = 0.841226
Validation binary_cross_entropy = 1.532980
Epoch 35
Loss = 3.4150e-02, PNorm = 67.8390, GNorm = 0.9867, lr_0 = 1.8390e-04
Loss = 4.0180e-02, PNorm = 67.8415, GNorm = 1.2232, lr_0 = 1.7954e-04
Loss = 1.1453e-02, PNorm = 67.8416, GNorm = 0.4845, lr_0 = 1.7911e-04
Validation auc = 0.700396
Validation accuracy = 0.721239
Validation f1 = 0.827397
Validation binary_cross_entropy = 1.645043
Epoch 36
Loss = 2.9073e-02, PNorm = 67.8428, GNorm = 1.2100, lr_0 = 1.7487e-04
Loss = 1.7824e-02, PNorm = 67.8440, GNorm = 0.2568, lr_0 = 1.7072e-04
Validation auc = 0.711560
Validation accuracy = 0.752212
Validation f1 = 0.841808
Validation binary_cross_entropy = 1.527061
Epoch 37
Loss = 4.7456e-02, PNorm = 67.8453, GNorm = 0.2392, lr_0 = 1.6668e-04
Loss = 2.2471e-02, PNorm = 67.8469, GNorm = 0.2014, lr_0 = 1.6273e-04
Validation auc = 0.715721
Validation accuracy = 0.756637
Validation f1 = 0.845070
Validation binary_cross_entropy = 1.533530
Epoch 38
Loss = 3.8819e-02, PNorm = 67.8489, GNorm = 0.3200, lr_0 = 1.5887e-04
Loss = 3.0202e-02, PNorm = 67.8501, GNorm = 0.9897, lr_0 = 1.5510e-04
Validation auc = 0.717091
Validation accuracy = 0.752212
Validation f1 = 0.840909
Validation binary_cross_entropy = 1.507396
Epoch 39
Loss = 3.2215e-02, PNorm = 67.8512, GNorm = 0.7232, lr_0 = 1.5107e-04
Loss = 3.0092e-02, PNorm = 67.8526, GNorm = 1.4760, lr_0 = 1.4749e-04
Validation auc = 0.709733
Validation accuracy = 0.743363
Validation f1 = 0.835227
Validation binary_cross_entropy = 1.535547
Epoch 40
Loss = 4.1145e-02, PNorm = 67.8539, GNorm = 1.5092, lr_0 = 1.4399e-04
Loss = 4.0122e-02, PNorm = 67.8554, GNorm = 0.0979, lr_0 = 1.4058e-04
Validation auc = 0.706841
Validation accuracy = 0.734513
Validation f1 = 0.834254
Validation binary_cross_entropy = 1.600648
Epoch 41
Loss = 2.4111e-02, PNorm = 67.8565, GNorm = 0.1863, lr_0 = 1.3692e-04
Loss = 3.2658e-02, PNorm = 67.8573, GNorm = 0.0936, lr_0 = 1.3367e-04
Validation auc = 0.698975
Validation accuracy = 0.734513
Validation f1 = 0.833333
Validation binary_cross_entropy = 1.594457
Epoch 42
Loss = 5.5448e-02, PNorm = 67.8584, GNorm = 1.7903, lr_0 = 1.3050e-04
Loss = 2.2844e-02, PNorm = 67.8598, GNorm = 0.1433, lr_0 = 1.2741e-04
Validation auc = 0.698518
Validation accuracy = 0.734513
Validation f1 = 0.834254
Validation binary_cross_entropy = 1.642083
Epoch 43
Loss = 2.0181e-02, PNorm = 67.8612, GNorm = 0.2466, lr_0 = 1.2409e-04
Loss = 3.3873e-02, PNorm = 67.8621, GNorm = 1.0236, lr_0 = 1.2115e-04
Validation auc = 0.694357
Validation accuracy = 0.734513
Validation f1 = 0.833333
Validation binary_cross_entropy = 1.643330
Epoch 44
Loss = 2.0837e-02, PNorm = 67.8630, GNorm = 0.6119, lr_0 = 1.1828e-04
Loss = 2.3738e-02, PNorm = 67.8643, GNorm = 0.9945, lr_0 = 1.1548e-04
Validation auc = 0.693241
Validation accuracy = 0.730088
Validation f1 = 0.831025
Validation binary_cross_entropy = 1.662264
Epoch 45
Loss = 2.7667e-02, PNorm = 67.8654, GNorm = 0.3340, lr_0 = 1.1274e-04
Loss = 3.2173e-02, PNorm = 67.8664, GNorm = 0.0887, lr_0 = 1.1007e-04
Validation auc = 0.692175
Validation accuracy = 0.730088
Validation f1 = 0.831025
Validation binary_cross_entropy = 1.668003
Epoch 46
Loss = 1.5329e-02, PNorm = 67.8673, GNorm = 0.6884, lr_0 = 1.0720e-04
Loss = 2.0668e-02, PNorm = 67.8685, GNorm = 0.8093, lr_0 = 1.0466e-04
Validation auc = 0.697808
Validation accuracy = 0.725664
Validation f1 = 0.829670
Validation binary_cross_entropy = 1.701040
Epoch 47
Loss = 1.6487e-02, PNorm = 67.8695, GNorm = 0.6139, lr_0 = 1.0218e-04
Loss = 2.6372e-02, PNorm = 67.8701, GNorm = 0.1317, lr_0 = 1.0000e-04
Validation auc = 0.701258
Validation accuracy = 0.738938
Validation f1 = 0.835655
Validation binary_cross_entropy = 1.682590
Epoch 48
Loss = 5.4482e-02, PNorm = 67.8705, GNorm = 0.0757, lr_0 = 1.0000e-04
Loss = 3.2274e-02, PNorm = 67.8708, GNorm = 0.2527, lr_0 = 1.0000e-04
Validation auc = 0.701512
Validation accuracy = 0.738938
Validation f1 = 0.833803
Validation binary_cross_entropy = 1.642132
Epoch 49
Loss = 1.7315e-02, PNorm = 67.8716, GNorm = 0.7514, lr_0 = 1.0000e-04
Loss = 2.3849e-02, PNorm = 67.8723, GNorm = 0.3682, lr_0 = 1.0000e-04
Validation auc = 0.706384
Validation accuracy = 0.721239
Validation f1 = 0.820513
Validation binary_cross_entropy = 1.643811
Model 0 best validation auc = 0.737288 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test auc = 0.912694
Model 0 test accuracy = 0.821705
Model 0 test f1 = 0.867052
Model 0 test binary_cross_entropy = 0.641542
Ensemble test auc = 0.912694
Ensemble test accuracy = 0.821705
Ensemble test f1 = 0.867052
Ensemble test binary_cross_entropy = 0.641542
5-fold cross validation
	Seed 0 ==> test auc = 0.947012
	Seed 0 ==> test accuracy = 0.910853
	Seed 0 ==> test f1 = 0.933333
	Seed 0 ==> test binary_cross_entropy = 0.345140
	Seed 1 ==> test auc = 0.920455
	Seed 1 ==> test accuracy = 0.856589
	Seed 1 ==> test f1 = 0.901333
	Seed 1 ==> test binary_cross_entropy = 0.409452
	Seed 2 ==> test auc = 0.913364
	Seed 2 ==> test accuracy = 0.856589
	Seed 2 ==> test f1 = 0.885449
	Seed 2 ==> test binary_cross_entropy = 0.476073
	Seed 3 ==> test auc = 0.932732
	Seed 3 ==> test accuracy = 0.887597
	Seed 3 ==> test f1 = 0.912913
	Seed 3 ==> test binary_cross_entropy = 0.485929
	Seed 4 ==> test auc = 0.912694
	Seed 4 ==> test accuracy = 0.821705
	Seed 4 ==> test f1 = 0.867052
	Seed 4 ==> test binary_cross_entropy = 0.641542
Overall test auc = 0.925251 +/- 0.013050
Overall test accuracy = 0.866667 +/- 0.030381
Overall test f1 = 0.900016 +/- 0.022702
Overall test binary_cross_entropy = 0.471627 +/- 0.098955
Elapsed time = 0:05:16
